<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="manifest" href="/images/manifest.json">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-flat-top.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"ikoct.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="参赛ID:1K0CT 邮箱：&#111;&#x6b;&#117;&#x75;&#x73;&#117;&#107;&#x75;&#x40;&#103;&#109;&#97;&#105;&#108;&#46;&#x63;&#111;&#109;">
<meta property="og:type" content="article">
<meta property="og:title" content="GeekChallenge2023逆向方向wp">
<meta property="og:url" content="https://ikoct.com/2024/02/22/GeekChallenge2023%E9%80%86%E5%90%91%E6%96%B9%E5%90%91wp/">
<meta property="og:site_name" content="Ikoct的饮冰室">
<meta property="og:description" content="参赛ID:1K0CT 邮箱：&#111;&#x6b;&#117;&#x75;&#x73;&#117;&#107;&#x75;&#x40;&#103;&#109;&#97;&#105;&#108;&#46;&#x63;&#111;&#109;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011221.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-1.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-2.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-4.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-6.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-145103.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-8.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-9.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-145153.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-10.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-11.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-12.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-13.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-14.png">
<meta property="article:published_time" content="2024-02-22T15:30:19.000Z">
<meta property="article:modified_time" content="2024-04-29T16:02:24.997Z">
<meta property="article:author" content="1K0CT B14s">
<meta property="article:tag" content="逆向">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011221.png">

<link rel="canonical" href="https://ikoct.com/2024/02/22/GeekChallenge2023%E9%80%86%E5%90%91%E6%96%B9%E5%90%91wp/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>GeekChallenge2023逆向方向wp | Ikoct的饮冰室</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Ikoct的饮冰室</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ikoct.com/2024/02/22/GeekChallenge2023%E9%80%86%E5%90%91%E6%96%B9%E5%90%91wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="1K0CT B14s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ikoct的饮冰室">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          GeekChallenge2023逆向方向wp
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-02-22 23:30:19" itemprop="dateCreated datePublished" datetime="2024-02-22T23:30:19+08:00">2024-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-04-30 00:02:24" itemprop="dateModified" datetime="2024-04-30T00:02:24+08:00">2024-04-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/REV/" itemprop="url" rel="index"><span itemprop="name">REV</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/REV/WPs/" itemprop="url" rel="index"><span itemprop="name">WPs</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>54k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>49 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>参赛ID:1K0CT</p>
<p>邮箱：<a href="mailto:&#111;&#x6b;&#117;&#x75;&#x73;&#117;&#107;&#x75;&#x40;&#103;&#109;&#97;&#105;&#108;&#46;&#x63;&#111;&#109;">&#111;&#x6b;&#117;&#x75;&#x73;&#117;&#107;&#x75;&#x40;&#103;&#109;&#97;&#105;&#108;&#46;&#x63;&#111;&#109;</a></p>
<span id="more"></span>

<h3 id="Shift-jmp-简单花指令"><a href="#Shift-jmp-简单花指令" class="headerlink" title="Shift_jmp | 简单花指令"></a>Shift_jmp | 简单花指令</h3><p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011221.png" alt="image-20240223003954050"></p>
<p>将无条件跳转和<code>loc_117A</code>patch为<code>nop</code>重构主函数</p>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426.png" alt="image-20231107160634631" style="zoom: 50%;" />

<p>简单的异或加密 解题Python脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">83</span>,  <span class="number">88</span>,  <span class="number">65</span>, <span class="number">120</span>,  <span class="number">83</span>,  <span class="number">54</span>, <span class="number">106</span>, <span class="number">100</span>,  <span class="number">56</span>, <span class="number">100</span>, </span><br><span class="line">  <span class="number">111</span>,  <span class="number">84</span>, <span class="number">120</span>,  <span class="number">66</span>,  <span class="number">81</span>, <span class="number">123</span>, <span class="number">120</span>,  <span class="number">34</span>,  <span class="number">77</span>,  <span class="number">97</span>, </span><br><span class="line">   <span class="number">39</span>,  <span class="number">99</span>, <span class="number">115</span>,  <span class="number">69</span>,  <span class="number">45</span>, <span class="number">124</span>,  <span class="number">69</span>, <span class="number">108</span>,  <span class="number">44</span>, <span class="number">111</span>, </span><br><span class="line">   <span class="number">47</span>, <span class="number">123</span>,  <span class="number">94</span>,  <span class="number">92</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">34</span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="built_in">chr</span>(key[i] ^ i ^ <span class="number">0</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#SYC&#123;W3lc0me_tO_th3_r3veR5e_w0r1d~&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="点击就送的逆向题-C源码的编译"><a href="#点击就送的逆向题-C源码的编译" class="headerlink" title="点击就送的逆向题 | C源码的编译"></a>点击就送的逆向题 | C源码的编译</h3><p><code>.s</code>文件是由C源码编译而来的汇编指令 它与<code>.S</code>文件的区别是它不支持预处理(#define…) gcc编译器可以将其经过链接等再编译为可执行文件 故可以先将<code>.s</code>文件编译为可执行文件再用IDA分析</p>
<p><code>clang click.s -o click</code></p>
<p>Kali虚拟机预装的gcc编译器用以上指令可以直接将<code>.s</code>文件编译为Linux可执行文件</p>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-1.png" alt="image-20231107162004359" style="zoom:50%;" />

<p>简单的位移加密 解题Python脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;Z`J[X^LMNO`PPJPVQRSIUTJ]IMNOZKMM&#x27;</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> key:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(each) - <span class="number">7</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#SYCTQWEFGHYIICIOJKLBNMCVBFGHSDFF</span></span><br></pre></td></tr></table></figure>

<h3 id="Easymath-z3-solver简单使用"><a href="#Easymath-z3-solver简单使用" class="headerlink" title="Easymath | z3-solver简单使用"></a>Easymath | z3-solver简单使用</h3><p>Exinfo查到无壳 64位win程序 IDA64打开</p>
<p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-2.png" alt="image-20231107162748924"></p>
<ol>
<li>check函数逻辑简单 不分析(</li>
<li>checkposition函数逻辑也简单 不分析(</li>
<li>exchange函数</li>
</ol>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-3.png" alt="image-20231107163319234" style="zoom:50%;" />

<p>​	不理解 26行之前的代码作用 但是并不影响分析(</p>
<p>​	number在内存空间中每个有效元素之间插入三个0</p>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-4.png" alt="image-20231107163601963" style="zoom:45%;" />

<p>​	与代码中的<code>p_number[i] = number_[4 * v10]</code>对应 最后一个循环的作用就是将字符在table中的位置映射到这些有效元素上</p>
<p>回到主函数 主要的比较逻辑就是经过映射后的<code>position</code>作为一个5阶方阵与另一个5阶方阵<code>matrix</code>用特殊的矩阵乘法法则相乘得到的矩阵与单位矩阵相比 以下是Python代码实现 其中<code>n</code>为矩阵的阶数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        result[i][j] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            result[i][j] = (M1[i][k] * M2[k][j] + result[i][j]) % <span class="number">0x20</span></span><br></pre></td></tr></table></figure>

<p>除此之外主函数中还能看到为了防止出现多解给出的flag提示(动态调试时发现其为flag中的元素 重构为数组可以将变量名从内存地址变为数组) 可以使用爆破的方式解出flag 也可以使用z3-solver库解出 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">table = <span class="string">&#x27;01234_asdzxcpoityumnbAOZWXGMY&#x27;</span></span><br><span class="line">matrix  = [<span class="number">18</span>, <span class="number">29</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">27</span>, </span><br><span class="line">            <span class="number">8</span>, <span class="number">31</span>,  <span class="number">8</span>, <span class="number">23</span>, <span class="number">30</span>, </span><br><span class="line">           <span class="number">29</span>,  <span class="number">3</span>, <span class="number">28</span>, <span class="number">10</span>, <span class="number">21</span>, </span><br><span class="line">           <span class="number">18</span>, <span class="number">29</span>,  <span class="number">8</span>, <span class="number">16</span>, <span class="number">28</span>, </span><br><span class="line">           <span class="number">11</span>, <span class="number">30</span>,  <span class="number">7</span>, <span class="number">20</span>,  <span class="number">7</span>]</span><br><span class="line">v7      = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line">           <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line">           <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line">           <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, </span><br><span class="line">           <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">num     = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>]</span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    mysolver = Solver()</span><br><span class="line">    position = IntVector(<span class="string">&#x27;position&#x27;</span>, <span class="number">5</span>)</span><br><span class="line">    <span class="keyword">if</span> w == <span class="number">0</span>:</span><br><span class="line">        mysolver.add(position[<span class="number">1</span>] == <span class="number">19</span>)</span><br><span class="line">    <span class="keyword">elif</span> w == <span class="number">1</span>:</span><br><span class="line">        mysolver.add(position[<span class="number">2</span>] == <span class="number">22</span>)</span><br><span class="line">    <span class="keyword">elif</span> w == <span class="number">3</span>:</span><br><span class="line">        mysolver.add(position[<span class="number">2</span>] == <span class="number">22</span>)</span><br><span class="line">    mysolver.add(And([Or([position[i] == val <span class="keyword">for</span> val <span class="keyword">in</span> num]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]))</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        expr = IntVal(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            expr = (expr + position[k] * matrix[<span class="number">5</span> * k + j]) % <span class="number">0x20</span></span><br><span class="line">        mysolver.add(expr == v7[<span class="number">5</span> * w + j])</span><br><span class="line">    result = mysolver.check()</span><br><span class="line">    <span class="keyword">if</span> result == sat:</span><br><span class="line">        m = mysolver.model()</span><br><span class="line">        position_values = [m[position[i]].as_long() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> position_values:</span><br><span class="line">            <span class="built_in">print</span>(table[num.index(each)], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="comment">#xtd4co_ymiunbbx3Aypsmbzii</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;No solution&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>需要注意的是 可以一次性爆破全部不确定的22个元素 但这样会使复杂度提升到29^22(我猜的) 而每一次运算只用到<code>position</code>中的一行元素 故可以一行一行地爆破 可以将复杂度降低到5*29^5(我猜的)所以选择一行一行爆破(z3学习笔记另写)</p>
<h3 id="luck-简单爆破"><a href="#luck-简单爆破" class="headerlink" title="luck | 简单爆破"></a>luck | 简单爆破</h3><p>Exinfo查到无壳 64位win程序 IDA64打开</p>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-5.png" alt="image-20231107181356855" style="zoom: 67%;" />

<p>主函数定义了一个<code>unsigned __int8</code>类型地数组 这个数据类型的大小和<code>char</code>一样 <code>qmemcpy(cmp_data, &quot;\r\a&quot;, 2);</code>这句实际上只将<code>&quot;\r\a&quot;</code>中地前两个字符复制到了<code>cmp_data</code>的末尾 数组名代表首元素地址 所以</p>
<p>cmp_data[0] &#x3D; ‘\‘</p>
<p>cmp_data[1] &#x3D; ‘r’</p>
<p>同理<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-6.png" alt="image-20231107181921189" style="zoom: 50%;" /></p>
<p>将<code>&quot;o96*#&quot;</code>添加到了<code>cmp_data</code>的第37个元素及之后</p>
<p>(其实最简单的方式是动态调试直接查看cmp_data中的数据)</p>
<p>主函数中的加密函数为用递归实现的等差数列求和<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-145103.png" alt="image-20240223145103900"></p>
<p>不管输入的数字是什么都会输出加密后的密文 根据flag前3个固定的字符爆破flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">13</span>,   <span class="number">7</span>,  <span class="number">29</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    result = <span class="built_in">int</span>(i * (i + <span class="number">1</span>) / <span class="number">2</span>) % <span class="number">0xD3</span></span><br><span class="line">    <span class="keyword">if</span> key[<span class="number">0</span>] ^ (result) == <span class="built_in">ord</span>(<span class="string">&#x27;S&#x27;</span>) <span class="keyword">and</span> key[<span class="number">1</span>] ^ (result) == <span class="built_in">ord</span>(<span class="string">&#x27;Y&#x27;</span>) <span class="keyword">and</span> key[<span class="number">2</span>] ^ (result) == <span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="comment"># 69</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>在程序中输入数字得到flag</p>
<h3 id="砍树-安卓逆向"><a href="#砍树-安卓逆向" class="headerlink" title="砍树 | 安卓逆向"></a>砍树 | 安卓逆向</h3><p>主函数的逻辑很简单<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-7.png" alt="image-20231107183128020"></p>
<p>就是调用一个函数传入输入的字符串和key 判断返回值 这个函数在<code>ezreeee</code>库中 导出这个库用IDA分析</p>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-8.png" alt="image-20231107183407674" style="zoom:67%;" />

<p>在函数列表中检索<code>I0o0I</code>函数 传入的参数有4个 其中有2个是<code>JNIEnv</code>和<code>jobject</code> JNI是为了让JAVA和C&#x2F;C++互通构建的环境 jxxxxx是为了不与C原有的类型冲突 所以从下面的2个<code>jstring_2unsigchar</code>函数也可以看出<code>a3</code>和<code>a4</code>分别为jeb伪代码中看到的两个参数与加密后的输入对比的是从内存0x14900中复制的35个字节型数据 以下是解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">0</span>,  <span class="number">32</span>,  <span class="number">32</span>,  <span class="number">23</span>,  <span class="number">27</span>,  <span class="number">54</span>,  <span class="number">14</span>,  <span class="number">54</span>,  <span class="number">38</span>,  <span class="number">23</span>, </span><br><span class="line">    <span class="number">4</span>,  <span class="number">42</span>,  <span class="number">41</span>,   <span class="number">7</span>,  <span class="number">38</span>,  <span class="number">21</span>,  <span class="number">82</span>,  <span class="number">51</span>,  <span class="number">45</span>,  <span class="number">15</span>, </span><br><span class="line">   <span class="number">58</span>,  <span class="number">39</span>,  <span class="number">17</span>,   <span class="number">6</span>,  <span class="number">51</span>,   <span class="number">7</span>,  <span class="number">70</span>,  <span class="number">23</span>,  <span class="number">61</span>,  <span class="number">10</span>, </span><br><span class="line">   <span class="number">60</span>,  <span class="number">56</span>,  <span class="number">46</span>,  <span class="number">34</span>,  <span class="number">24</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>]</span><br><span class="line">to_mod = <span class="string">&quot;Sycloverforerver&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> key:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(each ^ <span class="built_in">ord</span>(to_mod[i % <span class="number">7</span>])), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"><span class="comment">#SYC&#123;t@ke_thE_bul1_By_the_h0rns_TAT&#125;SycloveSyclov</span></span><br></pre></td></tr></table></figure>

<h3 id="听说cpp很难？-C-逆向"><a href="#听说cpp很难？-C-逆向" class="headerlink" title="听说cpp很难？ | C++逆向"></a>听说cpp很难？ | C++逆向</h3><p>Exinfo查到无壳 64位win程序 IDA64打开 伪代码如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *addr_nowChar; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> now_char; <span class="comment">// ebx</span></span><br><span class="line">  _BYTE *v8; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// ebx</span></span><br><span class="line">  __int64 v11; <span class="comment">// rax</span></span><br><span class="line">  __int64 v12; <span class="comment">// rax</span></span><br><span class="line">  __int64 m; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  __int64 k; <span class="comment">// [rsp+28h] [rbp-58h] BYREF</span></span><br><span class="line">  <span class="type">char</span> copy_flag[<span class="number">32</span>]; <span class="comment">// [rsp+30h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">char</span> be_encoded[<span class="number">48</span>]; <span class="comment">// [rsp+50h] [rbp-30h] BYREF</span></span><br><span class="line">  _BYTE enc[<span class="number">32</span>]; <span class="comment">// [rsp+80h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v19[<span class="number">40</span>]; <span class="comment">// [rsp+A0h] [rbp+20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> input_flag[<span class="number">40</span>]; <span class="comment">// [rsp+140h] [rbp+C0h] BYREF</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+168h] [rbp+E8h] BYREF</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+170h] [rbp+F0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> len; <span class="comment">// [rsp+17Ch] [rbp+FCh]</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// [rsp+180h] [rbp+100h]</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// [rsp+184h] [rbp+104h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+188h] [rbp+108h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18Ch] [rbp+10Ch]</span></span><br><span class="line"></span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  v3 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;place input your flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v3, refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::basic_string(input_flag);</span><br><span class="line">  <span class="built_in">memset</span>(v19, <span class="number">0</span>, <span class="keyword">sizeof</span>(v19));</span><br><span class="line">  v19[<span class="number">0</span>] = <span class="number">0x4D</span>;</span><br><span class="line">  v19[<span class="number">1</span>] = <span class="number">0x5F</span>;</span><br><span class="line">  v19[<span class="number">2</span>] = <span class="number">0x3D</span>;</span><br><span class="line">  v19[<span class="number">3</span>] = <span class="number">0xFFFFFF85</span>;</span><br><span class="line">  v19[<span class="number">4</span>] = <span class="number">0x37</span>;</span><br><span class="line">  v19[<span class="number">5</span>] = <span class="number">0x68</span>;</span><br><span class="line">  v19[<span class="number">6</span>] = <span class="number">0x73</span>;</span><br><span class="line">  v19[<span class="number">7</span>] = <span class="number">0x57</span>;</span><br><span class="line">  v19[<span class="number">8</span>] = <span class="number">0x27</span>;</span><br><span class="line">  v19[<span class="number">9</span>] = <span class="number">0x68</span>;</span><br><span class="line">  v19[<span class="number">10</span>] = <span class="number">0x51</span>;</span><br><span class="line">  v19[<span class="number">11</span>] = <span class="number">0x59</span>;</span><br><span class="line">  v19[<span class="number">12</span>] = <span class="number">0x7F</span>;</span><br><span class="line">  v19[<span class="number">13</span>] = <span class="number">0x26</span>;</span><br><span class="line">  v19[<span class="number">14</span>] = <span class="number">0x6B</span>;</span><br><span class="line">  v19[<span class="number">15</span>] = <span class="number">0x59</span>;</span><br><span class="line">  v19[<span class="number">16</span>] = <span class="number">0x73</span>;</span><br><span class="line">  v19[<span class="number">17</span>] = <span class="number">0x57</span>;</span><br><span class="line">  v19[<span class="number">18</span>] = <span class="number">0x55</span>;</span><br><span class="line">  v19[<span class="number">19</span>] = <span class="number">0x5B</span>;</span><br><span class="line">  v19[<span class="number">20</span>] = <span class="number">0x59</span>;</span><br><span class="line">  v19[<span class="number">21</span>] = <span class="number">0x6F</span>;</span><br><span class="line">  v19[<span class="number">22</span>] = <span class="number">0x6A</span>;</span><br><span class="line">  v19[<span class="number">23</span>] = <span class="number">0x59</span>;</span><br><span class="line">  v19[<span class="number">24</span>] = <span class="number">0x27</span>;</span><br><span class="line">  v19[<span class="number">25</span>] = <span class="number">0x57</span>;</span><br><span class="line">  v19[<span class="number">26</span>] = <span class="number">0x72</span>;</span><br><span class="line">  v19[<span class="number">27</span>] = <span class="number">0x57</span>;</span><br><span class="line">  v19[<span class="number">28</span>] = <span class="number">0x4F</span>;</span><br><span class="line">  v19[<span class="number">29</span>] = <span class="number">0x57</span>;</span><br><span class="line">  v19[<span class="number">30</span>] = <span class="number">0x78</span>;</span><br><span class="line">  v19[<span class="number">31</span>] = <span class="number">0x78</span>;</span><br><span class="line">  v19[<span class="number">32</span>] = <span class="number">0xFFFFFF83</span>;</span><br><span class="line">  <span class="built_in">std</span>::operator&gt;&gt;&lt;<span class="type">char</span>&gt;(refptr__ZSt3cin, input_flag);</span><br><span class="line">  len = <span class="built_in">std</span>::<span class="built_in">string</span>::size(input_flag);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::<span class="built_in">vector</span>(enc);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::push_back(enc, &amp;v19[i]);</span><br><span class="line">    <span class="keyword">if</span> ( i &gt; <span class="number">34</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;                                             <span class="comment">// 复制v19到enc中</span></span><br><span class="line">  encode::encode(be_encoded, len, input_flag, <span class="number">10</span>);<span class="comment">// </span></span><br><span class="line">                                                <span class="comment">// be_encoded[0]    = len(flag)</span></span><br><span class="line">                                                <span class="comment">// be_encoded[8...] = input_flag</span></span><br><span class="line">                                                <span class="comment">// be_encoded[40]   = 10</span></span><br><span class="line">                                                <span class="comment">// be_encoded[44]   = 10</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;::<span class="built_in">vector</span>(copy_flag);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; ; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = j;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt;= <span class="built_in">std</span>::<span class="built_in">string</span>::size(input_flag) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v5 = <span class="built_in">std</span>::<span class="built_in">string</span>::operator[](input_flag, j);<span class="comment">// v5 = input_flag[j]</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;::push_back(copy_flag, v5);</span><br><span class="line">  &#125;</span><br><span class="line">  v25 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;::begin(copy_flag);<span class="comment">// for k in copy_flag</span></span><br><span class="line">        ;</span><br><span class="line">        __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;&gt;::operator++(&amp;k, <span class="number">0</span>i64) )</span><br><span class="line">  &#123;</span><br><span class="line">    v21 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;::end(copy_flag);</span><br><span class="line">    <span class="keyword">if</span> ( !__gnu_cxx::operator!=&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;&gt;(&amp;k, &amp;v21) )<span class="comment">// 读到最后一个字符时退出</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    addr_nowChar = __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;&gt;::operator*(&amp;k);</span><br><span class="line">    *addr_nowChar += be_encoded[<span class="number">44</span>];</span><br><span class="line">    now_char = *__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;&gt;::operator*(&amp;k);</span><br><span class="line">    v8 = __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;&gt;::operator*(&amp;k);</span><br><span class="line">    *v8 = text_67(be_encoded, now_char);        <span class="comment">// now_char += 10</span></span><br><span class="line">                                                <span class="comment">// now_char = (10 ^ now_char) - 10</span></span><br><span class="line">                                                <span class="comment">// now_char = v19[i]</span></span><br><span class="line">  &#125;</span><br><span class="line">  v24 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( m = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;::begin(copy_flag);</span><br><span class="line">        ;</span><br><span class="line">        __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;&gt;::operator++(&amp;m, <span class="number">0</span>i64) )</span><br><span class="line">  &#123;</span><br><span class="line">    v22 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;::end(copy_flag);</span><br><span class="line">    <span class="keyword">if</span> ( !__gnu_cxx::operator!=&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;&gt;(&amp;m, &amp;v22) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v9 = *__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;&gt;::operator*(&amp;m);</span><br><span class="line">    <span class="keyword">if</span> ( v9 == *<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::operator[](enc, v24) )</span><br><span class="line">      ++v25;</span><br><span class="line">    v10 = *__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;&gt;::operator*(&amp;m);</span><br><span class="line">    <span class="keyword">if</span> ( v10 != *<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::operator[](enc, v24) )</span><br><span class="line">      --v25;</span><br><span class="line">    ++v24;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v25 &gt; <span class="number">32</span> )                               <span class="comment">// v25统计正确的字符</span></span><br><span class="line">  &#123;</span><br><span class="line">    v11 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;yes yes you are right!&quot;</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::operator&lt;&lt;(v11, refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v25 &lt;= <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v12 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;no try again~&quot;</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::operator&lt;&lt;(v12, refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;::~<span class="built_in">vector</span>(copy_flag);</span><br><span class="line">  encode::~encode(be_encoded);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::~<span class="built_in">vector</span>(enc);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(input_flag);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析C++逆向时<code>XXXXXXXoperatorxxx(a, b)</code> 可以看作<code>a</code>对<code>b</code>做<code>xxx</code>操作</p>
<p>其中的主要逻辑是先对be_encoded进行<code>encode</code>操作 进入查看</p>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-9.png" alt="image-20231107191204124" style="zoom:67%;" />

<p>需要注意的是主函数中定义的<code>be_encoded</code>储存的数据长度为1byte 而C++中的双字类型长度为4bytes 所以其中的下标转化到原来的<code>be_encoded</code>中需要乘上4 <code>text_67</code>的逻辑很简单</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">text_67</span><span class="params">(__int64 be_encoded, <span class="type">char</span> now_char)</span></span><br><span class="line">&#123;</span><br><span class="line">  *(be_encoded + <span class="number">40</span>) = <span class="number">9</span>;</span><br><span class="line">  <span class="keyword">return</span> (((*(be_encoded + <span class="number">40</span>) + <span class="number">1</span>) ^ now_char) - *(be_encoded + <span class="number">40</span>) - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>剩下的对比逻辑也很简单 以下是解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="literal">None</span>] * <span class="number">33</span></span><br><span class="line">enc[<span class="number">0</span>] = <span class="number">77</span></span><br><span class="line">enc[<span class="number">1</span>] = <span class="number">95</span></span><br><span class="line">enc[<span class="number">2</span>] = <span class="number">61</span></span><br><span class="line">enc[<span class="number">3</span>] = <span class="number">0x85</span></span><br><span class="line">enc[<span class="number">4</span>] = <span class="number">55</span></span><br><span class="line">enc[<span class="number">5</span>] = <span class="number">104</span></span><br><span class="line">enc[<span class="number">6</span>] = <span class="number">115</span></span><br><span class="line">enc[<span class="number">7</span>] = <span class="number">87</span></span><br><span class="line">enc[<span class="number">8</span>] = <span class="number">39</span></span><br><span class="line">enc[<span class="number">9</span>] = <span class="number">104</span></span><br><span class="line">enc[<span class="number">10</span>] = <span class="number">81</span></span><br><span class="line">enc[<span class="number">11</span>] = <span class="number">89</span></span><br><span class="line">enc[<span class="number">12</span>] = <span class="number">127</span></span><br><span class="line">enc[<span class="number">13</span>] = <span class="number">38</span></span><br><span class="line">enc[<span class="number">14</span>] = <span class="number">107</span></span><br><span class="line">enc[<span class="number">15</span>] = <span class="number">89</span></span><br><span class="line">enc[<span class="number">16</span>] = <span class="number">115</span></span><br><span class="line">enc[<span class="number">17</span>] = <span class="number">87</span></span><br><span class="line">enc[<span class="number">18</span>] = <span class="number">85</span></span><br><span class="line">enc[<span class="number">19</span>] = <span class="number">91</span></span><br><span class="line">enc[<span class="number">20</span>] = <span class="number">89</span></span><br><span class="line">enc[<span class="number">21</span>] = <span class="number">111</span></span><br><span class="line">enc[<span class="number">22</span>] = <span class="number">106</span></span><br><span class="line">enc[<span class="number">23</span>] = <span class="number">89</span></span><br><span class="line">enc[<span class="number">24</span>] = <span class="number">39</span></span><br><span class="line">enc[<span class="number">25</span>] = <span class="number">87</span></span><br><span class="line">enc[<span class="number">26</span>] = <span class="number">114</span></span><br><span class="line">enc[<span class="number">27</span>] = <span class="number">87</span></span><br><span class="line">enc[<span class="number">28</span>] = <span class="number">79</span></span><br><span class="line">enc[<span class="number">29</span>] = <span class="number">87</span></span><br><span class="line">enc[<span class="number">30</span>] = <span class="number">120</span></span><br><span class="line">enc[<span class="number">31</span>] = <span class="number">120</span></span><br><span class="line">enc[<span class="number">32</span>] = <span class="number">0x83</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(((enc[i] + <span class="number">10</span>) ^ <span class="number">10</span>) - <span class="number">10</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># SYC&#123;Anma1nG_y0u_maKe_it_1alaIa~~&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="flower-or-tea-简单花指令和TEA加密"><a href="#flower-or-tea-简单花指令和TEA加密" class="headerlink" title="flower-or-tea | 简单花指令和TEA加密"></a>flower-or-tea | 简单花指令和TEA加密</h3><p>Exinfo查到无壳 32位win程序 IDA32打开 伪代码如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+0h] [ebp-1B0h]</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [esp+0h] [ebp-1B0h]</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [esp+0h] [ebp-1B0h]</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [esp+0h] [ebp-1B0h]</span></span><br><span class="line">  <span class="type">int</span> v8[<span class="number">40</span>]; <span class="comment">// [esp+Ch] [ebp-1A4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> _54; <span class="comment">// [esp+ACh] [ebp-104h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+B0h] [ebp-100h]</span></span><br><span class="line">  <span class="type">char</span> *v11; <span class="comment">// [esp+B4h] [ebp-FCh]</span></span><br><span class="line">  <span class="type">int</span> lenth; <span class="comment">// [esp+B8h] [ebp-F8h]</span></span><br><span class="line">  <span class="type">char</span> *v13; <span class="comment">// [esp+BCh] [ebp-F4h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+C0h] [ebp-F0h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+C4h] [ebp-ECh]</span></span><br><span class="line">  <span class="type">int</span> v16[<span class="number">40</span>]; <span class="comment">// [esp+CCh] [ebp-E4h]</span></span><br><span class="line">  <span class="type">int</span> v17[<span class="number">4</span>]; <span class="comment">// [esp+16Ch] [ebp-44h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// [esp+17Ch] [ebp-34h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// [esp+180h] [ebp-30h]</span></span><br><span class="line">  <span class="type">char</span> input[<span class="number">40</span>]; <span class="comment">// [esp+184h] [ebp-2Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// [esp+1ACh] [ebp-4h]</span></span><br><span class="line">  <span class="type">int</span> savedregs; <span class="comment">// [esp+1B0h] [ebp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v17[<span class="number">0</span>] = <span class="number">32</span>;</span><br><span class="line">  v17[<span class="number">1</span>] = <span class="number">27</span>;</span><br><span class="line">  v17[<span class="number">2</span>] = <span class="number">39</span>;</span><br><span class="line">  v17[<span class="number">3</span>] = <span class="number">44</span>;</span><br><span class="line">  <span class="built_in">memset</span>(input, <span class="number">0</span>, <span class="keyword">sizeof</span>(input));</span><br><span class="line">  print(&amp;Format, v4);</span><br><span class="line">  print(&amp;byte_CA409C, v5);</span><br><span class="line">  print(&amp;byte_CA4090, v6);</span><br><span class="line">  <span class="built_in">scanf</span>(aS, input);</span><br><span class="line">  v11 = &amp;input[<span class="number">1</span>];</span><br><span class="line">  v13 = &amp;input[<span class="built_in">strlen</span>(input) + <span class="number">1</span>];</span><br><span class="line">  v10 = v13 - &amp;input[<span class="number">1</span>];</span><br><span class="line">  lenth = v13 - &amp;input[<span class="number">1</span>];</span><br><span class="line">  _54 = <span class="number">54</span>;</span><br><span class="line">  v16[<span class="number">0</span>] = <span class="number">-1694939573</span>;</span><br><span class="line">  v16[<span class="number">1</span>] = <span class="number">-1005078370</span>;</span><br><span class="line">  v16[<span class="number">2</span>] = <span class="number">-1307072749</span>;</span><br><span class="line">  v16[<span class="number">3</span>] = <span class="number">-918836760</span>;</span><br><span class="line">  v16[<span class="number">4</span>] = <span class="number">-1795955634</span>;</span><br><span class="line">  v16[<span class="number">5</span>] = <span class="number">-1244910923</span>;</span><br><span class="line">  v16[<span class="number">6</span>] = <span class="number">1146217516</span>;</span><br><span class="line">  v16[<span class="number">7</span>] = <span class="number">2055874714</span>;</span><br><span class="line">  v16[<span class="number">8</span>] = <span class="number">1405669384</span>;</span><br><span class="line">  v16[<span class="number">9</span>] = <span class="number">1846639433</span>;</span><br><span class="line">  v16[<span class="number">10</span>] = <span class="number">-1677731948</span>;</span><br><span class="line">  v16[<span class="number">11</span>] = <span class="number">1593781753</span>;</span><br><span class="line">  v16[<span class="number">12</span>] = <span class="number">401024305</span>;</span><br><span class="line">  v16[<span class="number">13</span>] = <span class="number">-541222535</span>;</span><br><span class="line">  v16[<span class="number">14</span>] = <span class="number">-1886971078</span>;</span><br><span class="line">  v16[<span class="number">15</span>] = <span class="number">1944634796</span>;</span><br><span class="line">  v16[<span class="number">16</span>] = <span class="number">-1299812186</span>;</span><br><span class="line">  v16[<span class="number">17</span>] = <span class="number">1526113129</span>;</span><br><span class="line">  v16[<span class="number">18</span>] = <span class="number">754440740</span>;</span><br><span class="line">  v16[<span class="number">19</span>] = <span class="number">880502447</span>;</span><br><span class="line">  v16[<span class="number">20</span>] = <span class="number">-1178055328</span>;</span><br><span class="line">  v16[<span class="number">21</span>] = <span class="number">-1860267729</span>;</span><br><span class="line">  v16[<span class="number">22</span>] = <span class="number">-1118163045</span>;</span><br><span class="line">  v16[<span class="number">23</span>] = <span class="number">-879332550</span>;</span><br><span class="line">  v16[<span class="number">24</span>] = <span class="number">-979801922</span>;</span><br><span class="line">  v16[<span class="number">25</span>] = <span class="number">-1610607639</span>;</span><br><span class="line">  v16[<span class="number">26</span>] = <span class="number">-1053864284</span>;</span><br><span class="line">  v16[<span class="number">27</span>] = <span class="number">-561628656</span>;</span><br><span class="line">  v16[<span class="number">28</span>] = <span class="number">-1597713004</span>;</span><br><span class="line">  v16[<span class="number">29</span>] = <span class="number">1132501052</span>;</span><br><span class="line">  v16[<span class="number">30</span>] = <span class="number">2117039688</span>;</span><br><span class="line">  v16[<span class="number">31</span>] = <span class="number">-447882103</span>;</span><br><span class="line">  v16[<span class="number">32</span>] = <span class="number">1059563152</span>;</span><br><span class="line">  v16[<span class="number">33</span>] = <span class="number">-1249037927</span>;</span><br><span class="line">  v16[<span class="number">34</span>] = <span class="number">1615521047</span>;</span><br><span class="line">  v16[<span class="number">35</span>] = <span class="number">-1668269692</span>;</span><br><span class="line">  v16[<span class="number">36</span>] = <span class="number">-186628991</span>;</span><br><span class="line">  v16[<span class="number">37</span>] = <span class="number">1022684671</span>;</span><br><span class="line">  v16[<span class="number">38</span>] = <span class="number">0</span>;</span><br><span class="line">  v16[<span class="number">39</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v13 - &amp;input[<span class="number">1</span>] == <span class="number">38</span> )                  <span class="comment">// flag长度为38</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( input[<span class="number">0</span>] == <span class="number">83</span> &amp;&amp; input[<span class="number">1</span>] == <span class="number">89</span> &amp;&amp; input[<span class="number">2</span>] == <span class="number">67</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( input[<span class="number">3</span>] == <span class="number">123</span> &amp;&amp; input[<span class="number">37</span>] == <span class="number">125</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; lenth / <span class="number">2</span>; ++i )</span><br><span class="line">        &#123;</span><br><span class="line">          v18 = input[i];</span><br><span class="line">          v19 = input[lenth - i - <span class="number">1</span>];</span><br><span class="line">          sub_CA10C3(_54, &amp;v18, v17);</span><br><span class="line">          v8[<span class="number">2</span> * i] = v18;                      <span class="comment">// 奇数元素</span></span><br><span class="line">          v8[<span class="number">2</span> * i + <span class="number">1</span>] = v19;                  <span class="comment">// 偶数元素</span></span><br><span class="line">        &#125;                                       <span class="comment">// target:v8 = v16</span></span><br><span class="line">        <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; lenth &amp;&amp; v8[j] == v16[j]; ++j )</span><br><span class="line">          ;</span><br><span class="line">        <span class="keyword">if</span> ( j == lenth )</span><br><span class="line">        &#123;</span><br><span class="line">          print(aYesYes, v7);</span><br><span class="line">          system(aPause_1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          print(aWrong, v7);</span><br><span class="line">          system(aPause_2);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        print(&amp;byte_CA4060, v7);</span><br><span class="line">        system(aPause_0);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      print(aFlag, v7);</span><br><span class="line">      system(aPause_3);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    print(&amp;byte_CA407C, v7);</span><br><span class="line">    system(Command);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_CA15D1(&amp;savedregs ^ v21);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>核心逻辑就是输入的数据加密后调换顺序并和<code>v16</code>比较 这个加密算法(<code>sub_CA10C3</code>)就是TEA加密 特点是没有数据丢失 可以逆向</p>
<p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-145153.png" alt="image-20240223145153828"></p>
<p>需要注意的是传入的第二个参数是主函数中的<code>&amp;v18</code> 打开<code>v18</code>栈中的位置 发现<code>v19</code>就是紧挨其的下一个<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-10.png" alt="image-20231107194847453"></p>
<p>所以<code>v5 = now_char[1];</code>这句实际上取的是<code>v19</code></p>
<p>另外一点需要注意的是数据的上限 <code>unsigned int</code>类型的数据最多储存4bytes 故每次执行都需要截去高32位</p>
<p>知道这些后就可以写出以下解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = [<span class="literal">None</span>] * <span class="number">4</span></span><br><span class="line">key[<span class="number">0</span>] = <span class="number">32</span></span><br><span class="line">key[<span class="number">1</span>] = <span class="number">27</span></span><br><span class="line">key[<span class="number">2</span>] = <span class="number">39</span></span><br><span class="line">key[<span class="number">3</span>] = <span class="number">44</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="literal">None</span>] * <span class="number">38</span></span><br><span class="line">enc[<span class="number">0</span>] = <span class="number">0x9AF9464B</span></span><br><span class="line">enc[<span class="number">1</span>] = <span class="number">0xC417B89E</span></span><br><span class="line">enc[<span class="number">2</span>] = <span class="number">0xB217A713</span></span><br><span class="line">enc[<span class="number">3</span>] = <span class="number">0xC93BA9E8</span></span><br><span class="line">enc[<span class="number">4</span>] = <span class="number">0x94F3E44E</span></span><br><span class="line">enc[<span class="number">5</span>] = <span class="number">0xB5CC2AB5</span></span><br><span class="line">enc[<span class="number">6</span>] = <span class="number">0x4451E42C</span></span><br><span class="line">enc[<span class="number">7</span>] = <span class="number">0x7A8A289A</span></span><br><span class="line">enc[<span class="number">8</span>] = <span class="number">0x53C8D008</span></span><br><span class="line">enc[<span class="number">9</span>] = <span class="number">0x6E117B49</span></span><br><span class="line">enc[<span class="number">10</span>] = <span class="number">0x9BFFD794</span></span><br><span class="line">enc[<span class="number">11</span>] = <span class="number">0x5EFF2DF9</span></span><br><span class="line">enc[<span class="number">12</span>] = <span class="number">0x17E72531</span></span><br><span class="line">enc[<span class="number">13</span>] = <span class="number">0xDFBD9979</span></span><br><span class="line">enc[<span class="number">14</span>] = <span class="number">0x8F871B3A</span></span><br><span class="line">enc[<span class="number">15</span>] = <span class="number">0x73E8C5AC</span></span><br><span class="line">enc[<span class="number">16</span>] = <span class="number">0xB28670A6</span></span><br><span class="line">enc[<span class="number">17</span>] = <span class="number">0x5AF6A369</span></span><br><span class="line">enc[<span class="number">18</span>] = <span class="number">0x2CF7DA24</span></span><br><span class="line">enc[<span class="number">19</span>] = <span class="number">0x347B66AF</span></span><br><span class="line">enc[<span class="number">20</span>] = <span class="number">0xB9C84D60</span></span><br><span class="line">enc[<span class="number">21</span>] = <span class="number">0x911E912F</span></span><br><span class="line">enc[<span class="number">22</span>] = <span class="number">0xBD5A2F9B</span></span><br><span class="line">enc[<span class="number">23</span>] = <span class="number">0xCB96733A</span></span><br><span class="line">enc[<span class="number">24</span>] = <span class="number">0xC59968BE</span></span><br><span class="line">enc[<span class="number">25</span>] = <span class="number">0xA00013E9</span></span><br><span class="line">enc[<span class="number">26</span>] = <span class="number">0xC12F4EA4</span></span><br><span class="line">enc[<span class="number">27</span>] = <span class="number">0xDE863A10</span></span><br><span class="line">enc[<span class="number">28</span>] = <span class="number">0xA0C4D594</span></span><br><span class="line">enc[<span class="number">29</span>] = <span class="number">0x4380983C</span></span><br><span class="line">enc[<span class="number">30</span>] = <span class="number">0x7E2F7648</span></span><br><span class="line">enc[<span class="number">31</span>] = <span class="number">0xE54DDC89</span></span><br><span class="line">enc[<span class="number">32</span>] = <span class="number">0x3F27A690</span></span><br><span class="line">enc[<span class="number">33</span>] = <span class="number">0xB58D3199</span></span><br><span class="line">enc[<span class="number">34</span>] = <span class="number">0x604AE517</span></span><br><span class="line">enc[<span class="number">35</span>] = <span class="number">0x9C903984</span></span><br><span class="line">enc[<span class="number">36</span>] = <span class="number">0xF4E04481</span></span><br><span class="line">enc[<span class="number">37</span>] = <span class="number">0x3CF4EDFF</span></span><br><span class="line"></span><br><span class="line">flag = [<span class="literal">None</span>] * <span class="number">38</span></span><br><span class="line">lenth = <span class="number">38</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">  flag[i] = enc[<span class="number">2</span> * i]</span><br><span class="line">  flag[lenth - i - <span class="number">1</span>] = enc[<span class="number">2</span> * i + <span class="number">1</span>]</span><br><span class="line">  delta = <span class="number">54</span> * <span class="number">0x31415927</span></span><br><span class="line">  <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">54</span>):</span><br><span class="line">    delta -= <span class="number">0x31415927</span></span><br><span class="line">    flag[i] -= (key[delta % <span class="number">4</span>] + delta) ^ (flag[lenth - i - <span class="number">1</span>] + ((flag[lenth - i - <span class="number">1</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * flag[lenth - i - <span class="number">1</span>])))</span><br><span class="line">    flag[i] &amp;= <span class="number">0xFFFFFFFF</span></span><br><span class="line">    flag[lenth - i - <span class="number">1</span>] -= delta ^ (key[(delta &gt;&gt; <span class="number">11</span>) % <span class="number">4</span>] + delta) ^ (flag[i] + ((flag[i] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * flag[i])))</span><br><span class="line">    flag[lenth - i - <span class="number">1</span>] &amp;= <span class="number">0xFFFFFFFF</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> flag:</span><br><span class="line">  <span class="built_in">print</span>(<span class="built_in">chr</span>(each), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># SYC&#123;D0_Yov_1ike_To_dRink_Flow3r_teA??&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="rainbow-控制流平坦化"><a href="#rainbow-控制流平坦化" class="headerlink" title="rainbow | 控制流平坦化"></a>rainbow | 控制流平坦化</h3><p>关于去控制流平坦化参考 <a target="_blank" rel="noopener" href="https://security.tencent.com/index.php/blog/msg/112">https://security.tencent.com/index.php/blog/msg/112</a></p>
<p>这里用别人的工具脚本去平坦化 去平坦化后的代码如下</p>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-11.png" alt="image-20231107200704176" style="zoom:67%;" />

<p>由于判断无用块的方法是排除法(排除掉序言块,分发器,预处理块和返回块) 而原程序中退出并不使用<code>return</code>而是<code>call exit</code> 所以被判定为无用块被删除 故判断长度和flag不正确就退出的块被删去 观察原来的代码 剩下的代码就是加密后的flag和<code>v8~v11</code>的数据进行对比 解密脚本如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">101</span>,  <span class="number">88</span>,  <span class="number">65</span>, <span class="number">142</span>,  <span class="number">80</span>,  <span class="number">68</span>, <span class="number">123</span>,  <span class="number">98</span>,  <span class="number">87</span>,  <span class="number">74</span>, </span><br><span class="line">  <span class="number">126</span>,  <span class="number">84</span>,  <span class="number">73</span>, <span class="number">108</span>, <span class="number">125</span>, <span class="number">132</span>,  <span class="number">79</span>,  <span class="number">91</span>, <span class="number">149</span>,  <span class="number">96</span>, </span><br><span class="line">   <span class="number">96</span>, <span class="number">100</span>, <span class="number">119</span>,  <span class="number">72</span>, <span class="number">125</span>,  <span class="number">77</span>, <span class="number">123</span>, <span class="number">159</span>, <span class="number">104</span>,  <span class="number">60</span>, </span><br><span class="line">   <span class="number">45</span>,  <span class="number">98</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    key[i] ^= i</span><br><span class="line">    key[i] -= <span class="number">18</span> * (i % <span class="number">3</span> == <span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(key[i]), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># SYC&#123;TAke_1t_3asy_Just_a_STart!!&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="mySelf-简单SMC"><a href="#mySelf-简单SMC" class="headerlink" title="mySelf | 简单SMC"></a>mySelf | 简单SMC</h3><p>Exinfo查到无壳 32位win程序 IDA32打开<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-12.png" alt="image-20231108082822264" style="zoom:67%;" /></p>
<p><code>VirtualProtect</code>函数给予一段内存地址(函数)修改自身字节码的权限 基本上是SMC的标志</p>
<p>如果不使用静态分析的方法可以直接动态调试 这样的可操作性高 在SMC的函数下断点 动态调试到断点处 F7步进函数 之后查看汇编代码 将SMC后的函数重新识别为函数再反编译为伪代码分析</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> __cdecl <span class="title function_">encode</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v6; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v7; <span class="comment">// [esp+10h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+14h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">    v3 = *(_DWORD *)(a1 + <span class="number">4</span> * v1);</span><br><span class="line">    v7 = (<span class="type">unsigned</span> <span class="type">int</span> *)(a1 + <span class="number">4</span> * v1);</span><br><span class="line">    v6 = (<span class="type">unsigned</span> <span class="type">int</span> *)(a1 + <span class="number">4</span> * (v1 + <span class="number">1</span>));</span><br><span class="line">    v4 = <span class="number">32</span>;</span><br><span class="line">    result = *v6;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 -= <span class="number">1640531527</span>;</span><br><span class="line">      v3 += ((result &gt;&gt; <span class="number">5</span>) + <span class="number">2</span>) ^ (<span class="number">16</span> * result + <span class="number">2</span>) ^ (v2 + result);</span><br><span class="line">      result += ((v3 &gt;&gt; <span class="number">5</span>) + <span class="number">4</span>) ^ (<span class="number">16</span> * v3 + <span class="number">3</span>) ^ (v2 + v3);</span><br><span class="line">      --v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v4 );</span><br><span class="line">    v8 += <span class="number">2</span>;</span><br><span class="line">    v1 = v8;</span><br><span class="line">    *v7 = v3;</span><br><span class="line">    *v6 = result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v8 &lt; <span class="number">8</span> );</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>又是一个TEA加密 但是其中用到了一个伪随机数 需要动态调试获得 这个TEA加密和上一题中的不同点是每次被加密的字符顺序不同 同时也要注意每次加密的数据长度是4bytes 而原来传入的是以1byte分割的数组的地址 而在x86程序中双字型数据使用小端序储存 知道了这些之后写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">o_key = [<span class="number">0xF0</span>, <span class="number">0xF9</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xC4</span>, <span class="number">0x94</span>, <span class="number">0x61</span>, <span class="number">0xE2</span>, <span class="number">0x25</span>, <span class="number">0x91</span>, </span><br><span class="line">  <span class="number">0x79</span>, <span class="number">0x80</span>, <span class="number">0x19</span>, <span class="number">0xC2</span>, <span class="number">0x0F</span>, <span class="number">0x1F</span>, <span class="number">0x15</span>, <span class="number">0x18</span>, <span class="number">0x6A</span>, <span class="number">0xEB</span>, </span><br><span class="line">  <span class="number">0xC5</span>, <span class="number">0x72</span>, <span class="number">0xF5</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x3A</span>, <span class="number">0xCC</span>, <span class="number">0x40</span>, <span class="number">0xBB</span>, <span class="number">0x2A</span>, </span><br><span class="line">  <span class="number">0xA3</span>, <span class="number">0xD2</span>]</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    flag.append(o_key[<span class="number">4</span> * i] | o_key[<span class="number">4</span> * i + <span class="number">1</span>] &lt;&lt; <span class="number">8</span> | o_key[<span class="number">4</span> * i + <span class="number">2</span>] &lt;&lt; <span class="number">16</span> | o_key[<span class="number">4</span> * i + <span class="number">3</span>] &lt;&lt; <span class="number">24</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    v2 = <span class="number">0x61C88647</span> * (-<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        flag[<span class="number">2</span> * i + <span class="number">1</span>] -= ((flag[<span class="number">2</span> * i] &gt;&gt; <span class="number">5</span>) + <span class="number">4</span>) ^ (<span class="number">16</span> * flag[<span class="number">2</span> * i] + <span class="number">3</span>) ^ (v2 + flag[<span class="number">2</span> * i])</span><br><span class="line">        flag[<span class="number">2</span> * i + <span class="number">1</span>] &amp;= <span class="number">0xFFFFFFFF</span></span><br><span class="line">        flag[<span class="number">2</span> * i] -= ((flag[<span class="number">2</span> * i + <span class="number">1</span>] &gt;&gt; <span class="number">5</span>) + <span class="number">2</span>) ^ (<span class="number">16</span> * flag[<span class="number">2</span> * i + <span class="number">1</span>] + <span class="number">2</span>) ^ (v2 + flag[<span class="number">2</span> * i + <span class="number">1</span>])</span><br><span class="line">        flag[<span class="number">2</span> * i] &amp;= <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v2 += <span class="number">0x61C88647</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>((each &gt;&gt; (<span class="number">8</span> * i)) &amp; <span class="number">0xFF</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="小黄鸭-Python逆向"><a href="#小黄鸭-Python逆向" class="headerlink" title="小黄鸭 | Python逆向"></a>小黄鸭 | Python逆向</h3><p>Exinfo 查到为Python3.7写的程序 可以先用pyinstxtractor将其反汇编生成<code>.pyc</code>文件 再用uncompyle6进行反编译生成<code>.py</code>文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python pyinstxtractor.py duck.exe</span><br><span class="line">uncompyle6.exe 1.pyc &gt; duck.py</span><br></pre></td></tr></table></figure>

<p>没有进行混淆</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --------duck.py----------</span></span><br><span class="line"><span class="comment"># uncompyle6 version 3.7.4</span></span><br><span class="line"><span class="comment"># Python bytecode 3.7 (3394)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.11.4 (tags/v3.11.4:d2340ef, Jun  7 2023, 05:45:37) [MSC v.1934 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: 1.py</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">arr = <span class="string">&#x27;~h|p4gs`gJdN`thPwR`jDn`te1w`2|RNH&#x27;</span></span><br><span class="line">arr = <span class="built_in">list</span>(arr)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;快帮帮小黄鸭，找到它的钥匙&#x27;</span>)</span><br><span class="line">a = <span class="built_in">input</span>(<span class="string">&#x27;请输入你找到的钥匙&gt;:&#x27;</span>)</span><br><span class="line">a = <span class="built_in">list</span>(a)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">ord</span>(a[<span class="number">0</span>]) != <span class="number">83</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(a[<span class="number">1</span>]) != <span class="number">89</span> <span class="keyword">or</span> <span class="built_in">ord</span>(a[<span class="number">2</span>]) != <span class="number">67</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;不对喔~&#x27;</span>)</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line">    a = a[::-<span class="number">1</span>]</span><br><span class="line">    b = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">if</span> a[i].isalpha():</span><br><span class="line">            c = a[i]</span><br><span class="line">            c = <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) + <span class="number">13</span> - <span class="number">26</span> <span class="keyword">if</span> <span class="built_in">ord</span>(c) + <span class="number">13</span> &gt; (<span class="number">90</span> <span class="keyword">if</span> c &lt;= <span class="string">&#x27;Z&#x27;</span> <span class="keyword">else</span> <span class="number">122</span>) <span class="keyword">else</span> <span class="built_in">ord</span>(c) + <span class="number">13</span>)</span><br><span class="line">            b.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) + <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            b.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i]) + <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">chr</span>(<span class="built_in">ord</span>(a[<span class="number">1</span>])) != <span class="string">&#x27;s&#x27;</span> <span class="keyword">or</span> <span class="built_in">ord</span>(a[<span class="number">2</span>]) != <span class="number">109</span> <span class="keyword">or</span> <span class="built_in">chr</span>(<span class="built_in">ord</span>(a[<span class="number">17</span>])) != <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;呀呀呀，怎么算出来不对呀？&#x27;</span>)</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">        <span class="keyword">if</span> arr[i] == b[i]:</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cnt == <span class="built_in">len</span>(b):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;密码正确啦！！！，快去告诉小黄鸭吧~&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;密码不对喔~，请再想想吧&#x27;</span>)</span><br><span class="line"><span class="comment"># okay decompiling 1.pyc</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>简单的ROT13加密 写出脚本解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">key_o = <span class="string">&#x27;~h|p4gs`gJdN`thPwR`jDn`te1w`2|RNH&#x27;</span></span><br><span class="line">key_o = <span class="built_in">list</span>(key_o)</span><br><span class="line">key_o = key_o[::-<span class="number">1</span>]</span><br><span class="line">key = [<span class="built_in">ord</span>(val) <span class="keyword">for</span> val <span class="keyword">in</span> key_o]</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> key:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">chr</span>(each - <span class="number">2</span>).isalpha()):</span><br><span class="line">        c = each -<span class="number">2</span></span><br><span class="line">        c += <span class="number">13</span> <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= c <span class="keyword">and</span> c &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;m&#x27;</span>) <span class="keyword">or</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= c <span class="keyword">and</span> c &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;M&#x27;</span>) <span class="keyword">else</span> (-<span class="number">13</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(c), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(each - <span class="number">1</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># SYC&#123;1_h0pe_yOu_ChAse_YoUr_dr3ams&#125; 我Chase你的梦!</span></span><br></pre></td></tr></table></figure>

<h3 id="浪漫至死不渝-JS逆向"><a href="#浪漫至死不渝-JS逆向" class="headerlink" title="浪漫至死不渝 | JS逆向"></a>浪漫至死不渝 | JS逆向</h3><p>源码对变量名进行了混淆 去除混淆并对网页元素进行删去 得到主要逻辑</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">let</span> k=&#123;</span><br><span class="line">     <span class="attr">a</span>:<span class="number">0</span>,<span class="attr">b</span>:<span class="number">1</span>,<span class="attr">c</span>:<span class="number">2</span>,<span class="attr">d</span>:<span class="number">3</span>,<span class="attr">e</span>:<span class="number">4</span>,<span class="attr">f</span>:<span class="number">5</span>,<span class="attr">g</span>:<span class="number">6</span>,<span class="attr">h</span>:<span class="number">7</span>,<span class="attr">i</span>:<span class="number">8</span>,<span class="attr">j</span>:<span class="number">9</span>,<span class="attr">k</span>:<span class="number">10</span>,<span class="attr">l</span>:<span class="number">11</span>,<span class="attr">m</span>:<span class="number">12</span>,<span class="attr">n</span>:<span class="number">13</span>,<span class="attr">o</span>:<span class="number">14</span>,<span class="attr">p</span>:<span class="number">15</span>,<span class="attr">q</span>:<span class="number">16</span>,<span class="attr">r</span>:<span class="number">17</span>,<span class="attr">s</span>:<span class="number">18</span>,<span class="attr">t</span>:<span class="number">19</span>,<span class="attr">u</span>:<span class="number">20</span>,<span class="attr">v</span>:<span class="number">21</span>,<span class="attr">w</span>:<span class="number">22</span>,<span class="attr">x</span>:<span class="number">23</span>,<span class="attr">y</span>:<span class="number">24</span>,<span class="attr">z</span>:<span class="number">25</span>,</span><br><span class="line">     <span class="attr">A</span>:<span class="number">0</span>,<span class="attr">B</span>:<span class="number">1</span>,<span class="attr">C</span>:<span class="number">2</span>,<span class="attr">D</span>:<span class="number">3</span>,<span class="attr">E</span>:<span class="number">4</span>,<span class="attr">F</span>:<span class="number">5</span>,<span class="attr">G</span>:<span class="number">6</span>,<span class="attr">H</span>:<span class="number">7</span>,<span class="attr">I</span>:<span class="number">8</span>,<span class="attr">J</span>:<span class="number">9</span>,<span class="attr">K</span>:<span class="number">10</span>,<span class="attr">L</span>:<span class="number">11</span>,<span class="attr">M</span>:<span class="number">12</span>,<span class="attr">N</span>:<span class="number">13</span>,<span class="attr">O</span>:<span class="number">14</span>,<span class="attr">P</span>:<span class="number">15</span>,<span class="attr">Q</span>:<span class="number">16</span>,<span class="attr">R</span>:<span class="number">17</span>,<span class="attr">S</span>:<span class="number">18</span>,<span class="attr">T</span>:<span class="number">19</span>,<span class="attr">U</span>:<span class="number">20</span>,<span class="attr">V</span>:<span class="number">21</span>,<span class="attr">W</span>:<span class="number">22</span>,<span class="attr">X</span>:<span class="number">23</span>,<span class="attr">Y</span>:<span class="number">24</span>,<span class="attr">Z</span>:<span class="number">25</span></span><br><span class="line"> &#125; </span><br><span class="line"> <span class="keyword">let</span> a=[</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;A&quot;</span>,<span class="attr">yin</span>:<span class="number">7</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;B&quot;</span> ,<span class="attr">yin</span>:<span class="number">24</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;C&quot;</span> ,<span class="attr">yin</span>:<span class="number">1</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;D&quot;</span> ,<span class="attr">yin</span>:<span class="number">4</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;E&quot;</span> ,<span class="attr">yin</span>:<span class="number">5</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;F&quot;</span> ,<span class="attr">yin</span>:<span class="number">2</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;G&quot;</span> ,<span class="attr">yin</span>:<span class="number">6</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;H&quot;</span> ,<span class="attr">yin</span>:<span class="number">5</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;I&quot;</span> ,<span class="attr">yin</span>:<span class="number">8</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;J&quot;</span> ,<span class="attr">yin</span>:<span class="number">3</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;K&quot;</span> ,<span class="attr">yin</span>:<span class="number">9</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;L&quot;</span> ,<span class="attr">yin</span>:<span class="number">8</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;M&quot;</span> ,<span class="attr">yin</span>:<span class="number">11</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;N&quot;</span> ,<span class="attr">yin</span>:<span class="number">3</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;O&quot;</span> ,<span class="attr">yin</span>:<span class="number">7</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;P&quot;</span> ,<span class="attr">yin</span>:<span class="number">14</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;Q&quot;</span> ,<span class="attr">yin</span>:<span class="number">15</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;R&quot;</span> ,<span class="attr">yin</span>:<span class="number">16</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;S&quot;</span> ,<span class="attr">yin</span>:<span class="number">17</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;T&quot;</span> ,<span class="attr">yin</span>:<span class="number">18</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;U&quot;</span> ,<span class="attr">yin</span>:<span class="number">8</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;V&quot;</span> ,<span class="attr">yin</span>:<span class="number">20</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;W&quot;</span> ,<span class="attr">yin</span>:<span class="number">3</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;X&quot;</span> ,<span class="attr">yin</span>:<span class="number">2</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;Y&quot;</span> ,<span class="attr">yin</span>:<span class="number">23</span>, <span class="attr">str</span>:,</span><br><span class="line">     &#123;<span class="attr">name</span>:<span class="string">&quot;Z&quot;</span> ,<span class="attr">yin</span>:<span class="number">24</span>, <span class="attr">str</span>:</span><br><span class="line"> ];</span><br><span class="line">  </span><br><span class="line"><span class="keyword">let</span> target_2=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> key = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>);</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> target = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">fl</span>(<span class="params">e</span>)</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="keyword">if</span>(clickb==<span class="literal">true</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="keyword">const</span> num_of_fence = <span class="number">3</span>;</span><br><span class="line">         <span class="keyword">const</span> fence_key = <span class="string">&#x27;53X211WH04N&#x27;</span>;        </span><br><span class="line">         <span class="keyword">const</span> <span class="title class_">Text1</span> = <span class="title function_">decryptRailFence</span>(fence_key, num_of_fence);    <span class="comment">//Text1 = &#x27;510321H4XWN&#x27;</span></span><br><span class="line">        <span class="keyword">let</span> key = e.<span class="property">key</span>;</span><br><span class="line">     <span class="keyword">if</span>((key&lt;=<span class="string">&#x27;z&#x27;</span>&amp;&amp;key&gt;=<span class="string">&#x27;a&#x27;</span>)||(key&lt;=<span class="string">&#x27;Z&#x27;</span>&amp;&amp;key&gt;=<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="keyword">let</span> p=a[k[key]];</span><br><span class="line">         s += p.<span class="property">name</span>;</span><br><span class="line">         <span class="keyword">const</span> intArr = [];</span><br><span class="line">         <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.<span class="property">length</span>; i++)</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="keyword">const</span> charCode = s.<span class="title function_">charCodeAt</span>(i);</span><br><span class="line">             intArr.<span class="title function_">push</span>(charCode);                <span class="comment">//intArr记录s中每个字符对应的ASCII值</span></span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">if</span> (s.<span class="property">length</span> % <span class="number">18</span> == <span class="number">0</span>)</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="keyword">let</span> len = s.<span class="property">length</span> / <span class="number">18</span>;</span><br><span class="line">             <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">             &#123;</span><br><span class="line">                 <span class="keyword">for</span> (<span class="keyword">let</span> control = <span class="number">0</span>; control &lt; <span class="number">18</span>; control++)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">if</span> (control &lt; <span class="number">14</span>)</span><br><span class="line">                     &#123;</span><br><span class="line">                         intArr[i + control] ^= <span class="title class_">Text1</span>.<span class="title function_">charCodeAt</span>(control % <span class="number">7</span>);</span><br><span class="line">                         intArr[i + control] += <span class="number">10</span>;</span><br><span class="line">                     &#125;</span><br><span class="line">                     <span class="keyword">else</span></span><br><span class="line">                     &#123;</span><br><span class="line">                         intArr[i+ control] ^= <span class="title class_">Text1</span>.<span class="title function_">charCodeAt</span>(control -<span class="number">7</span>);</span><br><span class="line">                         intArr[i + control] += <span class="number">99</span>;</span><br><span class="line">                         &#125;</span><br><span class="line">                     &#125;</span><br><span class="line">            &#125;</span><br><span class="line">         <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.<span class="property">length</span>; i++)</span><br><span class="line">         &#123;</span><br><span class="line">            <span class="keyword">let</span> cnt = <span class="number">0</span>;</span><br><span class="line">             <span class="keyword">if</span> (intArr[i] == key[<span class="number">0</span>])</span><br><span class="line">             &#123;</span><br><span class="line">                 <span class="keyword">for</span> (<span class="keyword">let</span> control = <span class="number">0</span>; control &lt; key.<span class="property">length</span> &amp;&amp; i+ control &lt; intArr.<span class="property">length</span>; control++)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">if</span> (intArr[i + control] == key[control])</span><br><span class="line">                     &#123;</span><br><span class="line">                        cnt++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">if</span> (cnt &gt;= <span class="number">18</span>) &#123;</span><br><span class="line">                target = <span class="literal">true</span>;</span><br><span class="line">             <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">             </span><br><span class="line">             </span><br><span class="line">        &#125;</span><br><span class="line">         <span class="keyword">if</span>(target&amp;&amp;target_2==<span class="number">0</span>)</span><br><span class="line">         &#123;</span><br><span class="line">             print <span class="string">&quot;ok&quot;</span></span><br><span class="line">     &#125;</span><br><span class="line">     &#125;  </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>主要是先用栅栏密码对key进行加密 然后对输入逐位字符进行加密 写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>]</span><br><span class="line">Text1 = <span class="string">&#x27;5201314WXHN&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">14</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>((key[i] - <span class="number">10</span>) ^ <span class="built_in">ord</span>(Text1[i % <span class="number">7</span>])), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>((key[i] - <span class="number">99</span>) ^ <span class="built_in">ord</span>(Text1[i - <span class="number">7</span>])), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># FJIAXUEFJIAXUEWXHN</span></span><br></pre></td></tr></table></figure>

<h3 id="寻找初音未来-Go语言逆向-一坨go史"><a href="#寻找初音未来-Go语言逆向-一坨go史" class="headerlink" title="寻找初音未来 | Go语言逆向 | 一坨go史"></a>寻找初音未来 | Go语言逆向 | 一坨go史</h3><p>go语言所有的字符串在内存上都是连续的 所以对一个字符串对应的长度和偏移量非常重要</p>
<p>附件放到虚拟机中打开 发现提示输入初音未来色 上网搜索知道是<code>39C5BB</code> 用IDA打开 发现这个输入通过某些加密算法得到key</p>
<p>再用该key进行RC4加密直接动态调试得到key为<code>CCCCCCCCCCCCCCCCCC</code> 用python内置的RC4解密算法进行解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="string">b&#x27;\x25\x6F\x3D\x6C\xF9\xE0\xCF\x3F\x2E\x24\xC6\x7B\x81\xBF\x55\x4F\x0D\x99\x87\x47\x48\xF7\xB9\x98\xFB\x1B\x22\xEC\x84\x23\xFD\xB2&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;CCCCCCCCCCCCCCCCCC&#x27;</span></span><br><span class="line"></span><br><span class="line">cipher = ARC4.new(key)</span><br><span class="line">plaintext = cipher.decrypt(ciphertext=ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;N0thing_1s_sEriOus_But_MIku&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="AES-AES-AES算法魔改"><a href="#AES-AES-AES算法魔改" class="headerlink" title="AES! AES? | AES算法魔改"></a>AES! AES? | AES算法魔改</h3><p>Exinfo查到无壳 64位win程序 IDA64打开 伪代码中看到核心加密逻辑是<code>Shiftrow()</code>和<code>transform()</code>伪代码如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">ShiftRow</span><span class="params">(__int64 flag)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; i += <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; i / <span class="number">4</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = *(<span class="number">4</span>i64 * i + flag);</span><br><span class="line">      <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">2</span>; ++k )</span><br><span class="line">        *(<span class="number">4</span>i64 * (i + k) + flag) = *(flag + <span class="number">4</span> * (i + k + <span class="number">1</span>i64));</span><br><span class="line">      *(<span class="number">4</span>i64 * (i + k) + flag) = v1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">__int64 __fastcall <span class="title function_">tansform</span><span class="params">(__int64 flag)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v2; <span class="comment">// dl</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  _DWORD *v4; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v5[<span class="number">20</span>]; <span class="comment">// [rsp+0h] [rbp-60h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+50h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+54h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+5Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    v5[i] = *(<span class="number">4</span>i64 * i + flag);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">3</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">3</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      *(flag + <span class="number">4</span>i64 * v9) = v5[<span class="number">4</span> * k + j];</span><br><span class="line">      v2 = S[*(<span class="number">4</span>i64 * v9 + flag)];</span><br><span class="line">      v3 = v9++;</span><br><span class="line">      v4 = (flag + <span class="number">4</span>i64 * v3);</span><br><span class="line">      result = v2;</span><br><span class="line">      *v4 = v2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 整体代码如下 其中还有一个异或加密 用来实现AES算法</span></span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> Str[<span class="number">48</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> flag1[<span class="number">16</span>]; <span class="comment">// [rsp+50h] [rbp-30h] BYREF</span></span><br><span class="line">  _BYTE flag2[<span class="number">96</span>]; <span class="comment">// [rsp+90h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">8</span>]; <span class="comment">// [rsp+F0h] [rbp+70h] BYREF</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+F8h] [rbp+78h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+100h] [rbp+80h]</span></span><br><span class="line">  <span class="type">char</span> v10[<span class="number">20</span>]; <span class="comment">// [rsp+110h] [rbp+90h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v11[<span class="number">15</span>]; <span class="comment">// [rsp+124h] [rbp+A4h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v12[<span class="number">13</span>]; <span class="comment">// [rsp+133h] [rbp+B3h] BYREF</span></span><br><span class="line">  __int64 v13[<span class="number">3</span>]; <span class="comment">// [rsp+140h] [rbp+C0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+158h] [rbp+D8h]</span></span><br><span class="line">  __int16 v15; <span class="comment">// [rsp+15Ch] [rbp+DCh]</span></span><br><span class="line">  <span class="type">char</span> v16[<span class="number">16</span>]; <span class="comment">// [rsp+160h] [rbp+E0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v17[<span class="number">40</span>]; <span class="comment">// [rsp+170h] [rbp+F0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v18[<span class="number">176</span>]; <span class="comment">// [rsp+210h] [rbp+190h] BYREF</span></span><br><span class="line">  __int16 v19; <span class="comment">// [rsp+2C0h] [rbp+240h]</span></span><br><span class="line">  <span class="type">char</span> v20; <span class="comment">// [rsp+2C2h] [rbp+242h]</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// [rsp+2C4h] [rbp+244h]</span></span><br><span class="line">  <span class="type">int</span> _32; <span class="comment">// [rsp+2C8h] [rbp+248h]</span></span><br><span class="line">  <span class="type">int</span> i2; <span class="comment">// [rsp+2CCh] [rbp+24Ch]</span></span><br><span class="line">  <span class="type">int</span> cnt; <span class="comment">// [rsp+2D0h] [rbp+250h]</span></span><br><span class="line">  <span class="type">int</span> i1; <span class="comment">// [rsp+2D4h] [rbp+254h]</span></span><br><span class="line">  <span class="type">int</span> nn; <span class="comment">// [rsp+2D8h] [rbp+258h]</span></span><br><span class="line">  <span class="type">int</span> mm; <span class="comment">// [rsp+2DCh] [rbp+25Ch]</span></span><br><span class="line">  <span class="type">int</span> jj; <span class="comment">// [rsp+2E0h] [rbp+260h]</span></span><br><span class="line">  <span class="type">int</span> kk; <span class="comment">// [rsp+2E4h] [rbp+264h]</span></span><br><span class="line">  <span class="type">int</span> ii; <span class="comment">// [rsp+2E8h] [rbp+268h]</span></span><br><span class="line">  <span class="type">int</span> n; <span class="comment">// [rsp+2ECh] [rbp+26Ch]</span></span><br><span class="line">  <span class="type">int</span> m; <span class="comment">// [rsp+2F0h] [rbp+270h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+2F4h] [rbp+274h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+2F8h] [rbp+278h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+2FCh] [rbp+27Ch]</span></span><br><span class="line"></span><br><span class="line">  (_main)(argc, argv, envp);</span><br><span class="line">  <span class="built_in">memset</span>(v18, <span class="number">0</span>, <span class="keyword">sizeof</span>(v18));</span><br><span class="line">  v19 = <span class="number">0</span>;</span><br><span class="line">  v20 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v17, <span class="number">0</span>, <span class="keyword">sizeof</span>(v17));</span><br><span class="line">  v17[<span class="number">0</span>] = <span class="number">0xE0</span>;</span><br><span class="line">  v17[<span class="number">1</span>] = <span class="number">0xFFFFFF05</span>;</span><br><span class="line">  v17[<span class="number">2</span>] = <span class="number">0xFFFFFF6E</span>;</span><br><span class="line">  v17[<span class="number">3</span>] = <span class="number">0xFFFFFFC2</span>;</span><br><span class="line">  v17[<span class="number">4</span>] = <span class="number">0xFFFFFF6E</span>;</span><br><span class="line">  v17[<span class="number">5</span>] = <span class="number">0xFFFFFF99</span>;</span><br><span class="line">  v17[<span class="number">6</span>] = <span class="number">0xFFFFFF68</span>;</span><br><span class="line">  v17[<span class="number">7</span>] = <span class="number">0x45</span>;</span><br><span class="line">  v17[<span class="number">8</span>] = <span class="number">0xFFFFFF7D</span>;</span><br><span class="line">  v17[<span class="number">9</span>] = <span class="number">0xFFFFFF1F</span>;</span><br><span class="line">  v17[<span class="number">10</span>] = <span class="number">0xFFFFFF3F</span>;</span><br><span class="line">  v17[<span class="number">11</span>] = <span class="number">0xFFFFFFF9</span>;</span><br><span class="line">  v17[<span class="number">12</span>] = <span class="number">0xFFFFFF97</span>;</span><br><span class="line">  v17[<span class="number">13</span>] = <span class="number">0xFFFFFF76</span>;</span><br><span class="line">  v17[<span class="number">14</span>] = <span class="number">0x3B</span>;</span><br><span class="line">  v17[<span class="number">15</span>] = <span class="number">0x92</span>;</span><br><span class="line">  v17[<span class="number">16</span>] = <span class="number">0x2F</span>;</span><br><span class="line">  v17[<span class="number">17</span>] = <span class="number">0xFFFFFF44</span>;</span><br><span class="line">  v17[<span class="number">18</span>] = <span class="number">0xFFFFFF06</span>;</span><br><span class="line">  v17[<span class="number">19</span>] = <span class="number">0xFFFFFF67</span>;</span><br><span class="line">  v17[<span class="number">20</span>] = <span class="number">0xFFFFFFA8</span>;</span><br><span class="line">  v17[<span class="number">21</span>] = <span class="number">0xFFFFFFEB</span>;</span><br><span class="line">  v17[<span class="number">22</span>] = <span class="number">0xFFFFFFEC</span>;</span><br><span class="line">  v17[<span class="number">23</span>] = <span class="number">0x4A</span>;</span><br><span class="line">  v17[<span class="number">24</span>] = <span class="number">0xFFFFFF6F</span>;</span><br><span class="line">  v17[<span class="number">25</span>] = <span class="number">0xFFFFFFE8</span>;</span><br><span class="line">  v17[<span class="number">26</span>] = <span class="number">0xFFFFFF35</span>;</span><br><span class="line">  v17[<span class="number">27</span>] = <span class="number">0xFFFFFFF9</span>;</span><br><span class="line">  v17[<span class="number">28</span>] = <span class="number">0xFFFFFFAC</span>;</span><br><span class="line">  v17[<span class="number">29</span>] = <span class="number">0xFFFFFFA7</span>;</span><br><span class="line">  v17[<span class="number">30</span>] = <span class="number">0x8C</span>;</span><br><span class="line">  v17[<span class="number">31</span>] = <span class="number">0x71</span>;</span><br><span class="line">  qmemcpy(v16, <span class="string">&quot;nyi&quot;</span>, <span class="number">3</span>);</span><br><span class="line">  v16[<span class="number">3</span>] = <span class="number">-125</span>;</span><br><span class="line">  v16[<span class="number">4</span>] = <span class="number">121</span>;</span><br><span class="line">  v16[<span class="number">5</span>] = <span class="number">127</span>;</span><br><span class="line">  v16[<span class="number">6</span>] = <span class="number">105</span>;</span><br><span class="line">  v16[<span class="number">7</span>] = <span class="number">117</span>;</span><br><span class="line">  v16[<span class="number">8</span>] = <span class="number">121</span>;</span><br><span class="line">  v16[<span class="number">9</span>] = <span class="number">120</span>;</span><br><span class="line">  v16[<span class="number">10</span>] = <span class="number">-127</span>;</span><br><span class="line">  v16[<span class="number">11</span>] = <span class="number">105</span>;</span><br><span class="line">  v16[<span class="number">12</span>] = <span class="number">93</span>;</span><br><span class="line">  v16[<span class="number">13</span>] = <span class="number">99</span>;</span><br><span class="line">  v16[<span class="number">14</span>] = <span class="number">77</span>;</span><br><span class="line">  v16[<span class="number">15</span>] = <span class="number">73</span>;</span><br><span class="line">  v13[<span class="number">0</span>] = <span class="number">0x78732A6F6D6B767A</span>i64;</span><br><span class="line">  v13[<span class="number">1</span>] = <span class="number">0x7C7F79832A7E7F79</span>i64;</span><br><span class="line">  v13[<span class="number">2</span>] = <span class="number">0x142A44716B76702A</span>i64;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  v10[<span class="number">0</span>] = <span class="number">-125</span>;</span><br><span class="line">  v10[<span class="number">1</span>] = <span class="number">111</span>;</span><br><span class="line">  v10[<span class="number">2</span>] = <span class="number">125</span>;</span><br><span class="line">  v10[<span class="number">3</span>] = <span class="number">43</span>;</span><br><span class="line">  v10[<span class="number">4</span>] = <span class="number">42</span>;</span><br><span class="line">  v10[<span class="number">5</span>] = <span class="number">-125</span>;</span><br><span class="line">  v10[<span class="number">6</span>] = <span class="number">121</span>;</span><br><span class="line">  v10[<span class="number">7</span>] = <span class="number">127</span>;</span><br><span class="line">  v10[<span class="number">8</span>] = <span class="number">42</span>;</span><br><span class="line">  v10[<span class="number">9</span>] = <span class="number">107</span>;</span><br><span class="line">  v10[<span class="number">10</span>] = <span class="number">124</span>;</span><br><span class="line">  v10[<span class="number">11</span>] = <span class="number">111</span>;</span><br><span class="line">  v10[<span class="number">12</span>] = <span class="number">42</span>;</span><br><span class="line">  v10[<span class="number">13</span>] = <span class="number">124</span>;</span><br><span class="line">  v10[<span class="number">14</span>] = <span class="number">115</span>;</span><br><span class="line">  v10[<span class="number">15</span>] = <span class="number">113</span>;</span><br><span class="line">  v10[<span class="number">16</span>] = <span class="number">114</span>;</span><br><span class="line">  v10[<span class="number">17</span>] = <span class="number">126</span>;</span><br><span class="line">  v10[<span class="number">18</span>] = <span class="number">43</span>;</span><br><span class="line">  v10[<span class="number">19</span>] = <span class="number">20</span>;</span><br><span class="line">  qmemcpy(v11, <span class="string">&quot;\nxy&quot;</span>, <span class="number">3</span>);</span><br><span class="line">  v11[<span class="number">3</span>] = <span class="number">-120</span>;</span><br><span class="line">  v11[<span class="number">4</span>] = <span class="number">126</span>;</span><br><span class="line">  v11[<span class="number">5</span>] = <span class="number">124</span>;</span><br><span class="line">  v11[<span class="number">6</span>] = <span class="number">-125</span>;</span><br><span class="line">  v11[<span class="number">7</span>] = <span class="number">42</span>;</span><br><span class="line">  v11[<span class="number">8</span>] = <span class="number">107</span>;</span><br><span class="line">  v11[<span class="number">9</span>] = <span class="number">113</span>;</span><br><span class="line">  v11[<span class="number">10</span>] = <span class="number">107</span>;</span><br><span class="line">  v11[<span class="number">11</span>] = <span class="number">115</span>;</span><br><span class="line">  v11[<span class="number">12</span>] = <span class="number">120</span>;</span><br><span class="line">  v11[<span class="number">13</span>] = <span class="number">-120</span>;</span><br><span class="line">  v11[<span class="number">14</span>] = <span class="number">20</span>;</span><br><span class="line">  qmemcpy(v12, <span class="string">&quot;\nxy&quot;</span>, <span class="number">3</span>);</span><br><span class="line">  v12[<span class="number">3</span>] = <span class="number">-120</span>;</span><br><span class="line">  v12[<span class="number">4</span>] = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">23</span>; ++i )</span><br><span class="line">    *(v13 + i) -= <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">39</span>; ++j )</span><br><span class="line">    v10[j] -= <span class="number">10</span>;</span><br><span class="line">  *v7 = <span class="number">0</span>i64;</span><br><span class="line">  v8 = <span class="number">0</span>i64;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, v13);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  _32 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  v21 = <span class="built_in">strlen</span>(v7);</span><br><span class="line">  <span class="keyword">if</span> ( _32 != <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, &amp;v12[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">15</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    v16[k] -= <span class="number">10</span>;</span><br><span class="line">    v7[k] = v16[k];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( Str[<span class="number">5</span>] != <span class="string">&#x27;.&#x27;</span> || Str[<span class="number">10</span>] != <span class="string">&#x27;l&#x27;</span> || Str[<span class="number">17</span>] != <span class="string">&#x27;0&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, &amp;v12[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt;= <span class="number">15</span>; ++m )</span><br><span class="line">    v18[m] = v7[m];                             <span class="comment">// v18 = do_you_konw_SYC?</span></span><br><span class="line">  <span class="keyword">for</span> ( n = <span class="number">1</span>; n &lt;= <span class="number">10</span>; ++n )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( ii = <span class="number">0</span>; ii &lt;= <span class="number">31</span>; ++ii )</span><br><span class="line">      v18[<span class="number">16</span> * n + ii] = v18[<span class="number">16</span> * n - <span class="number">16</span> + ii] ^ S[v18[<span class="number">16</span> * n - <span class="number">16</span> + ii]];</span><br><span class="line">  &#125;</span><br><span class="line">  HIBYTE(v19) = <span class="string">&#x27;9&#x27;</span>;</span><br><span class="line">  kk = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( jj = <span class="number">0</span>; jj &lt; _32; ++jj )</span><br><span class="line">    flag1[jj] = S[Str[jj]];</span><br><span class="line">  <span class="keyword">for</span> ( kk = <span class="number">0</span>; kk &lt;= <span class="number">0</span>; ++kk )</span><br><span class="line">  &#123;</span><br><span class="line">    ShiftRow(flag1);                            <span class="comment">// 将第n行的前(n - 1)个元素向右移动(5 - n)格</span></span><br><span class="line">    ShiftRow(flag2);</span><br><span class="line">    tansform(flag1);</span><br><span class="line">    tansform(flag2);</span><br><span class="line">    <span class="keyword">for</span> ( mm = <span class="number">0</span>; mm &lt;= <span class="number">15</span>; ++mm )</span><br><span class="line">    &#123;</span><br><span class="line">      flag1[mm] ^= v18[<span class="number">16</span> * kk + mm];           <span class="comment">// 将flag与key1异或</span></span><br><span class="line">      flag1[mm + <span class="number">16</span>] ^= v18[<span class="number">16</span> * kk + mm];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( nn = <span class="number">0</span>; nn &lt; _32; ++nn )</span><br><span class="line">      flag1[nn] = S[flag1[nn]];                 <span class="comment">// 将flag中的值替换为S中以flag的值为索引的值</span></span><br><span class="line">  &#125;</span><br><span class="line">  ShiftRow(flag1);</span><br><span class="line">  ShiftRow(flag2);</span><br><span class="line">  <span class="keyword">for</span> ( i1 = <span class="number">0</span>; i1 &lt;= <span class="number">15</span>; ++i1 )                <span class="comment">// 将flag与key2异或</span></span><br><span class="line">  &#123;</span><br><span class="line">    flag1[i1] ^= v18[<span class="number">16</span> * kk + i1];</span><br><span class="line">    flag1[i1 + <span class="number">16</span>] ^= v18[<span class="number">16</span> * kk + i1];</span><br><span class="line">  &#125;</span><br><span class="line">  cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i2 = <span class="number">0</span>; i2 &lt;= <span class="number">31</span>; ++i2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( flag1[i2] == v17[i2] )</span><br><span class="line">      ++cnt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( cnt &lt;= <span class="number">31</span> )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, &amp;v11[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, v10);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>据此写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">S = [<span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>, <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, </span><br><span class="line">  <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, </span><br><span class="line">  <span class="number">0x72</span>, <span class="number">0xC0</span>, <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, </span><br><span class="line">  <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>, <span class="number">0x04</span>, <span class="number">0xC7</span>, </span><br><span class="line">  <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, </span><br><span class="line">  <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>, <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, </span><br><span class="line">  <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>, </span><br><span class="line">  <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, </span><br><span class="line">  <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>, <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, </span><br><span class="line">  <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, </span><br><span class="line">  <span class="number">0x9F</span>, <span class="number">0xA8</span>, <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, </span><br><span class="line">  <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>, <span class="number">0xCD</span>, <span class="number">0x0C</span>, </span><br><span class="line">  <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, </span><br><span class="line">  <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>, <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, </span><br><span class="line">  <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, </span><br><span class="line">  <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, </span><br><span class="line">  <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, </span><br><span class="line">  <span class="number">0xAE</span>, <span class="number">0x08</span>, <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, </span><br><span class="line">  <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>, <span class="number">0x70</span>, <span class="number">0x3E</span>, </span><br><span class="line">  <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, </span><br><span class="line">  <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>, <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, </span><br><span class="line">  <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>, </span><br><span class="line">  <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, </span><br><span class="line">  <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>]</span><br><span class="line">key_ = <span class="string">&quot;do_you_konw_SYC?&quot;</span></span><br><span class="line">v17 = [<span class="literal">None</span>] * <span class="number">32</span></span><br><span class="line">v17[<span class="number">0</span>] = <span class="number">0xE0</span></span><br><span class="line">v17[<span class="number">1</span>] = <span class="number">0x05</span></span><br><span class="line">v17[<span class="number">2</span>] = <span class="number">0x6E</span></span><br><span class="line">v17[<span class="number">3</span>] = <span class="number">0xC2</span></span><br><span class="line">v17[<span class="number">4</span>] = <span class="number">0x6E</span></span><br><span class="line">v17[<span class="number">5</span>] = <span class="number">0x99</span></span><br><span class="line">v17[<span class="number">6</span>] = <span class="number">0x68</span></span><br><span class="line">v17[<span class="number">7</span>] = <span class="number">0x45</span></span><br><span class="line">v17[<span class="number">8</span>] = <span class="number">0x7D</span></span><br><span class="line">v17[<span class="number">9</span>] = <span class="number">0x1F</span></span><br><span class="line">v17[<span class="number">10</span>] = <span class="number">0x3F</span></span><br><span class="line">v17[<span class="number">11</span>] = <span class="number">0xF9</span></span><br><span class="line">v17[<span class="number">12</span>] = <span class="number">0x97</span></span><br><span class="line">v17[<span class="number">13</span>] = <span class="number">0x76</span></span><br><span class="line">v17[<span class="number">14</span>] = <span class="number">0x3B</span></span><br><span class="line">v17[<span class="number">15</span>] = <span class="number">0x92</span></span><br><span class="line">v17[<span class="number">16</span>] = <span class="number">0x2F</span></span><br><span class="line">v17[<span class="number">17</span>] = <span class="number">0x44</span></span><br><span class="line">v17[<span class="number">18</span>] = <span class="number">0x06</span></span><br><span class="line">v17[<span class="number">19</span>] = <span class="number">0x67</span></span><br><span class="line">v17[<span class="number">20</span>] = <span class="number">0xA8</span></span><br><span class="line">v17[<span class="number">21</span>] = <span class="number">0xEB</span></span><br><span class="line">v17[<span class="number">22</span>] = <span class="number">0xEC</span></span><br><span class="line">v17[<span class="number">23</span>] = <span class="number">0x4A</span></span><br><span class="line">v17[<span class="number">24</span>] = <span class="number">0x6F</span></span><br><span class="line">v17[<span class="number">25</span>] = <span class="number">0xE8</span></span><br><span class="line">v17[<span class="number">26</span>] = <span class="number">0x35</span></span><br><span class="line">v17[<span class="number">27</span>] = <span class="number">0xF9</span></span><br><span class="line">v17[<span class="number">28</span>] = <span class="number">0xAC</span></span><br><span class="line">v17[<span class="number">29</span>] = <span class="number">0xA7</span></span><br><span class="line">v17[<span class="number">30</span>] = <span class="number">0x8C</span></span><br><span class="line">v17[<span class="number">31</span>] = <span class="number">0x71</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_row</span>(<span class="params">flag:<span class="built_in">list</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            flag[<span class="number">4</span> * i + <span class="number">3</span> - k], flag[<span class="number">4</span> * i + <span class="number">3</span> - k - <span class="number">1</span>] = flag[<span class="number">4</span> * i + <span class="number">3</span> - k - <span class="number">1</span>], flag[<span class="number">4</span> * i + <span class="number">3</span> - k]</span><br><span class="line">  <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key1 = []</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> key_:</span><br><span class="line">  key1.append(<span class="built_in">ord</span>(each) &amp; <span class="number">0xFF</span>)</span><br><span class="line">key2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">  key2.append(key1[i] ^ S[key1[i]] &amp; <span class="number">0xFF</span>)</span><br><span class="line"></span><br><span class="line">flag_after = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">  temp = v17[i] ^ key2[i % <span class="number">0x10</span>]</span><br><span class="line">  flag_after.append(temp)</span><br><span class="line"></span><br><span class="line">flag  = shift_row(flag_after[<span class="number">0</span> :<span class="number">16</span>])</span><br><span class="line">flag += shift_row(flag_after[<span class="number">16</span>:<span class="number">32</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">  flag[i] = S.index(flag[i])</span><br><span class="line">  flag[i] ^= key1[i % <span class="number">0x10</span>]</span><br><span class="line"></span><br><span class="line">flag1 = [<span class="literal">None</span>] * <span class="number">16</span></span><br><span class="line">flag2 = [<span class="literal">None</span>] * <span class="number">16</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    flag1[<span class="number">4</span> * j + i] = S.index(flag[cnt])</span><br><span class="line">    cnt += <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    flag2[<span class="number">4</span> * j + i] = S.index(flag[cnt])</span><br><span class="line">    cnt += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">flag_last  = shift_row(flag1)</span><br><span class="line">flag_last += shift_row(flag2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> flag_last:</span><br><span class="line">  t = S.index(each)</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(t), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># SYC&#123;0.o_Thls_1s_n0t_A3s_(q^_^p)&#125;</span></span><br></pre></td></tr></table></figure>

<p>另外 不要手抄key不要手抄key不要手抄key不要手抄key不要手抄key不要手抄key不要手抄key不要手抄key不要手抄key不要手抄key</p>
<h3 id="ezandroid-安卓逆向"><a href="#ezandroid-安卓逆向" class="headerlink" title="ezandroid | 安卓逆向"></a>ezandroid | 安卓逆向</h3><p>apk用jeb打开 有两个主要活动如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.babyapk_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.view.View.OnClickListener;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> b.f;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">f</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">b</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span>[] a;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">b</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.a = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">2023708229</span>, -<span class="number">158607964</span>, <span class="number">0x81963FFA</span>, <span class="number">0x458FAC58</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> EditText o;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span>  <span class="comment">// b.f</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle0)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Handler</span>();</span><br><span class="line">        <span class="built_in">super</span>.onCreate(bundle0);</span><br><span class="line">        <span class="built_in">this</span>.setContentView(<span class="number">0x7F0B001C</span>);  <span class="comment">// layout:activity_main</span></span><br><span class="line">        <span class="type">Button</span> <span class="variable">button0</span> <span class="operator">=</span> (Button)<span class="built_in">this</span>.findViewById(<span class="number">0x7F080057</span>);  <span class="comment">// id:button</span></span><br><span class="line">        <span class="built_in">this</span>.o = (EditText)<span class="built_in">this</span>.findViewById(<span class="number">0x7F080097</span>);  <span class="comment">// id:edit_text</span></span><br><span class="line">        button0.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span>  <span class="comment">// android.view.View$OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view0)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.o.getText().toString();</span><br><span class="line">                <span class="keyword">if</span>(s.length() &gt; <span class="number">24</span>) &#123;</span><br><span class="line">                    MainActivity.<span class="built_in">this</span>.o.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                    s = MainActivity.<span class="built_in">this</span>.o.getText().toString();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(((s.length() == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) | (s.length() % <span class="number">24</span> == <span class="number">0</span> ? <span class="number">0</span> : <span class="number">1</span>)) != <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> <span class="number">24</span> - s.length() % <span class="number">24</span>;</span><br><span class="line">                    <span class="type">StringBuilder</span> <span class="variable">stringBuilder0</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(s);</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">v1</span> <span class="operator">=</span> <span class="number">0</span>; v1 &lt; v; ++v1) &#123;</span><br><span class="line">                        stringBuilder0.append(<span class="string">&#x27;X&#x27;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    s = stringBuilder0.toString();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">StringBuilder</span> <span class="variable">stringBuilder1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                <span class="type">StringBuilder</span> <span class="variable">stringBuilder2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">v2</span> <span class="operator">=</span> <span class="number">0</span>; v2 &lt; s.length(); ++v2) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(v2 % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                        stringBuilder1.append(s.charAt(v2));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        stringBuilder2.append(s.charAt(v2));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">b</span> <span class="variable">mainActivity$b0</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">b</span>(MainActivity.<span class="built_in">this</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> stringBuilder2.toString();</span><br><span class="line">                <span class="type">byte</span>[] arr_b = stringBuilder1.toString().getBytes();</span><br><span class="line">                <span class="type">int</span> <span class="variable">v3</span> <span class="operator">=</span> arr_b.length &gt;&gt; <span class="number">2</span>;</span><br><span class="line">                <span class="type">int</span>[] arr_v = <span class="keyword">new</span> <span class="title class_">int</span>[v3];</span><br><span class="line">                <span class="type">int</span> <span class="variable">v5</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">v4</span> <span class="operator">=</span> <span class="number">0</span>; v4 &lt; arr_b.length; v4 += <span class="number">4</span>) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">v6</span> <span class="operator">=</span> arr_b[v4 + <span class="number">3</span>];</span><br><span class="line">                    <span class="keyword">if</span>(v6 &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                        v6 += <span class="number">0x100</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="type">int</span> <span class="variable">v7</span> <span class="operator">=</span> arr_b[v4 + <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span>(v7 &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                        v7 += <span class="number">0x100</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="type">int</span> <span class="variable">v8</span> <span class="operator">=</span> arr_b[v4 + <span class="number">1</span>];</span><br><span class="line">                    <span class="keyword">if</span>(v8 &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                        v8 += <span class="number">0x100</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    arr_v[v5] = v6 | v7 &lt;&lt; <span class="number">8</span> | v8 &lt;&lt; <span class="number">16</span> | arr_b[v4] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">                    ++v5;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">int</span> <span class="variable">v9</span> <span class="operator">=</span> arr_v[<span class="number">0</span>];</span><br><span class="line">                <span class="type">int</span> <span class="variable">v10</span> <span class="operator">=</span> arr_v[<span class="number">1</span>];</span><br><span class="line">                <span class="type">int</span> <span class="variable">v11</span> <span class="operator">=</span> arr_v[<span class="number">2</span>];</span><br><span class="line">                <span class="type">int</span>[] arr_v1 = mainActivity$b0.a;</span><br><span class="line">                <span class="type">int</span> <span class="variable">key_0</span> <span class="operator">=</span> arr_v1[<span class="number">0</span>];</span><br><span class="line">                <span class="type">int</span> <span class="variable">key_1</span> <span class="operator">=</span> arr_v1[<span class="number">1</span>];</span><br><span class="line">                <span class="type">int</span> <span class="variable">key_2</span> <span class="operator">=</span> arr_v1[<span class="number">2</span>];</span><br><span class="line">                <span class="type">int</span> <span class="variable">key_3</span> <span class="operator">=</span> arr_v1[<span class="number">3</span>];</span><br><span class="line">                <span class="type">int</span> <span class="variable">v16</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">v17</span> <span class="operator">=</span> <span class="number">0</span>; v17 &lt; <span class="number">0x20</span>; ++v17) &#123;</span><br><span class="line">                    v16 += -<span class="number">1640531527</span>;</span><br><span class="line">                    v9 += (v10 &lt;&lt; <span class="number">4</span>) + key_0 ^ v10 + v16 ^ (v10 &gt;&gt; <span class="number">5</span>) + key_1;</span><br><span class="line">                    v10 += (v9 &lt;&lt; <span class="number">4</span>) + key_2 ^ v9 + v16 ^ (v9 &gt;&gt; <span class="number">5</span>) + key_3;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                arr_v[<span class="number">0</span>] = v9;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">v18</span> <span class="operator">=</span> <span class="number">0</span>; v18 &lt; <span class="number">0x20</span>; ++v18) &#123;</span><br><span class="line">                    v16 += -<span class="number">1640531527</span>;</span><br><span class="line">                    v11 += (v10 &lt;&lt; <span class="number">4</span>) + key_0 ^ v10 + v16 ^ (v10 &gt;&gt; <span class="number">5</span>) + key_1;</span><br><span class="line">                    v10 += (v11 &lt;&lt; <span class="number">4</span>) + key_2 ^ v11 + v16 ^ (v11 &gt;&gt; <span class="number">5</span>) + key_3;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                arr_v[<span class="number">1</span>] = v11;</span><br><span class="line">                arr_v[<span class="number">2</span>] = v10;</span><br><span class="line">                <span class="type">byte</span>[] arr_b1 = <span class="keyword">new</span> <span class="title class_">byte</span>[v3 &lt;&lt; <span class="number">2</span>];</span><br><span class="line">                <span class="type">int</span> <span class="variable">v20</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">v19</span> <span class="operator">=</span> <span class="number">0</span>; v19 &lt; v3; ++v19) &#123;</span><br><span class="line">                    arr_b1[v20 + <span class="number">3</span>] = (<span class="type">byte</span>)(arr_v[v19] &amp; <span class="number">0xFF</span>);</span><br><span class="line">                    arr_b1[v20 + <span class="number">2</span>] = (<span class="type">byte</span>)(arr_v[v19] &gt;&gt; <span class="number">8</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">                    arr_b1[v20 + <span class="number">1</span>] = (<span class="type">byte</span>)(arr_v[v19] &gt;&gt; <span class="number">16</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">                    arr_b1[v20] = (<span class="type">byte</span>)(arr_v[v19] &gt;&gt; <span class="number">24</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">                    v20 += <span class="number">4</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">v21</span> <span class="operator">=</span> <span class="number">0</span>; v21 &lt; <span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;-<span class="number">91</span>, -<span class="number">8</span>, -<span class="number">110</span>, -<span class="number">55</span>, -<span class="number">49</span>, <span class="number">75</span>, <span class="number">0x73</span>, <span class="number">13</span>, -<span class="number">76</span>, (<span class="type">byte</span>)<span class="number">0x8F</span>, <span class="number">102</span>, <span class="number">80</span>&#125;.length; ++v21) &#123;</span><br><span class="line">                    System.out.println(((<span class="type">int</span>)arr_b1[v21]));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">int</span> <span class="variable">v23</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">v22</span> <span class="operator">=</span> <span class="number">0</span>; <span class="literal">true</span>; ++v22) &#123;</span><br><span class="line">                    <span class="type">byte</span>[] arr_b2 = <span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;-<span class="number">91</span>, -<span class="number">8</span>, -<span class="number">110</span>, -<span class="number">55</span>, -<span class="number">49</span>, <span class="number">75</span>, <span class="number">0x73</span>, <span class="number">13</span>, -<span class="number">76</span>, (<span class="type">byte</span>)<span class="number">0x8F</span>, <span class="number">102</span>, <span class="number">80</span>&#125;;</span><br><span class="line">                    <span class="keyword">if</span>(v22 &gt;= arr_b2.length) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span>(arr_b1[v22] != arr_b2[v22]) &#123;</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;You\&#x27;re Wrong!\n&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                        v23 = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">Intent</span> <span class="variable">intent0</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(MainActivity.<span class="built_in">this</span>, MainActivity2.class);</span><br><span class="line">                intent0.putExtra(<span class="string">&quot;ad@#E!@a123&quot;</span>, s1);</span><br><span class="line">                intent0.putExtra(<span class="string">&quot;eCAS213@!@3&quot;</span>, arr_b1);</span><br><span class="line">                <span class="keyword">if</span>(v23 == <span class="number">1</span>) &#123;</span><br><span class="line">                    MainActivity.<span class="built_in">this</span>.startActivity(intent0);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">package</span> com.example.babyapk_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> b.f;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity2</span> <span class="keyword">extends</span> <span class="title class_">f</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span>  <span class="comment">// b.f</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle0)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(bundle0);</span><br><span class="line">        <span class="built_in">this</span>.setContentView(<span class="number">0x7F0B001D</span>);  <span class="comment">// layout:activity_main2</span></span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent0</span> <span class="operator">=</span> <span class="built_in">this</span>.getIntent();</span><br><span class="line">        <span class="type">byte</span>[] arr_b = intent0.getStringExtra(<span class="string">&quot;ad@#E!@a123&quot;</span>).getBytes();</span><br><span class="line">        <span class="type">byte</span>[] arr_b1 = intent0.getByteArrayExtra(<span class="string">&quot;eCAS213@!@3&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">v1</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> <span class="number">0</span>; v &lt; arr_b1.length; ++v) &#123;</span><br><span class="line">            arr_b1[v] = (<span class="type">byte</span>)(arr_b1[v] ^ arr_b[v % arr_b.length]);</span><br><span class="line">            <span class="keyword">if</span>(arr_b1[v] != <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;-<span class="number">107</span>, -<span class="number">106</span>, <span class="number">0xFFFFFFA1</span>, <span class="number">0xFFFFFF8D</span>, <span class="number">0xFFFFFF89</span>, <span class="number">0x7F</span>, <span class="number">26</span>, <span class="number">0x79</span>, -<span class="number">62</span>, -<span class="number">20</span>, <span class="number">86</span>, <span class="number">9</span>&#125;[v]) &#123;</span><br><span class="line">                Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;N0T Right,Maybe try more harder?\n&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                v1 = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(v1 == <span class="number">1</span>) &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;Congratulations!&quot;</span>, <span class="number">1</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当MainActivity1中的匹配通过后才会进行MainActivity2的另一部分加密 主要是分奇偶索引进行TEA或异或加密 据此写出解密脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> arr_even[<span class="number">12</span>] = &#123;<span class="number">-107</span>, <span class="number">-106</span>, <span class="number">0xFFFFFFA1</span>, <span class="number">0xFFFFFF8D</span>, <span class="number">0xFFFFFF89</span>, <span class="number">0x7F</span>, <span class="number">26</span>, <span class="number">0x79</span>, <span class="number">-62</span>, <span class="number">-20</span>, <span class="number">86</span>, <span class="number">9</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key_even[<span class="number">12</span>] = &#123;<span class="number">-91</span>, <span class="number">-8</span>, <span class="number">-110</span>, <span class="number">-55</span>, <span class="number">-49</span>, <span class="number">75</span>, <span class="number">0x73</span>, <span class="number">13</span>, <span class="number">-76</span>, <span class="number">0x8F</span>, <span class="number">102</span>, <span class="number">80</span>&#125;;</span><br><span class="line">    <span class="type">char</span> flag_even[<span class="number">12</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)&#123;</span><br><span class="line">        flag_even[i] = arr_even[i] ^ key_even[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> flag_odd_[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i += <span class="number">4</span>)&#123;</span><br><span class="line">        flag_odd_[(<span class="type">int</span>)(i / <span class="number">4</span>)] = key_even[i + <span class="number">3</span>] | key_even[i + <span class="number">2</span>] &lt;&lt; <span class="number">8</span> | key_even[i + <span class="number">1</span>] &lt;&lt; <span class="number">16</span> | key_even[i] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> TEA_key[<span class="number">4</span>] = &#123;<span class="number">2023708229</span>, <span class="number">-158607964</span>, <span class="number">0x81963FFA</span>, <span class="number">0x458FAC58</span>&#125;;</span><br><span class="line">    <span class="type">int</span> delta = <span class="number">-1640531527</span> * <span class="number">0x40</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x20</span>; i++)&#123;</span><br><span class="line">        flag_odd_[<span class="number">2</span>] -= (flag_odd_[<span class="number">1</span>] &lt;&lt; <span class="number">4</span>) + TEA_key[<span class="number">2</span>] ^ flag_odd_[<span class="number">1</span>] + delta ^ (flag_odd_[<span class="number">1</span>] &gt;&gt; <span class="number">5</span>) + TEA_key[<span class="number">3</span>];</span><br><span class="line">        flag_odd_[<span class="number">1</span>] -= (flag_odd_[<span class="number">2</span>] &lt;&lt; <span class="number">4</span>) + TEA_key[<span class="number">0</span>] ^ flag_odd_[<span class="number">2</span>] + delta ^ (flag_odd_[<span class="number">2</span>] &gt;&gt; <span class="number">5</span>) + TEA_key[<span class="number">1</span>];</span><br><span class="line">        delta += <span class="number">1640531527</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x20</span>; i++)&#123;</span><br><span class="line">        flag_odd_[<span class="number">2</span>] -= (flag_odd_[<span class="number">0</span>] &lt;&lt; <span class="number">4</span>) + TEA_key[<span class="number">2</span>] ^ flag_odd_[<span class="number">0</span>] + delta ^ (flag_odd_[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>) + TEA_key[<span class="number">3</span>];</span><br><span class="line">        flag_odd_[<span class="number">0</span>] -= (flag_odd_[<span class="number">2</span>] &lt;&lt; <span class="number">4</span>) + TEA_key[<span class="number">0</span>] ^ flag_odd_[<span class="number">2</span>] + delta ^ (flag_odd_[<span class="number">2</span>] &gt;&gt; <span class="number">5</span>) + TEA_key[<span class="number">1</span>];</span><br><span class="line">        delta += <span class="number">1640531527</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> flag_odd[<span class="number">12</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">3</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        flag_odd[<span class="number">3</span> - i] = (flag_odd_[<span class="number">0</span>] &gt;&gt; i * <span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">3</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        flag_odd[<span class="number">7</span> - i] = (flag_odd_[<span class="number">2</span>] &gt;&gt; i * <span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">3</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        flag_odd[<span class="number">11</span> - i] = (flag_odd_[<span class="number">1</span>] &gt;&gt; i * <span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;SYC&#123;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i % <span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,  flag_odd[(<span class="type">int</span>)(i / <span class="number">2</span>)]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, flag_even[(<span class="type">int</span>)(i / <span class="number">2</span>)]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">    <span class="comment">// SYC&#123;T00nV3tD3F34Tint0vict0rY&#125;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="是男人就来扎针-Unity引擎游戏逆向"><a href="#是男人就来扎针-Unity引擎游戏逆向" class="headerlink" title="是男人就来扎针 | Unity引擎游戏逆向"></a>是男人就来扎针 | Unity引擎游戏逆向</h3><p>Unity引擎游戏的控制逻辑一般存放在<code>.\*_Data\Managed\Assembly-CSharp.dll</code>中 用dnspy打开 主要逻辑如下</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.SceneManagement;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Token: 0x02000002 RID: 2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameManager</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Token: 0x06000002 RID: 2 RVA: 0x000020A9 File Offset: 0x000004A9</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">RemoveDash</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        str = str.Replace(<span class="string">&quot;-&quot;</span>, <span class="built_in">string</span>.Empty);</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x06000003 RID: 3 RVA: 0x000020C0 File Offset: 0x000004C0</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">what</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        MD5 md = MD5.Create();</span><br><span class="line">        <span class="built_in">byte</span>[] bytes = Encoding.Default.GetBytes(str);</span><br><span class="line">        <span class="built_in">byte</span>[] <span class="keyword">value</span> = md.ComputeHash(bytes);</span><br><span class="line">        <span class="keyword">return</span> GameManager.RemoveDash(BitConverter.ToString(<span class="keyword">value</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x06000004 RID: 4 RVA: 0x000020F4 File Offset: 0x000004F4</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Start</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.startPoint = GameObject.Find(<span class="string">&quot;StartPoint&quot;</span>).transform;</span><br><span class="line">        <span class="keyword">this</span>.spawnPoint = GameObject.Find(<span class="string">&quot;SpawnPoint&quot;</span>).transform;</span><br><span class="line">        <span class="keyword">this</span>.mainCamera = Camera.main;</span><br><span class="line">        <span class="keyword">this</span>.SpawnPin();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x06000005 RID: 5 RVA: 0x00002134 File Offset: 0x00000534</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.score == <span class="number">30</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> text = <span class="built_in">string</span>.Empty;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.magicc.Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">char</span> c = (<span class="built_in">char</span>)<span class="keyword">this</span>.magicc[i];</span><br><span class="line">                text += c;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.flagText.text = text;</span><br><span class="line">            <span class="keyword">this</span>.nothing += GameManager.what(<span class="keyword">this</span>.flagText.text);</span><br><span class="line">            <span class="keyword">this</span>.nothing += <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.score == <span class="number">40</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> text2 = <span class="built_in">string</span>.Empty;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; <span class="keyword">this</span>.magic.Length; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">char</span> c2 = (<span class="built_in">char</span>)<span class="keyword">this</span>.magic[j];</span><br><span class="line">                text2 += c2;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.flagText.text = text2;</span><br><span class="line">            text2 += <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.score == <span class="number">100</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.scoreText.text = <span class="string">&quot;!&quot;</span>;</span><br><span class="line">            <span class="keyword">this</span>.flagText.text = <span class="keyword">this</span>.nothing;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.isGameOver)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (Input.GetMouseButtonDown(<span class="number">0</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.score++;</span><br><span class="line">            <span class="keyword">this</span>.scoreText.text = <span class="keyword">this</span>.score.ToString();</span><br><span class="line">            <span class="keyword">this</span>.currentPin.StartFly();</span><br><span class="line">            <span class="keyword">this</span>.SpawnPin();</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> k = <span class="number">0</span>; k &lt; <span class="keyword">this</span>.magicc.Length; k++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.magicc[k] ^= <span class="keyword">this</span>.score;</span><br><span class="line">                <span class="keyword">this</span>.magic[k] ^= <span class="keyword">this</span>.score;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x06000006 RID: 6 RVA: 0x000022F6 File Offset: 0x000006F6</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SpawnPin</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.currentPin = UnityEngine.Object.Instantiate&lt;GameObject&gt;(<span class="keyword">this</span>.pinPrefab, <span class="keyword">this</span>.spawnPoint.position, <span class="keyword">this</span>.pinPrefab.transform.rotation).GetComponent&lt;Pin&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x06000007 RID: 7 RVA: 0x00002329 File Offset: 0x00000729</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GameOver</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.isGameOver)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        GameObject.Find(<span class="string">&quot;Circle&quot;</span>).GetComponent&lt;RotateSelf&gt;().enabled = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">base</span>.StartCoroutine(<span class="keyword">this</span>.GameOverAnimation());</span><br><span class="line">        <span class="keyword">this</span>.isGameOver = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x06000008 RID: 8 RVA: 0x00002360 File Offset: 0x00000760</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> IEnumerator <span class="title">GameOverAnimation</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (;;)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.mainCamera.backgroundColor = Color.Lerp(<span class="keyword">this</span>.mainCamera.backgroundColor, Color.red, <span class="keyword">this</span>.speed * Time.deltaTime);</span><br><span class="line">            <span class="keyword">this</span>.mainCamera.orthographicSize = Mathf.Lerp(<span class="keyword">this</span>.mainCamera.orthographicSize, <span class="number">4f</span>, <span class="keyword">this</span>.speed * Time.deltaTime);</span><br><span class="line">            <span class="keyword">if</span> (Mathf.Abs(<span class="keyword">this</span>.mainCamera.orthographicSize - <span class="number">4f</span>) &lt; <span class="number">0.01f</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">yield</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">WaitForSeconds</span>(<span class="params"><span class="number">0.2f</span></span>)</span>;</span><br><span class="line">        SceneManager.LoadScene(SceneManager.GetActiveScene().buildIndex);</span><br><span class="line">        <span class="keyword">yield</span> <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000001 RID: 1</span></span><br><span class="line">    <span class="keyword">private</span> Transform startPoint;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000002 RID: 2</span></span><br><span class="line">    <span class="keyword">private</span> Transform spawnPoint;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000003 RID: 3</span></span><br><span class="line">    <span class="keyword">private</span> Pin currentPin;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000004 RID: 4</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">bool</span> isGameOver;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000005 RID: 5</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> score;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000006 RID: 6</span></span><br><span class="line">    <span class="keyword">private</span> Camera mainCamera;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000007 RID: 7</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> nothing = <span class="built_in">string</span>.Empty;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000008 RID: 8</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span>[] magicc = <span class="keyword">new</span> <span class="built_in">int</span>[]</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">75</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">102</span>,</span><br><span class="line">        <span class="number">63</span>,</span><br><span class="line">        <span class="number">107</span>,</span><br><span class="line">        <span class="number">112</span>,</span><br><span class="line">        <span class="number">63</span>,</span><br><span class="line">        <span class="number">108</span>,</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">112</span>,</span><br><span class="line">        <span class="number">109</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">63</span>,</span><br><span class="line">        <span class="number">43</span>,</span><br><span class="line">        <span class="number">47</span>,</span><br><span class="line">        <span class="number">63</span>,</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">112</span>,</span><br><span class="line">        <span class="number">118</span>,</span><br><span class="line">        <span class="number">113</span>,</span><br><span class="line">        <span class="number">107</span>,</span><br><span class="line">        <span class="number">108</span>,</span><br><span class="line">        <span class="number">62</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000009 RID: 9</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span>[] magic = <span class="keyword">new</span> <span class="built_in">int</span>[]</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">90</span>,</span><br><span class="line">        <span class="number">81</span>,</span><br><span class="line">        <span class="number">8</span>,</span><br><span class="line">        <span class="number">92</span>,</span><br><span class="line">        <span class="number">71</span>,</span><br><span class="line">        <span class="number">8</span>,</span><br><span class="line">        <span class="number">90</span>,</span><br><span class="line">        <span class="number">77</span>,</span><br><span class="line">        <span class="number">73</span>,</span><br><span class="line">        <span class="number">75</span>,</span><br><span class="line">        <span class="number">64</span>,</span><br><span class="line">        <span class="number">8</span>,</span><br><span class="line">        <span class="number">25</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">8</span>,</span><br><span class="line">        <span class="number">88</span>,</span><br><span class="line">        <span class="number">71</span>,</span><br><span class="line">        <span class="number">65</span>,</span><br><span class="line">        <span class="number">70</span>,</span><br><span class="line">        <span class="number">92</span>,</span><br><span class="line">        <span class="number">91</span>,</span><br><span class="line">        <span class="number">9</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x0400000A RID: 10</span></span><br><span class="line">    <span class="keyword">public</span> Text scoreText;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x0400000B RID: 11</span></span><br><span class="line">    <span class="keyword">public</span> Text flagText;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x0400000C RID: 12</span></span><br><span class="line">    <span class="keyword">public</span> GameObject pinPrefab;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x0400000D RID: 13</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> speed = <span class="number">3f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到游戏前30次每刷新一次分数就会与明文进行异或 最后进行md5加密然后在分数达到100时显示 显然不可能点到100 <del>但是可以先点到30 再用CE改到100</del> 写出解密脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">key = [ 75, 109, 102, 63, 107, 112, 63, 108, 124, 112, 109, 122, 63, 43, 47, 63, 111, 112, 118, 113, 107, 108, 62]</span><br><span class="line">convt = hashlib.md5()</span><br><span class="line">for i in range(1, 31):</span><br><span class="line">    for j in range(len(key)):</span><br><span class="line">        key[j] ^= i</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for each in key:</span><br><span class="line">    flag += chr(each)</span><br><span class="line">convt.update(flag.encode())</span><br><span class="line">print(convt.hexdigest().upper())</span><br><span class="line"># CBDDD133B60130856D3C695D9E5ED6A5</span><br></pre></td></tr></table></figure>

<h3 id="babycode-不知道什么加密"><a href="#babycode-不知道什么加密" class="headerlink" title="babycode | 不知道什么加密"></a>babycode | 不知道什么加密</h3><p>IDA64打开 伪代码如下 其中两个简单加密算法不展示</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+4h] [rbp-13Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-138h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+Ch] [rbp-134h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+10h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> enc[<span class="number">4</span>]; <span class="comment">// [rsp+20h] [rbp-120h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10[<span class="number">33</span>]; <span class="comment">// [rsp+24h] [rbp-11Ch]</span></span><br><span class="line">  <span class="type">char</span> input[<span class="number">113</span>]; <span class="comment">// [rsp+B7h] [rbp-89h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+128h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v5 = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input your flag:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, &amp;input[<span class="number">9</span>]);</span><br><span class="line">  *enc = <span class="number">120</span>;</span><br><span class="line">  v10[<span class="number">0</span>] = <span class="number">91</span>;</span><br><span class="line">  v10[<span class="number">1</span>] = <span class="number">86</span>;</span><br><span class="line">  v10[<span class="number">2</span>] = <span class="number">122</span>;</span><br><span class="line">  v10[<span class="number">3</span>] = <span class="number">93</span>;</span><br><span class="line">  v10[<span class="number">4</span>] = <span class="number">84</span>;</span><br><span class="line">  v10[<span class="number">5</span>] = <span class="number">37</span>;</span><br><span class="line">  v10[<span class="number">6</span>] = <span class="number">49</span>;</span><br><span class="line">  v10[<span class="number">7</span>] = <span class="number">32</span>;</span><br><span class="line">  v10[<span class="number">8</span>] = <span class="number">104</span>;</span><br><span class="line">  v10[<span class="number">9</span>] = <span class="number">61</span>;</span><br><span class="line">  v10[<span class="number">10</span>] = <span class="number">100</span>;</span><br><span class="line">  v10[<span class="number">11</span>] = <span class="number">-110</span>;</span><br><span class="line">  v10[<span class="number">12</span>] = <span class="number">118</span>;</span><br><span class="line">  v10[<span class="number">13</span>] = <span class="number">99</span>;</span><br><span class="line">  v10[<span class="number">14</span>] = <span class="number">123</span>;</span><br><span class="line">  v10[<span class="number">15</span>] = <span class="number">89</span>;</span><br><span class="line">  v10[<span class="number">16</span>] = <span class="number">87</span>;</span><br><span class="line">  v10[<span class="number">17</span>] = <span class="number">33</span>;</span><br><span class="line">  v10[<span class="number">18</span>] = <span class="number">-124</span>;</span><br><span class="line">  v10[<span class="number">19</span>] = <span class="number">87</span>;</span><br><span class="line">  v10[<span class="number">20</span>] = <span class="number">118</span>;</span><br><span class="line">  v10[<span class="number">21</span>] = <span class="number">-121</span>;</span><br><span class="line">  v10[<span class="number">22</span>] = <span class="number">114</span>;</span><br><span class="line">  v10[<span class="number">23</span>] = <span class="number">-124</span>;</span><br><span class="line">  v10[<span class="number">24</span>] = <span class="number">-123</span>;</span><br><span class="line">  v10[<span class="number">25</span>] = <span class="number">112</span>;</span><br><span class="line">  v10[<span class="number">26</span>] = <span class="number">-98</span>;</span><br><span class="line">  v10[<span class="number">27</span>] = <span class="number">79</span>;</span><br><span class="line">  v10[<span class="number">28</span>] = <span class="number">112</span>;</span><br><span class="line">  v10[<span class="number">29</span>] = <span class="number">114</span>;</span><br><span class="line">  v10[<span class="number">30</span>] = <span class="number">-124</span>;</span><br><span class="line">  v10[<span class="number">31</span>] = <span class="number">87</span>;</span><br><span class="line">  v10[<span class="number">32</span>] = <span class="number">-120</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(input, <span class="string">&quot;fuwafuwa&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(&amp;input[<span class="number">9</span>]); ++i )</span><br><span class="line">    input[i + <span class="number">9</span>] = (<span class="number">16</span> * input[i + <span class="number">9</span>]) | (input[i + <span class="number">9</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>;<span class="comment">// 互换输入中的高/低四位</span></span><br><span class="line">  encode(&amp;input[<span class="number">9</span>]);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(&amp;input[<span class="number">9</span>]); ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    input[j + <span class="number">9</span>] += j;</span><br><span class="line">    input[j + <span class="number">9</span>] ^= input[j % <span class="number">8</span>] % <span class="number">32</span> + <span class="number">1</span>;</span><br><span class="line">    ceasar(input, j);                           <span class="comment">// 向后移j位的凯撒加密</span></span><br><span class="line">    v3 = <span class="built_in">strlen</span>(input);</span><br><span class="line">    reverse(input, v3);                         <span class="comment">// 对称对换key(0-&gt;8, 1-&gt;7...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="built_in">strlen</span>(enc); ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( input[k + <span class="number">9</span>] != *&amp;enc[<span class="number">4</span> * k] )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = <span class="number">0</span>;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;no way!&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">1</span> )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;your input is flag!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> *__fastcall <span class="title function_">encode</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *input)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int8 v2; <span class="comment">// [rsp+17h] [rbp-49h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-48h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+1Ch] [rbp-44h]</span></span><br><span class="line">  <span class="type">char</span> *ptr_input; <span class="comment">// [rsp+20h] [rbp-40h]</span></span><br><span class="line">  <span class="type">char</span> *key2; <span class="comment">// [rsp+28h] [rbp-38h]</span></span><br><span class="line">  <span class="type">char</span> *ptr_input_; <span class="comment">// [rsp+30h] [rbp-30h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 j; <span class="comment">// [rsp+38h] [rbp-28h]</span></span><br><span class="line">  <span class="type">size_t</span> len_of_input; <span class="comment">// [rsp+40h] [rbp-20h]</span></span><br><span class="line">  __int64 max_key; <span class="comment">// [rsp+48h] [rbp-18h]</span></span><br><span class="line">  <span class="type">char</span> *v11; <span class="comment">// [rsp+50h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 last; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  len_of_input = <span class="built_in">strlen</span>(input);</span><br><span class="line">  max_key = <span class="number">3</span> * ((len_of_input &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>);</span><br><span class="line">  v11 = <span class="built_in">malloc</span>(max_key + len_of_input);</span><br><span class="line">  key2 = &amp;v11[max_key];                         <span class="comment">// 输入的首地址</span></span><br><span class="line">  last = &amp;v11[max_key - <span class="number">1</span> + len_of_input];      <span class="comment">// v11的最后一个元素</span></span><br><span class="line">  ptr_input = &amp;v11[max_key];</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;v11[max_key], input, len_of_input);   <span class="comment">// 最后的一段元素和输入相同</span></span><br><span class="line">  <span class="keyword">while</span> ( ptr_input &lt;= last )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *ptr_input )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> ( ptr_input_ = ptr_input; ptr_input_ &lt;= last; ++ptr_input_ )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = v2 &lt;&lt; <span class="number">8</span>;</span><br><span class="line">        v2 = *ptr_input_ &amp; <span class="number">0x3F</span>;</span><br><span class="line">        *ptr_input_ = (*ptr_input_ + v4) &gt;&gt; <span class="number">6</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      *--key2 = off_55B72E249018[v2];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ++ptr_input;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">19</span>; ++i )</span><br><span class="line">    key += rand() % <span class="number">100</span>;</span><br><span class="line">  key = key % <span class="number">0x20</span> + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0LL</span>; j &lt; &amp;v11[max_key] - key2; ++j )</span><br><span class="line">    input[j] = key ^ key2[j];</span><br><span class="line">  input[j] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v11;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>核心加密是一个base64的换表 要注意的是其中的key动态调试出来并不正确 因为程序会检测动态调试改变key的初值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">.init_array:000055B72E248D80                               _init_array segment qword public &#x27;DATA&#x27; use64</span><br><span class="line">.init_array:000055B72E248D80                               assume cs:_init_array</span><br><span class="line">.init_array:000055B72E248D80                               ;org 55B72E248D80h</span><br><span class="line">.init_array:000055B72E248D80 00 62 24 2E B7 55 00 00       dq offset sub_55B72E246200</span><br><span class="line">.init_array:000055B72E248D88 09 62 24 2E B7 55 00 00       dq offset sub_55B72E246209</span><br><span class="line">.init_array:000055B72E248D88                               _init_array ends</span><br><span class="line">...</span><br><span class="line">.text:000055B72E246209                               sub_55B72E246209 proc near              ; DATA XREF: .init_array:000055B72E248D88↓o</span><br><span class="line">.text:000055B72E246209</span><br><span class="line">.text:000055B72E246209                               var_4= dword ptr -4</span><br><span class="line">.text:000055B72E246209</span><br><span class="line">.text:000055B72E246209                               ; __unwind &#123;</span><br><span class="line">.text:000055B72E246209 F3 0F 1E FA                   endbr64</span><br><span class="line">.text:000055B72E24620D 55                            push    rbp</span><br><span class="line">.text:000055B72E24620E 48 89 E5                      mov     rbp, rsp</span><br><span class="line">.text:000055B72E246211 C7 45 FC 00 00 00 00          mov     [rbp+var_4], 0</span><br><span class="line">.text:000055B72E246218 BB 00 00 00 00                mov     ebx, 0                          ; ptrace_request</span><br><span class="line">.text:000055B72E24621D B9 00 00 00 00                mov     ecx, 0                          ; pid</span><br><span class="line">.text:000055B72E246222 BA 00 00 00 00                mov     edx, 0                          ; addr</span><br><span class="line">.text:000055B72E246227 B8 1A 00 00 00                mov     eax, 1Ah</span><br><span class="line">.text:000055B72E24622C CD 80                         int     80h                             ; LINUX - sys_ptrace</span><br><span class="line">.text:000055B72E24622C</span><br><span class="line">.text:000055B72E24622E 89 45 FC                      mov     [rbp+var_4], eax</span><br><span class="line">.text:000055B72E246231 8B 45 FC                      mov     eax, [rbp+var_4]</span><br><span class="line">.text:000055B72E246234 48 98                         cdqe</span><br><span class="line">.text:000055B72E246236 48 83 F8 FF                   cmp     rax, 0FFFFFFFFFFFFFFFFh</span><br><span class="line">.text:000055B72E24623A 75 0A                         jnz     short loc_55B72E246246</span><br><span class="line">.text:000055B72E24623A</span><br><span class="line">.text:000055B72E24623C C7 05 CA 2D 00 00 08 00 00 00 mov     cs:key, 8</span><br><span class="line">.text:000055B72E24623C</span><br><span class="line">.text:000055B72E246246</span><br><span class="line">.text:000055B72E246246                               loc_55B72E246246:                       ; CODE XREF: sub_55B72E246209+31↑j</span><br><span class="line">.text:000055B72E246246 90                            nop</span><br><span class="line">.text:000055B72E246247 5D                            pop     rbp</span><br><span class="line">.text:000055B72E246248 C3                            retn</span><br><span class="line">.text:000055B72E246248                               ; &#125; // starts at 55B72E246209</span><br><span class="line">.text:000055B72E246248</span><br><span class="line">.text:000055B72E246248                               sub_55B72E246209 endp</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>所以用key在<code>(1, 31)</code>且加密后密文都在表中爆破出key为21 据此写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">![image-<span class="number">20231128164528686</span>](C:\Users\Orink\AppData\Roaming\Typora\typora-user-images\image-<span class="number">20231128164528686.</span>png)<span class="keyword">def</span> <span class="title function_">emulator</span>(<span class="params">key:<span class="built_in">list</span>, time:<span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        key[i] = <span class="number">97</span> + (key[i] - <span class="number">97</span> + time) % <span class="number">26</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">antiemulator</span>(<span class="params">key:<span class="built_in">list</span>, time:<span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        key[i] = <span class="number">97</span> + (key[i] - <span class="number">97</span> - time) % <span class="number">26</span></span><br><span class="line"></span><br><span class="line">table = [<span class="built_in">ord</span>(val) <span class="keyword">for</span> val <span class="keyword">in</span> <span class="string">&#x27;i5jLW7S0GX6uf1cv3ny4q8es2Q+bdkYgKOIT/tAxUrFlVPzhmow9BHCMDpEaJRZN&#x27;</span>]</span><br><span class="line">enc = [val &amp; <span class="number">0xFF</span> <span class="keyword">for</span> val <span class="keyword">in</span> [<span class="number">120</span>, <span class="number">91</span>, <span class="number">86</span>, <span class="number">122</span>, <span class="number">93</span>, <span class="number">84</span>, <span class="number">37</span>, <span class="number">49</span>, <span class="number">32</span>, <span class="number">104</span>, <span class="number">61</span>, <span class="number">100</span>, -<span class="number">110</span>, <span class="number">118</span>, <span class="number">99</span>, <span class="number">123</span>, <span class="number">89</span>, <span class="number">87</span>, <span class="number">33</span>, -<span class="number">124</span>, <span class="number">87</span>, <span class="number">118</span>, -<span class="number">121</span>, <span class="number">114</span>, -<span class="number">124</span>, -<span class="number">123</span>, <span class="number">112</span>, -<span class="number">98</span>, <span class="number">79</span>, <span class="number">112</span>, <span class="number">114</span>, -<span class="number">124</span>, <span class="number">87</span>, -<span class="number">120</span>]]</span><br><span class="line">key_0 = <span class="string">&#x27;fuwafuwa&#x27;</span></span><br><span class="line">key = [<span class="built_in">ord</span>(val) <span class="keyword">for</span> val <span class="keyword">in</span> key_0]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">34</span>):</span><br><span class="line">    emulator(key, i)</span><br><span class="line">    key = key[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    key = key[::-<span class="number">1</span>]</span><br><span class="line">    antiemulator(key, i)</span><br><span class="line">    enc[i] ^= key[i % <span class="number">8</span>] % <span class="number">32</span> + <span class="number">1</span></span><br><span class="line">    enc[i] -= i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">34</span>):</span><br><span class="line">    enc[i] ^= <span class="number">21</span></span><br><span class="line">enc = [table.index(val) <span class="keyword">for</span> val <span class="keyword">in</span> enc]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> enc:</span><br><span class="line">    flag += <span class="string">&quot;&#123;:06b&#125;&quot;</span>.<span class="built_in">format</span>(each)</span><br><span class="line">flag = flag[<span class="number">4</span>:]</span><br><span class="line">flag = [flag[<span class="number">8</span> * i:<span class="number">8</span> * i + <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> ra![image-<span class="number">20231128164528686</span>](C:\Users\Orink\AppData\Roaming\Typora\typora-user-images\image-<span class="number">20231128164528686.</span>png)nge(<span class="built_in">len</span>(enc))]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;SYC&#123;&quot;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(each[<span class="number">4</span>:<span class="number">8</span>] + each[<span class="number">0</span>:<span class="number">4</span>], <span class="number">2</span>)), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#125;&quot;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># SYC&#123;HbwKqCOAOVXdHAbG0HeinZkez&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="yakvm-虚拟机逆向"><a href="#yakvm-虚拟机逆向" class="headerlink" title="yakvm | 虚拟机逆向"></a>yakvm | 虚拟机逆向</h3><p>main为生成的虚拟机 IDA打开发现是无符号go 用go paraser恢复符号 搜索有关操作码的函数</p>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-13.png" alt="image-20231128164544215" style="zoom:67%;" />

<p>发现有一个ShowOpcodes函数 但 调试时不进过该函数 交叉引用找到调用它的函数</p>
<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-011426-14.png" alt="image-20231128164844486" style="zoom:67%;" />

<p>在判断处下断点 调试时通过改ZF寄存器步进ShowOpcodes函数 得到可读操作码 根据官方文档分析如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line">2:6-&gt;2:9         0:OP:type                 byte</span><br><span class="line">2:4-&gt;2:119       1:OP:type                 slice</span><br><span class="line">2:11-&gt;2:13       2:OP:push                 137</span><br><span class="line">2:15-&gt;2:17       3:OP:push                 108</span><br><span class="line">2:19-&gt;2:21       4:OP:push                 159</span><br><span class="line">2:23-&gt;2:25       5:OP:push                 114</span><br><span class="line">2:27-&gt;2:29       6:OP:push                 185</span><br><span class="line">2:31-&gt;2:32       7:OP:push                 90</span><br><span class="line">2:34-&gt;2:36       8:OP:push                 174</span><br><span class="line">2:38-&gt;2:39       9:OP:push                 68</span><br><span class="line">2:41-&gt;2:43      10:OP:push                 160</span><br><span class="line">2:45-&gt;2:46      11:OP:push                 81</span><br><span class="line">2:48-&gt;2:50      12:OP:push                 179</span><br><span class="line">2:52-&gt;2:53      13:OP:push                 41</span><br><span class="line">2:55-&gt;2:57      14:OP:push                 186</span><br><span class="line">2:59-&gt;2:60      15:OP:push                 89</span><br><span class="line">2:62-&gt;2:64      16:OP:push                 168</span><br><span class="line">2:66-&gt;2:67      17:OP:push                 78</span><br><span class="line">2:69-&gt;2:71      18:OP:push                 229</span><br><span class="line">2:73-&gt;2:75      19:OP:push                 121</span><br><span class="line">2:77-&gt;2:79      20:OP:push                 149</span><br><span class="line">2:81-&gt;2:83      21:OP:push                 106</span><br><span class="line">2:85-&gt;2:87      22:OP:push                 147</span><br><span class="line">2:89-&gt;2:91      23:OP:push                 103</span><br><span class="line">2:93-&gt;2:95      24:OP:push                 156</span><br><span class="line">2:97-&gt;2:99      25:OP:push                 114</span><br><span class="line">2:101-&gt;2:103    26:OP:push                 133</span><br><span class="line">2:105-&gt;2:106    27:OP:push                 98</span><br><span class="line">2:108-&gt;2:110    28:OP:push                 146</span><br><span class="line">2:112-&gt;2:114    29:OP:push                 116</span><br><span class="line">2:116-&gt;2:118    30:OP:push                 181</span><br><span class="line">2:4-&gt;2:119      31:OP:typedslice           29</span><br><span class="line">2:4-&gt;2:119      32:OP:list                 1</span><br><span class="line">2:0-&gt;2:0        33:OP:pushleftr            1            arg_1 = key_list[29]</span><br><span class="line">2:0-&gt;2:0        34:OP:list                 1</span><br><span class="line">2:0-&gt;2:119      35:OP:assign               </span><br><span class="line">3:0-&gt;3:4        36:OP:pushid               print</span><br><span class="line">3:6-&gt;3:25       37:OP:push                 please input flag:</span><br><span class="line">3:5-&gt;3:26       38:OP:call                 vlen:1</span><br><span class="line">3:0-&gt;3:26       39:OP:pop                  </span><br><span class="line">4:4-&gt;4:6        40:OP:pushid               get</span><br><span class="line">4:7-&gt;4:8        41:OP:call                 vlen:0</span><br><span class="line">4:4-&gt;4:8        42:OP:list                 1</span><br><span class="line">4:0-&gt;4:0        43:OP:pushleftr            2</span><br><span class="line">4:0-&gt;4:0        44:OP:list                 1            arg_2 = input[29]</span><br><span class="line">4:0-&gt;4:8        45:OP:assign               </span><br><span class="line">5:18-&gt;8:0       46:OP:new-scope            2            &#123;</span><br><span class="line">5:3-&gt;5:5        47:OP:pushid               len</span><br><span class="line">5:7-&gt;5:7        48:OP:pushr                2</span><br><span class="line">5:6-&gt;5:8        49:OP:call                 vlen:1            len(arg_2)</span><br><span class="line">5:12-&gt;5:14      50:OP:pushid               len</span><br><span class="line">5:16-&gt;5:16      51:OP:pushr                1                len(arg_1)</span><br><span class="line">5:15-&gt;5:17      52:OP:call                 vlen:1</span><br><span class="line">5:3-&gt;5:17       53:OP:gt                                       len(arg_1) &gt; len(arg_2) -&gt; goto globle63</span><br><span class="line">5:18-&gt;8:0       54:OP:jmpf                 -&gt; 63</span><br><span class="line">5:18-&gt;8:0       55:OP:new-scope            3                &#123;</span><br><span class="line">6:1-&gt;6:7        56:OP:pushid               println</span><br><span class="line">6:9-&gt;6:32       57:OP:push                 input string too long!    printf(too long!)</span><br><span class="line">6:8-&gt;6:33       58:OP:call                 vlen:1</span><br><span class="line">6:1-&gt;6:33       59:OP:pop                  </span><br><span class="line">7:1-&gt;7:6        60:OP:return               </span><br><span class="line">5:18-&gt;8:0       61:OP:end-scope                                &#125;</span><br><span class="line">5:18-&gt;8:0       62:OP:jmp                  -&gt; 63            globle63:</span><br><span class="line">5:18-&gt;8:0       63:OP:end-scope                            &#125;</span><br><span class="line">12:8-&gt;21:0      64:OP:push                 function params[1] codes[54] (copy)</span><br><span class="line">12:8-&gt;21:0      65:OP:list                 1</span><br><span class="line">12:0-&gt;12:4      66:OP:pushleftr            8            arg_8 = func1</span><br><span class="line">12:0-&gt;12:4      67:OP:list                 1</span><br><span class="line">12:0-&gt;21:0      68:OP:assign               </span><br><span class="line">25:4-&gt;25:8      69:OP:pushr                8</span><br><span class="line">25:10-&gt;25:10    70:OP:pushr                2</span><br><span class="line">25:9-&gt;25:11     71:OP:call                 vlen:1        arg2 = func1(arg_2)</span><br><span class="line">25:4-&gt;25:11     72:OP:list                 1</span><br><span class="line">25:0-&gt;25:0      73:OP:pushleftr            2</span><br><span class="line">25:0-&gt;25:0      74:OP:list                 1</span><br><span class="line">25:0-&gt;25:11     75:OP:assign               </span><br><span class="line">28:9-&gt;33:0      76:OP:push                 function params[0] codes[40] (copy)</span><br><span class="line">28:9-&gt;33:0      77:OP:list                 1</span><br><span class="line">28:0-&gt;28:4      78:OP:pushleftr            14</span><br><span class="line">28:0-&gt;28:4      79:OP:list                 1</span><br><span class="line">28:0-&gt;33:0      80:OP:assign               </span><br><span class="line">36:0-&gt;36:4      81:OP:pushr                14</span><br><span class="line">36:5-&gt;36:6      82:OP:call                 vlen:0       func2()</span><br><span class="line">36:0-&gt;36:6      83:OP:pop                  </span><br><span class="line">38:11-&gt;48:0     84:OP:push                 function params[0] codes[52] (copy)</span><br><span class="line">38:11-&gt;48:0     85:OP:list                 1</span><br><span class="line">38:0-&gt;38:7      86:OP:pushleftr            19</span><br><span class="line">38:0-&gt;38:7      87:OP:list                 1</span><br><span class="line">38:0-&gt;48:0      88:OP:assign               </span><br><span class="line">51:14-&gt;53:0     89:OP:new-scope            24</span><br><span class="line">51:3-&gt;51:10     90:OP:pushr                19</span><br><span class="line">51:11-&gt;51:12    91:OP:call                 vlen:0</span><br><span class="line">51:14-&gt;53:0     92:OP:jmpf                 -&gt; 100</span><br><span class="line">51:14-&gt;53:0     93:OP:new-scope            25</span><br><span class="line">52:1-&gt;52:5      94:OP:pushid               print</span><br><span class="line">52:7-&gt;52:24     95:OP:push                 yes! you get it!</span><br><span class="line">52:6-&gt;52:25     96:OP:call                 vlen:1</span><br><span class="line">52:1-&gt;52:25     97:OP:pop                  </span><br><span class="line">51:14-&gt;53:0     98:OP:end-scope            </span><br><span class="line">51:14-&gt;53:0     99:OP:jmp                  -&gt; 108</span><br><span class="line">51:14-&gt;53:0    100:OP:end-scope            </span><br><span class="line">51:14-&gt;53:0    101:OP:new-scope            26</span><br><span class="line">53:6-&gt;55:0     102:OP:new-scope            27</span><br><span class="line">54:1-&gt;54:5     103:OP:pushid               print</span><br><span class="line">54:7-&gt;54:24    104:OP:push                 no this not flag</span><br><span class="line">54:6-&gt;54:25    105:OP:call                 vlen:1</span><br><span class="line">54:1-&gt;54:25    106:OP:pop                  </span><br><span class="line">53:6-&gt;55:0     107:OP:end-scope            </span><br><span class="line">51:14-&gt;53:0    108:OP:end-scope            </span><br><span class="line"></span><br><span class="line">//func1 start</span><br><span class="line">anonymous</span><br><span class="line">13:1-&gt;19:1       1:OP:new-scope            6    &#123;</span><br><span class="line">13:1-&gt;19:1       2:OP:pushleftr            5        arg_5 = arg_3 = arg_2</span><br><span class="line">13:18-&gt;13:18     3:OP:pushr                3</span><br><span class="line">13:1-&gt;19:1       4:OP:fast-assign          </span><br><span class="line">13:1-&gt;19:1       5:OP:enter-for-range      -&gt; 47    for i in range(47)</span><br><span class="line">13:1-&gt;19:1       6:OP:range-next           </span><br><span class="line">13:5-&gt;13:5       7:OP:pushleftr            6</span><br><span class="line">13:8-&gt;13:8       8:OP:pushleftr            7</span><br><span class="line">13:5-&gt;13:8       9:OP:list                 2</span><br><span class="line">13:1-&gt;19:1      10:OP:assign               </span><br><span class="line">13:20-&gt;19:1     11:OP:new-scope            7        &#123;</span><br><span class="line">14:16-&gt;16:2     12:OP:new-scope            8            &#123;</span><br><span class="line">14:5-&gt;14:5      13:OP:pushr                6</span><br><span class="line">14:9-&gt;14:9      14:OP:push                 2</span><br><span class="line">14:5-&gt;14:9      15:OP:mod                  </span><br><span class="line">14:14-&gt;14:14    16:OP:push                 0</span><br><span class="line">14:5-&gt;14:14     17:OP:eq                                    arg_6 % 2 == 0 goto global31</span><br><span class="line">14:16-&gt;16:2     18:OP:jmpf                 -&gt; 31</span><br><span class="line">14:16-&gt;16:2     19:OP:new-scope            9            else&#123;</span><br><span class="line">15:10-&gt;15:10    20:OP:pushr                7</span><br><span class="line">15:14-&gt;15:17    21:OP:push                 240</span><br><span class="line">15:10-&gt;15:17    22:OP:xor                  </span><br><span class="line">15:10-&gt;15:17    23:OP:list                 1</span><br><span class="line">15:3-&gt;15:3      24:OP:pushr                3</span><br><span class="line">15:5-&gt;15:5      25:OP:pushr                6                arg_3[arg_6] = arg_7 ^ 240</span><br><span class="line">15:3-&gt;15:6      26:OP:list                 2</span><br><span class="line">15:3-&gt;15:6      27:OP:list                 1</span><br><span class="line">15:3-&gt;15:17     28:OP:assign               </span><br><span class="line">14:16-&gt;16:2     29:OP:end-scope                                &#125;</span><br><span class="line">14:16-&gt;16:2     30:OP:jmp                  -&gt; 44</span><br><span class="line">14:16-&gt;16:2     31:OP:end-scope           global31:        &#125;</span><br><span class="line">14:16-&gt;16:2     32:OP:new-scope            10            &#123;</span><br><span class="line">16:9-&gt;18:2      33:OP:new-scope            11                &#123;</span><br><span class="line">17:10-&gt;17:10    34:OP:pushr                7                    arg_7 ^ 15</span><br><span class="line">17:14-&gt;17:17    35:OP:push                 15</span><br><span class="line">17:10-&gt;17:17    36:OP:xor                  </span><br><span class="line">17:10-&gt;17:17    37:OP:list                 1</span><br><span class="line">17:3-&gt;17:3      38:OP:pushr                3</span><br><span class="line">17:5-&gt;17:5      39:OP:pushr                6                    arg_3[arg_6] = arg_7 ^ 15</span><br><span class="line">17:3-&gt;17:6      40:OP:list                 2</span><br><span class="line">17:3-&gt;17:6      41:OP:list                 1</span><br><span class="line">17:3-&gt;17:17     42:OP:assign               </span><br><span class="line">16:9-&gt;18:2      43:OP:end-scope                                &#125;</span><br><span class="line">14:16-&gt;16:2     44:OP:end-scope                            &#125;</span><br><span class="line">13:20-&gt;19:1     45:OP:end-scope                        &#125;</span><br><span class="line">13:1-&gt;19:1      46:OP:exit-for-range       -&gt; 6</span><br><span class="line">13:1-&gt;19:1      47:OP:pop                  </span><br><span class="line">13:1-&gt;19:1      48:OP:end-scope                    &#125;</span><br><span class="line">20:8-&gt;20:8      49:OP:pushr                3</span><br><span class="line">20:8-&gt;20:8      50:OP:list                 1</span><br><span class="line">20:1-&gt;20:8      51:OP:return                           </span><br><span class="line">//func1 end</span><br><span class="line"></span><br><span class="line">//func2 start</span><br><span class="line">anonymous</span><br><span class="line">28:15-&gt;33:0      0:OP:new-scope            13</span><br><span class="line">29:1-&gt;32:1       1:OP:new-scope            14</span><br><span class="line">29:1-&gt;32:1       2:OP:pushleftr            10</span><br><span class="line">29:18-&gt;29:18     3:OP:pushr                2            arg_10 = arg_2</span><br><span class="line">29:1-&gt;32:1       4:OP:fast-assign          </span><br><span class="line">29:1-&gt;32:1       5:OP:enter-for-range      -&gt; 36</span><br><span class="line">29:1-&gt;32:1       6:OP:range-next           </span><br><span class="line">29:5-&gt;29:5       7:OP:pushleftr            11           arg_12 = arg_11 ?</span><br><span class="line">29:8-&gt;29:8       8:OP:pushleftr            12</span><br><span class="line">29:5-&gt;29:8       9:OP:list                 2</span><br><span class="line">29:1-&gt;32:1      10:OP:assign               </span><br><span class="line">29:20-&gt;32:1     11:OP:new-scope            15   &#123;</span><br><span class="line">30:6-&gt;30:6      12:OP:pushr                11       arg_13 = arg_11 * 2</span><br><span class="line">30:10-&gt;30:10    13:OP:push                 2</span><br><span class="line">30:6-&gt;30:10     14:OP:mul                  </span><br><span class="line">30:6-&gt;30:10     15:OP:list                 1</span><br><span class="line">30:2-&gt;30:2      16:OP:pushleftr            13</span><br><span class="line">30:2-&gt;30:2      17:OP:list                 1</span><br><span class="line">30:2-&gt;30:10     18:OP:assign               </span><br><span class="line">31:11-&gt;31:11    19:OP:pushr                12           //用与或非实现异或</span><br><span class="line">31:10-&gt;31:11    20:OP:not                            arg_12 ^ arg_13 -&gt; (~v12 | v13) and (v12 | ~v13)</span><br><span class="line">31:15-&gt;31:15    21:OP:pushr                13</span><br><span class="line">31:10-&gt;31:15    22:OP:and                  </span><br><span class="line">31:21-&gt;31:21    23:OP:pushr                12</span><br><span class="line">31:26-&gt;31:26    24:OP:pushr                13</span><br><span class="line">31:25-&gt;31:26    25:OP:not                  </span><br><span class="line">31:21-&gt;31:26    26:OP:and                  </span><br><span class="line">31:9-&gt;31:27     27:OP:or                   </span><br><span class="line">31:9-&gt;31:27     28:OP:list                 1</span><br><span class="line">31:2-&gt;31:2      29:OP:pushr                2</span><br><span class="line">31:4-&gt;31:4      30:OP:pushr                11</span><br><span class="line">31:2-&gt;31:5      31:OP:list                 2</span><br><span class="line">31:2-&gt;31:5      32:OP:list                 1</span><br><span class="line">31:2-&gt;31:27     33:OP:assign               </span><br><span class="line">29:20-&gt;32:1     34:OP:end-scope                 &#125;</span><br><span class="line">29:1-&gt;32:1      35:OP:exit-for-range       -&gt; 6</span><br><span class="line">29:1-&gt;32:1      36:OP:pop                  </span><br><span class="line">29:1-&gt;32:1      37:OP:end-scope            </span><br><span class="line">28:15-&gt;33:0     38:OP:end-scope            </span><br><span class="line">28:9-&gt;33:0      39:OP:return               </span><br><span class="line">//func2 end</span><br><span class="line"></span><br><span class="line">//func3 start   判断函数</span><br><span class="line">anonymous</span><br><span class="line">38:17-&gt;48:0      0:OP:new-scope            17</span><br><span class="line">39:21-&gt;41:1      1:OP:new-scope            18</span><br><span class="line">39:4-&gt;39:6       2:OP:pushid               len</span><br><span class="line">39:8-&gt;39:8       3:OP:pushr                2</span><br><span class="line">39:7-&gt;39:9       4:OP:call                 vlen:1</span><br><span class="line">39:14-&gt;39:16     5:OP:pushid               len</span><br><span class="line">39:18-&gt;39:18     6:OP:pushr                1</span><br><span class="line">39:17-&gt;39:19     7:OP:call                 vlen:1</span><br><span class="line">39:4-&gt;39:19      8:OP:neq                  </span><br><span class="line">39:21-&gt;41:1      9:OP:jmpf                 -&gt; 16</span><br><span class="line">39:21-&gt;41:1     10:OP:new-scope            19</span><br><span class="line">40:9-&gt;40:13     11:OP:push                 false</span><br><span class="line">40:9-&gt;40:13     12:OP:list                 1</span><br><span class="line">40:2-&gt;40:13     13:OP:return               </span><br><span class="line">39:21-&gt;41:1     14:OP:end-scope            </span><br><span class="line">39:21-&gt;41:1     15:OP:jmp                  -&gt; 16</span><br><span class="line">39:21-&gt;41:1     16:OP:end-scope            </span><br><span class="line">42:1-&gt;46:1      17:OP:new-scope            20</span><br><span class="line">42:1-&gt;46:1      18:OP:pushleftr            16</span><br><span class="line">42:18-&gt;42:18    19:OP:pushr                2</span><br><span class="line">42:1-&gt;46:1      20:OP:fast-assign          </span><br><span class="line">42:1-&gt;46:1      21:OP:enter-for-range      -&gt; 45</span><br><span class="line">42:1-&gt;46:1      22:OP:range-next           </span><br><span class="line">42:5-&gt;42:5      23:OP:pushleftr            17</span><br><span class="line">42:8-&gt;42:8      24:OP:pushleftr            18</span><br><span class="line">42:5-&gt;42:8      25:OP:list                 2</span><br><span class="line">42:1-&gt;46:1      26:OP:assign               </span><br><span class="line">42:20-&gt;46:1     27:OP:new-scope            21</span><br><span class="line">43:14-&gt;45:2     28:OP:new-scope            22</span><br><span class="line">43:5-&gt;43:5      29:OP:pushr                18</span><br><span class="line">43:10-&gt;43:10    30:OP:pushr                1</span><br><span class="line">43:12-&gt;43:12    31:OP:pushr                17</span><br><span class="line">43:11-&gt;43:13    32:OP:push                 false</span><br><span class="line">43:11-&gt;43:13    33:OP:iterablecall         off:1 op1: -         op2: -</span><br><span class="line">43:5-&gt;43:13     34:OP:neq                  </span><br><span class="line">43:14-&gt;45:2     35:OP:jmpf                 -&gt; 42</span><br><span class="line">43:14-&gt;45:2     36:OP:new-scope            23</span><br><span class="line">44:10-&gt;44:14    37:OP:push                 false</span><br><span class="line">44:10-&gt;44:14    38:OP:list                 1</span><br><span class="line">44:3-&gt;44:14     39:OP:return               </span><br><span class="line">43:14-&gt;45:2     40:OP:end-scope            </span><br><span class="line">43:14-&gt;45:2     41:OP:jmp                  -&gt; 42</span><br><span class="line">43:14-&gt;45:2     42:OP:end-scope            </span><br><span class="line">42:20-&gt;46:1     43:OP:end-scope            </span><br><span class="line">42:1-&gt;46:1      44:OP:exit-for-range       -&gt; 22</span><br><span class="line">42:1-&gt;46:1      45:OP:pop                  </span><br><span class="line">42:1-&gt;46:1      46:OP:end-scope            </span><br><span class="line">47:8-&gt;47:11     47:OP:push                 true</span><br><span class="line">47:8-&gt;47:11     48:OP:list                 1</span><br><span class="line">47:1-&gt;47:11     49:OP:return               </span><br><span class="line">38:17-&gt;48:0     50:OP:end-scope            </span><br><span class="line">38:11-&gt;48:0     51:OP:return               </span><br><span class="line">//func3 end</span><br></pre></td></tr></table></figure>

<p>据此写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">137</span>, <span class="number">108</span>, <span class="number">159</span>, <span class="number">114</span>, <span class="number">185</span>, <span class="number">90</span>, <span class="number">174</span>, <span class="number">68</span>, <span class="number">160</span>, <span class="number">81</span>, <span class="number">179</span>, <span class="number">41</span>, <span class="number">186</span>, <span class="number">89</span>, <span class="number">168</span>, <span class="number">78</span>, <span class="number">229</span>, <span class="number">121</span>, <span class="number">149</span>, <span class="number">106</span>, <span class="number">147</span>, <span class="number">103</span>, <span class="number">156</span>, <span class="number">114</span>, <span class="number">133</span>, <span class="number">98</span>, <span class="number">146</span>, <span class="number">116</span>, <span class="number">181</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">29</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        key[i] ^= <span class="number">2</span> * i</span><br><span class="line">        key[i] ^= <span class="number">240</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        key[i] ^= <span class="number">2</span> * i</span><br><span class="line">        key[i] ^= <span class="number">15</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> key:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(each), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># yak&#123;A_RE@LW0RLD_5TACKB@SE_VM&#125;</span></span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E9%80%86%E5%90%91/" rel="tag"># 逆向</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item"></div>
      <div class="post-nav-item">
    <a href="/2024/02/23/NBCTF2024%E9%80%86%E5%90%91%E6%96%B9%E5%90%91wp/" rel="next" title="NBCTF2024逆向方向wp">
      NBCTF2024逆向方向wp <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Shift-jmp-%E7%AE%80%E5%8D%95%E8%8A%B1%E6%8C%87%E4%BB%A4"><span class="nav-number">1.</span> <span class="nav-text">Shift_jmp | 简单花指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%E7%9A%84%E9%80%86%E5%90%91%E9%A2%98-C%E6%BA%90%E7%A0%81%E7%9A%84%E7%BC%96%E8%AF%91"><span class="nav-number">2.</span> <span class="nav-text">点击就送的逆向题 | C源码的编译</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Easymath-z3-solver%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="nav-number">3.</span> <span class="nav-text">Easymath | z3-solver简单使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#luck-%E7%AE%80%E5%8D%95%E7%88%86%E7%A0%B4"><span class="nav-number">4.</span> <span class="nav-text">luck | 简单爆破</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A0%8D%E6%A0%91-%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91"><span class="nav-number">5.</span> <span class="nav-text">砍树 | 安卓逆向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AC%E8%AF%B4cpp%E5%BE%88%E9%9A%BE%EF%BC%9F-C-%E9%80%86%E5%90%91"><span class="nav-number">6.</span> <span class="nav-text">听说cpp很难？ | C++逆向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flower-or-tea-%E7%AE%80%E5%8D%95%E8%8A%B1%E6%8C%87%E4%BB%A4%E5%92%8CTEA%E5%8A%A0%E5%AF%86"><span class="nav-number">7.</span> <span class="nav-text">flower-or-tea | 简单花指令和TEA加密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rainbow-%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96"><span class="nav-number">8.</span> <span class="nav-text">rainbow | 控制流平坦化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mySelf-%E7%AE%80%E5%8D%95SMC"><span class="nav-number">9.</span> <span class="nav-text">mySelf | 简单SMC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E9%BB%84%E9%B8%AD-Python%E9%80%86%E5%90%91"><span class="nav-number">10.</span> <span class="nav-text">小黄鸭 | Python逆向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%AA%E6%BC%AB%E8%87%B3%E6%AD%BB%E4%B8%8D%E6%B8%9D-JS%E9%80%86%E5%90%91"><span class="nav-number">11.</span> <span class="nav-text">浪漫至死不渝 | JS逆向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E5%88%9D%E9%9F%B3%E6%9C%AA%E6%9D%A5-Go%E8%AF%AD%E8%A8%80%E9%80%86%E5%90%91-%E4%B8%80%E5%9D%A8go%E5%8F%B2"><span class="nav-number">12.</span> <span class="nav-text">寻找初音未来 | Go语言逆向 | 一坨go史</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AES-AES-AES%E7%AE%97%E6%B3%95%E9%AD%94%E6%94%B9"><span class="nav-number">13.</span> <span class="nav-text">AES! AES? | AES算法魔改</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezandroid-%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91"><span class="nav-number">14.</span> <span class="nav-text">ezandroid | 安卓逆向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%AF%E7%94%B7%E4%BA%BA%E5%B0%B1%E6%9D%A5%E6%89%8E%E9%92%88-Unity%E5%BC%95%E6%93%8E%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91"><span class="nav-number">15.</span> <span class="nav-text">是男人就来扎针 | Unity引擎游戏逆向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#babycode-%E4%B8%8D%E7%9F%A5%E9%81%93%E4%BB%80%E4%B9%88%E5%8A%A0%E5%AF%86"><span class="nav-number">16.</span> <span class="nav-text">babycode | 不知道什么加密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#yakvm-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%86%E5%90%91"><span class="nav-number">17.</span> <span class="nav-text">yakvm | 虚拟机逆向</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">1K0CT B14s</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <!--
-->

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">1K0CT B14s</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">343k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">5:12</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
