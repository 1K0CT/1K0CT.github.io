<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="manifest" href="/images/manifest.json">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-corner-indicator.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"ikoct.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="参赛ID:1K0CT">
<meta property="og:type" content="article">
<meta property="og:title" content="LACTF2024逆向方向部分wp">
<meta property="og:url" content="https://ikoct.com/2024/02/23/LACTF2024%E9%80%86%E5%90%91%E6%96%B9%E5%90%91%E9%83%A8%E5%88%86wp/">
<meta property="og:site_name" content="Ikoct的饮冰室">
<meta property="og:description" content="参赛ID:1K0CT">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-202615.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-204927.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-205334.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-205719.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-210214.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-210252.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-210545.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-224117.png">
<meta property="article:published_time" content="2024-02-23T15:05:01.000Z">
<meta property="article:modified_time" content="2024-10-23T07:09:11.410Z">
<meta property="article:author" content="1K0CT B14s">
<meta property="article:tag" content="Reverse">
<meta property="article:tag" content="Writeups">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-202615.png">

<link rel="canonical" href="https://ikoct.com/2024/02/23/LACTF2024%E9%80%86%E5%90%91%E6%96%B9%E5%90%91%E9%83%A8%E5%88%86wp/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>LACTF2024逆向方向部分wp | Ikoct的饮冰室</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Ikoct的饮冰室</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">你愿意和我学一辈子二进制吗?</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ikoct.com/2024/02/23/LACTF2024%E9%80%86%E5%90%91%E6%96%B9%E5%90%91%E9%83%A8%E5%88%86wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/myavatar.gif">
      <meta itemprop="name" content="1K0CT B14s">
      <meta itemprop="description" content="残りの人生、私にくれませんか？">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ikoct的饮冰室">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LACTF2024逆向方向部分wp
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-02-23 23:05:01" itemprop="dateCreated datePublished" datetime="2024-02-23T23:05:01+08:00">2024-02-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-10-23 15:09:11" itemprop="dateModified" datetime="2024-10-23T15:09:11+08:00">2024-10-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6/" itemprop="url" rel="index"><span itemprop="name">二进制</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>20k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>19 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>参赛ID:1K0CT</p>
<span id="more"></span>

<h2 id="shattered-memories"><a href="#shattered-memories" class="headerlink" title="shattered-memories"></a><strong>shattered-memories</strong></h2><p>签到题 DIE查壳 无壳64x IDA64打开直接拼flag:</p>
<p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-202615.png" alt="image-20240223202112685"></p>
<h2 id="aplet321-接轨pwn"><a href="#aplet321-接轨pwn" class="headerlink" title="aplet321 | 接轨pwn"></a><strong>aplet321</strong> | 接轨pwn</h2><p>DIE查壳 无壳64x IDA64打开:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ebp</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// r12d</span></span><br><span class="line">  <span class="type">char</span> *v7; <span class="comment">// r15</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">568</span>]; <span class="comment">// [rsp+10h] [rbp-238h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = s;</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;hi, i&#x27;m aplet321. how can i help?&quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">512</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">if</span> ( v4 &lt;= <span class="number">5</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v7 = &amp;s[(v4 - <span class="number">6</span>) + <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v6 += <span class="built_in">strncmp</span>(v3, <span class="string">&quot;pretty&quot;</span>, <span class="number">6uLL</span>) == <span class="number">0</span>;     <span class="comment">// v6 = 15</span></span><br><span class="line">                                                <span class="comment">// v5 = 39</span></span><br><span class="line">    v5 += <span class="built_in">strncmp</span>(v3++, <span class="string">&quot;please&quot;</span>, <span class="number">6uLL</span>) == <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v3 != v7 );</span><br><span class="line">  <span class="keyword">if</span> ( v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strstr</span>(s, <span class="string">&quot;flag&quot;</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v6 + v5 == <span class="number">54</span> &amp;&amp; v6 - v5 == <span class="number">-24</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;ok here&#x27;s your flag&quot;</span>);</span><br><span class="line">        system(<span class="string">&quot;cat flag.txt&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;sorry, i&#x27;m not allowed to do that&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;sorry, i didn&#x27;t understand what you mean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_10:</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;so rude&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>逻辑是检测接收到的数据中包含连续的<code>pretty</code>或<code>please</code>的个数并要求含有<code>flag</code> 简单解解方程算出分别需要出现多少次 然后写出exp发送数据:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">v6 =  <span class="string">b&quot;pretty&quot;</span> * <span class="number">15</span></span><br><span class="line">v5 =  <span class="string">b&quot;please&quot;</span> * <span class="number">39</span></span><br><span class="line">fin = <span class="string">b&quot;flag&quot;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;chall.lac.tf&quot;</span>, <span class="number">31321</span>)</span><br><span class="line"></span><br><span class="line">r.sendline(v6 + v5 + fin)</span><br><span class="line">r.interactive()</span><br><span class="line"><span class="comment"># lactf&#123;next_year_i&#x27;ll_make_aplet456_hqp3c1a7bip5bmnc&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="the-secret-of-java-island-java逆向-爆破"><a href="#the-secret-of-java-island-java逆向-爆破" class="headerlink" title="the-secret-of-java-island | java逆向 | 爆破"></a><strong>the-secret-of-java-island</strong> | java逆向 | 爆破</h2><p>一个按钮点击小游戏 目标是进入以下状态:</p>
<p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-204927.png" alt="image-20240223204927460"></p>
<p>但是直接nc到该端口无法获得flag 还是要玩游戏 核心逻辑:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (paramInt == <span class="number">0</span>) &#123;</span><br><span class="line">  exploit += <span class="string">&quot;d&quot;</span>;</span><br><span class="line">  story.setText(<span class="string">&quot;You clobbered the DOM. That was exploit #&quot;</span> + exploit.length() + <span class="string">&quot;.&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  exploit += <span class="string">&quot;p&quot;</span>;</span><br><span class="line">  story.setText(<span class="string">&quot;You polluted the prototype. That was exploit #&quot;</span> + exploit.length() + <span class="string">&quot;.&quot;</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span> (exploit.length() == <span class="number">8</span>)</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="type">MessageDigest</span> <span class="variable">messageDigest</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;SHA-256&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!Arrays.equals(messageDigest.digest(exploit.getBytes(<span class="string">&quot;UTF-8&quot;</span>)), <span class="keyword">new</span> <span class="title class_">byte</span>[] &#123; </span><br><span class="line">          <span class="number">69</span>, <span class="number">70</span>, -<span class="number">81</span>, -<span class="number">117</span>, -<span class="number">10</span>, <span class="number">109</span>, <span class="number">15</span>, <span class="number">29</span>, <span class="number">19</span>, <span class="number">113</span>, </span><br><span class="line">          <span class="number">61</span>, -<span class="number">123</span>, -<span class="number">39</span>, <span class="number">82</span>, -<span class="number">11</span>, -<span class="number">34</span>, <span class="number">104</span>, -<span class="number">98</span>, -<span class="number">111</span>, <span class="number">9</span>, </span><br><span class="line">          <span class="number">43</span>, <span class="number">35</span>, -<span class="number">19</span>, <span class="number">22</span>, <span class="number">52</span>, -<span class="number">55</span>, -<span class="number">124</span>, -<span class="number">45</span>, -<span class="number">72</span>, -<span class="number">23</span>, </span><br><span class="line">          <span class="number">96</span>, -<span class="number">77</span> &#125;)) &#123;</span><br><span class="line">      state = <span class="number">7</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      state = <span class="number">6</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    updateGame();</span><br></pre></td></tr></table></figure>

<p>根据按钮点击情况向校验字符串添加<code>d</code>或者<code>p</code>然后求sha256哈希值进行校验 由于长度只有8可能性很少所以直接爆破:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">enc = <span class="string">&quot;4546af8bf66d0f1d13713d85d952f5de689e91092b23ed1634c984d3b8e960b3&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha256_encrypt</span>(<span class="params">plaintext</span>):</span><br><span class="line">    plaintext_bytes = plaintext.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    sha256_hash = hashlib.sha256(plaintext_bytes)</span><br><span class="line">    <span class="keyword">return</span> sha256_hash.hexdigest().lower()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x100</span>):</span><br><span class="line">        plaintext = <span class="string">&quot;&#123;:08b&#125;&quot;</span>.<span class="built_in">format</span>(i).replace(<span class="string">&quot;0&quot;</span>, <span class="string">&quot;p&quot;</span>).replace(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;d&quot;</span>)</span><br><span class="line">        encrypted_hash = sha256_encrypt(plaintext)</span><br><span class="line">        <span class="keyword">if</span> encrypted_hash == enc:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;find:&quot;</span>, plaintext)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment"># find: dpddpdpp</span></span><br></pre></td></tr></table></figure>

<p>然后在游戏中进行对应操作获得flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-205334.png" alt="image-20240223205333972"></p>
<h2 id="flag-finder-GM逆向"><a href="#flag-finder-GM逆向" class="headerlink" title="flag-finder | GM逆向"></a><strong>flag-finder</strong> | GM逆向</h2><p>文件包含data.win 说明是使用GameMaker编写的游戏 二进制文件只包含窗口消息的处理等最底层的逻辑 所以没必要太仔细分析 用目前最好的GM解包应用UndertaleModTool解包data.win</p>
<p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-205719.png" alt="image-20240223205719675"></p>
<p>游戏的目标是找到key 但是地图上找不到 根据提示key一定在这个<code>room</code>中 </p>
<p>在游戏Rooms中找到这样一个实例:</p>
<p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-210214.png" alt="image-20240223210214778"></p>
<p>对应生成位置:<img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-210252.png" alt="image-20240223210252760"></p>
<p>超出了地图空气墙范围 查看flag所在位置并将key修改到相近位置 UndertaleModTool支持直接运行修改后的data.win 完成任务得到flag:</p>
<p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-210545.png" alt="image-20240223210545560"></p>
<h2 id="glottem-algre"><a href="#glottem-algre" class="headerlink" title="glottem | algre"></a><strong>glottem</strong> | algre</h2><p>明文 直接notepad打开:</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">#</span>!/bin/sh</span><br><span class="line">1&lt;&lt;4201337</span><br><span class="line">1//1,&quot;&quot;&quot;</span><br><span class="line">exit=process.exit;argv=process.argv.slice(1)/*</span><br><span class="line">4201337</span><br><span class="line">read -p &quot;flag? &quot; flag</span><br><span class="line">node <span class="built_in">$</span>0 &quot;<span class="built_in">$</span>flag&quot; <span class="built_in">&amp;</span><span class="built_in">&amp;</span> python3 <span class="built_in">$</span>0 &quot;<span class="built_in">$</span>flag&quot; <span class="built_in">&amp;</span><span class="built_in">&amp;</span> echo correct || echo incorrect</span><br><span class="line">1&lt;&lt;4201337</span><br><span class="line">*///&quot;&quot;&quot;;from sys import argv</span><br><span class="line">e = [[[...], ...], ...]</span><br><span class="line">alpha=&quot;abcdefghijklmnopqrstuvwxyz<span class="built_in">_</span>&quot;</span><br><span class="line">d=0;s=argv[1];1//1;&quot;&quot;&quot;</span><br><span class="line">/*&quot;&quot;&quot;</span><br><span class="line"><span class="params">#</span>*/for (let i = 0; i &lt; s.length; i ++) &#123;/*</span><br><span class="line">for i in range(6,len(s)-2):</span><br><span class="line">    <span class="params">#</span>*/d=(d*31+s.charCodeAt(i))<span class="comment">%93097/*</span></span><br><span class="line">    d+=e[i-6][alpha.index(s[i])][alpha.index(s[i+1])]<span class="params">#</span>*/&#125;</span><br><span class="line">exit(+(d!=260,[d!=61343])[0])</span><br><span class="line">4201337</span><br></pre></td></tr></table></figure>

<p>数据e过长不展示 这个文件想表达的意思应该是输入的flag要分别满足python展示的代码和注释起来的java代码 java的逻辑很好理解 python代码的意思是保证flag内容中当前字符的位置作为1级索引来确定”层” 当前字符在表中的位置作为2级索引确定在层中的”段” 当前字符的后一个字符在表中的位置为3级索引从”段”中选取加数 题目提示flag长度34 去掉lactf{}后为26 而最后d就是要与260校验 python简单写个程序发现e中最小的数就是10 所以目标就是找到0~25层之间所有<code>10</code>的通路 结合java代码的逻辑最后写出脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">e = [[[...], ...], ...]</span><br><span class="line"><span class="comment"># ind = []</span></span><br><span class="line"><span class="comment"># for _ in range(26):</span></span><br><span class="line"><span class="comment">#     for __ in range(len(e[_])):</span></span><br><span class="line"><span class="comment">#         for ___ in range(len(e[_][__])):</span></span><br><span class="line"><span class="comment">#             if e[_][__][___] == 10:</span></span><br><span class="line"><span class="comment">#                 ind.append([_,__,___])</span></span><br><span class="line"><span class="comment"># print(ind)</span></span><br><span class="line"></span><br><span class="line">alpha=<span class="string">&quot;abcdefghijklmnopqrstuvwxyz_&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_paths</span>(<span class="params">node_list</span>):</span><br><span class="line">    paths = []</span><br><span class="line">    stack = []</span><br><span class="line">    visited = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> node_list:</span><br><span class="line">        <span class="keyword">if</span> node[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">            stack.append([node])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> stack:</span><br><span class="line">        path = stack.pop()</span><br><span class="line">        current_node = path[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> current_node[<span class="number">0</span>] == <span class="number">25</span>:</span><br><span class="line">            paths.append(path)</span><br><span class="line">        visited.clear()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> node <span class="keyword">in</span> node_list:</span><br><span class="line">            <span class="keyword">if</span> node[<span class="number">0</span>] == current_node[<span class="number">0</span>] + <span class="number">1</span> <span class="keyword">and</span> node[<span class="number">1</span>] == current_node[<span class="number">2</span>]:</span><br><span class="line">                <span class="keyword">if</span> node <span class="keyword">not</span> <span class="keyword">in</span> path:</span><br><span class="line">                    new_path = <span class="built_in">list</span>(path)</span><br><span class="line">                    new_path.append(node)</span><br><span class="line">                    stack.append(new_path)</span><br><span class="line">                    visited.add(node)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> paths</span><br><span class="line"></span><br><span class="line">node_list = [(...), ...]</span><br><span class="line"></span><br><span class="line">paths = find_paths(node_list)</span><br><span class="line">flags = []</span><br><span class="line"><span class="keyword">for</span> path <span class="keyword">in</span> paths:</span><br><span class="line">    flags.append(<span class="string">&quot;lactf&#123;&quot;</span> + <span class="string">&quot;&quot;</span>.join([alpha[node[<span class="number">1</span>]] <span class="keyword">for</span> node <span class="keyword">in</span> path]) + alpha[path[-<span class="number">1</span>][<span class="number">2</span>]] + <span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> flags:</span><br><span class="line">    d = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> s:</span><br><span class="line">        d = (<span class="number">31</span> * d + <span class="built_in">ord</span>(each)) % <span class="number">93097</span></span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">61343</span>:</span><br><span class="line">        <span class="built_in">print</span>(s)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># lactf&#123;solve_one_get_two_free_deal&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="meow-meow-爆破"><a href="#meow-meow-爆破" class="headerlink" title="meow meow | 爆破"></a><strong>meow meow</strong> | 爆破</h2><p>附件给了7个很大的data文件 先看二进制文件 DIE查壳 无壳64x IDA64打开:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// al</span></span><br><span class="line">  <span class="type">size_t</span> v5; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">size_t</span> v6; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">char</span> name[<span class="number">6</span>]; <span class="comment">// [rsp+Ah] [rbp-1A6h] BYREF</span></span><br><span class="line">  __int64 *proc_1[<span class="number">12</span>]; <span class="comment">// [rsp+10h] [rbp-1A0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+70h] [rbp-140h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">8</span>]; <span class="comment">// [rsp+80h] [rbp-130h] BYREF</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+88h] [rbp-128h]</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+90h] [rbp-120h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+98h] [rbp-118h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+A0h] [rbp-110h]</span></span><br><span class="line">  __int64 v15; <span class="comment">// [rsp+A8h] [rbp-108h]</span></span><br><span class="line">  __int64 v16; <span class="comment">// [rsp+B0h] [rbp-100h]</span></span><br><span class="line">  __int64 v17; <span class="comment">// [rsp+B8h] [rbp-F8h]</span></span><br><span class="line">  __int64 v18; <span class="comment">// [rsp+C0h] [rbp-F0h]</span></span><br><span class="line">  __int64 v19; <span class="comment">// [rsp+C8h] [rbp-E8h]</span></span><br><span class="line">  __int64 v20; <span class="comment">// [rsp+D0h] [rbp-E0h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+D8h] [rbp-D8h]</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// [rsp+E0h] [rbp-D0h]</span></span><br><span class="line">  __int64 input_proc[<span class="number">2</span>]; <span class="comment">// [rsp+F0h] [rbp-C0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// [rsp+100h] [rbp-B0h]</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// [rsp+190h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+194h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+198h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+19Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  *s = <span class="number">0LL</span>;</span><br><span class="line">  v11 = <span class="number">0LL</span>;</span><br><span class="line">  v12 = <span class="number">0LL</span>;</span><br><span class="line">  v13 = <span class="number">0LL</span>;</span><br><span class="line">  v14 = <span class="number">0LL</span>;</span><br><span class="line">  v15 = <span class="number">0LL</span>;</span><br><span class="line">  v16 = <span class="number">0LL</span>;</span><br><span class="line">  v17 = <span class="number">0LL</span>;</span><br><span class="line">  v18 = <span class="number">0LL</span>;</span><br><span class="line">  v19 = <span class="number">0LL</span>;</span><br><span class="line">  v20 = <span class="number">0LL</span>;</span><br><span class="line">  v21 = <span class="number">0LL</span>;</span><br><span class="line">  v22 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(proc_1, <span class="number">0</span>, <span class="keyword">sizeof</span>(proc_1));</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Meow Meow? &quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">95</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  s[<span class="built_in">strcspn</span>(s, <span class="string">&quot;\n&quot;</span>)] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) % <span class="number">5</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;WOOOOOOOF BARK BARK BARK&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = i;</span><br><span class="line">      <span class="keyword">if</span> ( v5 &gt;= <span class="built_in">strlen</span>(s) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v4 = trans(s[i]);</span><br><span class="line">      *(proc_1 + i) = v4;                       <span class="comment">// lowercase-&gt;&#x27;a&#x27; offset</span></span><br><span class="line">                                                <span class="comment">// _ -&gt;26</span></span><br><span class="line">                                                <span class="comment">// &#123; -&gt;27</span></span><br><span class="line">                                                <span class="comment">// &#125; -&gt;28</span></span><br><span class="line">      <span class="keyword">if</span> ( *(proc_1 + i) == <span class="number">0xFF</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;WOOOOOOOF BARK BARK BARK&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2LL</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">strcpy</span>(name, <span class="string">&quot;data0&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; ; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = j;</span><br><span class="line">      <span class="keyword">if</span> ( v6 &gt;= <span class="built_in">strlen</span>(s) / <span class="number">5</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        ++name[<span class="number">4</span>];</span><br><span class="line">        <span class="keyword">if</span> ( access(name, <span class="number">0</span>) )</span><br><span class="line">        &#123;</span><br><span class="line">          v25 = <span class="number">0</span>;</span><br><span class="line">          v24 = <span class="number">0</span>;</span><br><span class="line">          input_proc[<span class="number">0</span>] = s;</span><br><span class="line">          input_proc[<span class="number">1</span>] = proc_1;</span><br><span class="line">          GOMP_parallel(func, input_proc, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">          v25 = v24;</span><br><span class="line">          <span class="keyword">if</span> ( v24 == <span class="number">7</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;MEOW&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">999</span>; ++k )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">putchar</span>(<span class="number">33</span>);</span><br><span class="line">              fflush(<span class="built_in">stdout</span>);</span><br><span class="line">              usleep(<span class="number">0x3E8</span>u);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Woof.....&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;WOOOOOOOF BARK BARK BARK&quot;</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="number">4LL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      ++name[<span class="number">4</span>];</span><br><span class="line">      <span class="keyword">if</span> ( access(name, <span class="number">0</span>) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;WOOOOOOOF BARK BARK BARK&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">3LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Error: make sure you have downloaded and extracted the data.zip files into the same folder as the executable.&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输入的长度为5n 使用GOMP_parallel创建了func的线程 func:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_55811199B67A</span><span class="params">(__int64 input_proc)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// r12d</span></span><br><span class="line">  <span class="type">int</span> num_threads; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">int</span> thread_num; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ebx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> buf[<span class="number">29</span>]; <span class="comment">// [rsp+10h] [rbp-A0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> file[<span class="number">4</span>]; <span class="comment">// [rsp+85h] [rbp-2Bh] BYREF</span></span><br><span class="line">  __int16 v11; <span class="comment">// [rsp+89h] [rbp-27h]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [rsp+8Bh] [rbp-25h]</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [rsp+8Ch] [rbp-24h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+90h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> key; <span class="comment">// [rsp+94h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// [rsp+98h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v17; <span class="comment">// [rsp+9Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  v1 = <span class="built_in">strlen</span>(*input_proc) / <span class="number">5</span>;</span><br><span class="line">  num_threads = omp_get_num_threads();</span><br><span class="line">  thread_num = omp_get_thread_num();</span><br><span class="line">  v4 = v1 / num_threads;</span><br><span class="line">  v5 = v1 % num_threads;</span><br><span class="line">  <span class="keyword">if</span> ( thread_num &lt; v1 % num_threads )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    ++v4;</span><br><span class="line">  &#125;</span><br><span class="line">  v6 = v4 * thread_num + v5;</span><br><span class="line">  v7 = v6 + v4;</span><br><span class="line">  <span class="keyword">if</span> ( v6 &lt; v6 + v4 )</span><br><span class="line">  &#123;</span><br><span class="line">    v16 = v6;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      *file = <span class="number">0x61746164</span>;</span><br><span class="line">      v11 = (v16 + <span class="number">49</span>);</span><br><span class="line">      fd = open(file, <span class="number">0</span>);</span><br><span class="line">      key = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        lseek(fd, (<span class="number">0x74</span> * key), <span class="number">0</span>);</span><br><span class="line">        v12 = *(*(input_proc + <span class="number">8</span>) + <span class="number">5</span> * v16 + i);<span class="comment">// key = 0</span></span><br><span class="line">                                                <span class="comment">// loop(0, 5):</span></span><br><span class="line">                                                <span class="comment">//    offset += key * 0x74</span></span><br><span class="line">                                                <span class="comment">//    key = data[offset + proc[5 * n + i]]</span></span><br><span class="line">                                                <span class="comment">//    offset += 0x74</span></span><br><span class="line">        read(fd, buf, <span class="number">0x74</span>uLL);</span><br><span class="line">        key = buf[v12];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( key == <span class="number">0x63617400</span> )</span><br><span class="line">        ++v17;</span><br><span class="line">      ++v16;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v16 &lt; v7 );</span><br><span class="line">  &#125;</span><br><span class="line">  result = v17;</span><br><span class="line">  _InterlockedAdd((input_proc + <span class="number">16</span>), v17);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5 bytes一组用输入来控制文件指针 要求最后读到的数据中某处是0x63617400(<code>cat\x0</code>) 不知道怎么逆向计算出这5 bytes 直接爆破:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// for(int _ = 1; _ &lt;= 7; _++)&#123;</span></span><br><span class="line">    <span class="comment">//     string data = &quot;data&quot; + to_string(_);</span></span><br><span class="line">    <span class="comment">//     auto fd = open(data.c_str(), 0);</span></span><br><span class="line">    <span class="comment">//     int table[] = &#123;0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28&#125;;</span></span><br><span class="line">    <span class="comment">//     for(int a : table)&#123;</span></span><br><span class="line">    <span class="comment">//         bool f = 0;</span></span><br><span class="line">    <span class="comment">//         for(int b : table)&#123;</span></span><br><span class="line">    <span class="comment">//             for(int c : table)&#123;</span></span><br><span class="line">    <span class="comment">//                 for(int d : table)&#123;</span></span><br><span class="line">    <span class="comment">//                     for(int e : table)&#123;</span></span><br><span class="line">    <span class="comment">//                         int key = 0;</span></span><br><span class="line">    <span class="comment">//                         int buf[29];</span></span><br><span class="line">    <span class="comment">//                         int temp[5] = &#123;a, b, c, d, e&#125;;</span></span><br><span class="line">    <span class="comment">//                         for(int __ = 0; __ &lt;= 4; __++)&#123;</span></span><br><span class="line">    <span class="comment">//                             lseek(fd, 0x74 * key, 0);</span></span><br><span class="line">    <span class="comment">//                             int v = temp[__];</span></span><br><span class="line">    <span class="comment">//                             read(fd, buf, 0x74);</span></span><br><span class="line">    <span class="comment">//                             key = buf[v];</span></span><br><span class="line">    <span class="comment">//                         &#125;</span></span><br><span class="line">    <span class="comment">//                         if(key == 0x63617400)&#123;</span></span><br><span class="line">    <span class="comment">//                             printf(&quot;&#123;%d, %d, %d, %d, %d&#125;,\n&quot;, a, b, c, d, e);</span></span><br><span class="line">    <span class="comment">//                             f = 1;</span></span><br><span class="line">    <span class="comment">//                             break;</span></span><br><span class="line">    <span class="comment">//                         &#125;</span></span><br><span class="line">    <span class="comment">//                     &#125;</span></span><br><span class="line">    <span class="comment">//                     if(f) break;</span></span><br><span class="line">    <span class="comment">//                 &#125;</span></span><br><span class="line">    <span class="comment">//                 if(f) break;</span></span><br><span class="line">    <span class="comment">//             &#125;</span></span><br><span class="line">    <span class="comment">//             if(f) break;</span></span><br><span class="line">    <span class="comment">//         &#125;</span></span><br><span class="line">    <span class="comment">//         if(f) break;</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//     close(fd);</span></span><br><span class="line">    <span class="comment">//     printf(&quot;====================\n&quot;);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="type">char</span> alpha_table[<span class="number">29</span>] = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>&#125;;</span><br><span class="line">    <span class="type">int</span> flag_pieces[<span class="number">7</span>][<span class="number">5</span>] = &#123;</span><br><span class="line">            &#123;<span class="number">11</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">19</span>, <span class="number">5</span>&#125;,</span><br><span class="line">            &#123;<span class="number">27</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">22</span>&#125;,</span><br><span class="line">            &#123;<span class="number">26</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">26</span>&#125;,</span><br><span class="line">            &#123;<span class="number">5</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">3</span>&#125;,</span><br><span class="line">            &#123;<span class="number">26</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">26</span>, <span class="number">4</span>&#125;,</span><br><span class="line">            &#123;<span class="number">15</span>, <span class="number">2</span>, <span class="number">18</span>, <span class="number">8</span>, <span class="number">7</span>&#125;,</span><br><span class="line">            &#123;<span class="number">13</span>, <span class="number">23</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">28</span>&#125;,</span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, alpha_table[flag_pieces[i][j]]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// lactf&#123;meow_you_found_me_epcsihnxos&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>爆破花了5mins左右 不知道这是不是预期解 得到的flag片段刚好就是按顺序排列的 说明GOMP_parallel函数产生的线程的id就是从0开始递增而不是随机的</p>
<h2 id="rbp-函数控制"><a href="#rbp-函数控制" class="headerlink" title="rbp | 函数控制"></a><strong>rbp</strong> | 函数控制</h2><p>DIE查壳 无壳64x IDA64打开:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_71247</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+14h] [rbp-FCh]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+18h] [rbp-F8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-F4h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+20h] [rbp-F0h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp-ECh]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+28h] [rbp-E8h]</span></span><br><span class="line">  <span class="type">int</span> m; <span class="comment">// [rsp+2Ch] [rbp-E4h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+30h] [rbp-E0h]</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+38h] [rbp-D8h]</span></span><br><span class="line">  __int128 v13[<span class="number">2</span>]; <span class="comment">// [rsp+40h] [rbp-D0h] BYREF</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+60h] [rbp-B0h]</span></span><br><span class="line">  <span class="type">int</span> v15[<span class="number">38</span>]; <span class="comment">// [rsp+70h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v16; <span class="comment">// [rsp+108h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v16 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v12 = sub_717F0(a1);</span><br><span class="line">  <span class="built_in">memset</span>(v13, <span class="number">0</span>, <span class="keyword">sizeof</span>(v13));</span><br><span class="line">  v14 = <span class="number">0LL</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">2</span>;</span><br><span class="line">LABEL_7:</span><br><span class="line">  <span class="keyword">while</span> ( v4 &lt;= <span class="number">9</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ++v5;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">2</span>; i &lt; v5; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(v5 % i) )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">    &#125;</span><br><span class="line">    v1 = v4++;</span><br><span class="line">    *(v13 + v1) = v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v12 == DWORD1(v13[<span class="number">0</span>]) * DWORD2(v13[<span class="number">0</span>]) )</span><br><span class="line">  &#123;</span><br><span class="line">    v15[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    v15[<span class="number">1</span>] = <span class="number">13</span>;</span><br><span class="line">    v15[<span class="number">2</span>] = <span class="number">15</span>;</span><br><span class="line">    v15[<span class="number">3</span>] = <span class="number">24</span>;</span><br><span class="line">    v15[<span class="number">4</span>] = <span class="number">10</span>;</span><br><span class="line">    v15[<span class="number">5</span>] = <span class="number">23</span>;</span><br><span class="line">    v15[<span class="number">6</span>] = <span class="number">13</span>;</span><br><span class="line">    v15[<span class="number">7</span>] = <span class="number">0</span>;</span><br><span class="line">    v15[<span class="number">8</span>] = <span class="number">2</span>;</span><br><span class="line">    v15[<span class="number">9</span>] = <span class="number">21</span>;</span><br><span class="line">    v15[<span class="number">10</span>] = <span class="number">7</span>;</span><br><span class="line">    v15[<span class="number">11</span>] = <span class="number">26</span>;</span><br><span class="line">    v15[<span class="number">12</span>] = <span class="number">15</span>;</span><br><span class="line">    v15[<span class="number">13</span>] = <span class="number">2</span>;</span><br><span class="line">    v15[<span class="number">14</span>] = <span class="number">0</span>;</span><br><span class="line">    v15[<span class="number">15</span>] = <span class="number">23</span>;</span><br><span class="line">    v15[<span class="number">16</span>] = <span class="number">5</span>;</span><br><span class="line">    v15[<span class="number">17</span>] = <span class="number">24</span>;</span><br><span class="line">    v15[<span class="number">18</span>] = <span class="number">24</span>;</span><br><span class="line">    v15[<span class="number">19</span>] = <span class="number">21</span>;</span><br><span class="line">    v15[<span class="number">20</span>] = <span class="number">23</span>;</span><br><span class="line">    v15[<span class="number">21</span>] = <span class="number">0</span>;</span><br><span class="line">    v15[<span class="number">22</span>] = <span class="number">18</span>;</span><br><span class="line">    v15[<span class="number">23</span>] = <span class="number">15</span>;</span><br><span class="line">    v15[<span class="number">24</span>] = <span class="number">10</span>;</span><br><span class="line">    v15[<span class="number">25</span>] = <span class="number">7</span>;</span><br><span class="line">    v15[<span class="number">26</span>] = <span class="number">5</span>;</span><br><span class="line">    v15[<span class="number">27</span>] = <span class="number">18</span>;</span><br><span class="line">    v15[<span class="number">28</span>] = <span class="number">0</span>;</span><br><span class="line">    v15[<span class="number">29</span>] = <span class="number">29</span>;</span><br><span class="line">    v15[<span class="number">30</span>] = <span class="number">23</span>;</span><br><span class="line">    v15[<span class="number">31</span>] = <span class="number">26</span>;</span><br><span class="line">    v15[<span class="number">32</span>] = <span class="number">24</span>;</span><br><span class="line">    v15[<span class="number">33</span>] = <span class="number">15</span>;</span><br><span class="line">    v15[<span class="number">34</span>] = <span class="number">29</span>;</span><br><span class="line">    v15[<span class="number">35</span>] = <span class="number">0</span>;</span><br><span class="line">    v11 = <span class="number">1LL</span>;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">5</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">5</span>; ++k )</span><br><span class="line">      &#123;</span><br><span class="line">        v3 = v7++;</span><br><span class="line">        <span class="keyword">if</span> ( (a1[j] ^ a1[k]) != v15[v3] )</span><br><span class="line">        &#123;</span><br><span class="line">          result = <span class="number">0LL</span>;</span><br><span class="line">          <span class="keyword">goto</span> LABEL_32;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      v11 *= a1[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v11 == <span class="number">0x15F6D1945A0</span>LL )    <span class="comment">//↑head with lactf&#123;</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( a1[<span class="number">34</span>] == <span class="number">125</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">for</span> ( m = <span class="number">6</span>; m &lt;= <span class="number">33</span>; ++m )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( flag != <span class="number">-1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            reset(flag);</span><br><span class="line">            flag = <span class="number">-1</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( lowcase(a1[m]) != <span class="number">1</span> || num(a1[m]) != <span class="number">1</span> || underline(a1[m]) != <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            result = <span class="number">0LL</span>;</span><br><span class="line">            <span class="keyword">goto</span> LABEL_32;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        result = check(byte_70B00, <span class="string">&quot;vwbowpcjrhpkobfryu&quot;</span>) == <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        result = <span class="number">0LL</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_32:</span><br><span class="line">  <span class="keyword">if</span> ( v16 != __readfsqword(<span class="number">0x28</span>u) )</span><br><span class="line">    <span class="keyword">return</span> sub_71800();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//lowercase:</span></span><br><span class="line">__int64 __fastcall <span class="title function_">sub_68000</span><span class="params">(<span class="type">char</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 &lt;= <span class="number">96</span> || a1 &gt; <span class="number">122</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  v2 = dword_70AE4++;</span><br><span class="line">  byte_70B00[v2] = a1;</span><br><span class="line">  <span class="keyword">if</span> ( (a1 == <span class="number">98</span> || a1 == <span class="number">99</span> || a1 == <span class="number">104</span> || a1 == <span class="number">115</span> || a1 == <span class="number">116</span>)</span><br><span class="line">    &amp;&amp; ++count != <span class="number">2</span></span><br><span class="line">    &amp;&amp; count != <span class="number">8</span></span><br><span class="line">    &amp;&amp; count != <span class="number">9</span></span><br><span class="line">    &amp;&amp; count != <span class="number">12</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    flag = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( a1 == <span class="number">100</span> )</span><br><span class="line">    flag = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//num:</span></span><br><span class="line">__int64 __fastcall <span class="title function_">sub_69000</span><span class="params">(<span class="type">char</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 &lt;= <span class="number">47</span> || a1 &gt; <span class="number">57</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a1 - <span class="number">48</span> != all_num % <span class="number">10</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  all_num /= <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">if</span> ( count == <span class="number">3</span> )</span><br><span class="line">    flag = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    flag = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//underline:</span></span><br><span class="line">__int64 __fastcall <span class="title function_">sub_70000</span><span class="params">(<span class="type">char</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( !(a1 * a1 % <span class="number">9024</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  flag = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//reset:</span></span><br><span class="line">__int64 __fastcall <span class="title function_">reset</span><span class="params">(<span class="type">char</span> flag)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( flag )</span><br><span class="line">    v1 = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v1 = <span class="number">7</span>;</span><br><span class="line">  <span class="keyword">if</span> ( sub_71850(lowcase, <span class="number">4096LL</span>, v1) == <span class="number">-1</span> )</span><br><span class="line">    sub_717C0();</span><br><span class="line">  <span class="keyword">if</span> ( flag == <span class="number">1</span> )</span><br><span class="line">    v2 = <span class="number">7</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v2 = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( sub_71850(num, <span class="number">4096LL</span>, v2) == <span class="number">-1</span> )</span><br><span class="line">    sub_717C0();</span><br><span class="line">  <span class="keyword">if</span> ( flag == <span class="number">2</span> )</span><br><span class="line">    v3 = <span class="number">7</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v3 = <span class="number">3</span>;</span><br><span class="line">  result = sub_71850(underline, <span class="number">4096LL</span>, v3);</span><br><span class="line">  <span class="keyword">if</span> ( result == <span class="number">-1</span> )</span><br><span class="line">    <span class="keyword">return</span> sub_717C0();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//sub_710F9</span></span><br><span class="line">__int64 __fastcall <span class="title function_">sub_710F9</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; dword_70AE4; ++i )</span><br><span class="line">    byte_70B00[i] = (byte_70B00[i] - <span class="number">96</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">  *(a3 + <span class="number">144</span>) = <span class="number">1LL</span>;</span><br><span class="line">  result = a3;</span><br><span class="line">  *(a3 + <span class="number">168</span>) = **(a3 + <span class="number">160</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过栈帧可以得知<code>sub_71850()</code>实际上是<code>mprotect()</code>  直接点进去看不到</p>
<p><img src="https://cdn.jsdelivr.net/gh/1K0CT/BlogImage@main/img/2024/02/23/20240223-224117.png" alt="image-20240223224117646"></p>
<p><code>mprotect()</code>可以设置程序对函数的权限(wrx) 7对应的就是wrx 3对应wr 所以被设置为7的函数可以执行 程序就是靠这个函数控制控制流的 据此可以分析出程序的所有逻辑:</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.读取到特定字母会导致count<span class="built_in">_</span>2 += 1</span><br><span class="line">2.读取到字母会向byte<span class="built_in">_</span>70B00中添加对应字母</span><br><span class="line">3.除了第2, 8, 9, 12个特定字母以外特定字母后必须跟数字</span><br><span class="line">4.字母d后必须跟下划线</span><br><span class="line">5.普通字母后必须跟字母</span><br><span class="line">6.第三个特殊字母后的第一个数字必须跟下划线</span><br><span class="line">7.否则数字后必须跟字母</span><br><span class="line">8.下划线后必须跟字母</span><br></pre></td></tr></table></figure>

<p>动调中还发现读取到字母时就会触发两次main中的<code>v4[0] = sub_710F9</code>(不清楚原理 mprotect导致调试器无法正常触发断点 无法查看这个函数的汇编代码 估计是通过异常处理触发的) 据此写出脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;vwbowpcjrhpkobfryuryuryu&quot;</span>]</span><br><span class="line">number_table = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;10430031&quot;</span>]</span><br><span class="line">special = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;bchst&quot;</span>]</span><br><span class="line">flag = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;lactf&#123;&quot;</span>]</span><br><span class="line">f = <span class="number">0</span></span><br><span class="line">f2 = <span class="number">0</span></span><br><span class="line">ind = <span class="number">6</span></span><br><span class="line">ind_for_num = <span class="number">0</span></span><br><span class="line">ind_for_alpha = <span class="number">0</span></span><br><span class="line">ind_for_alpha_in_table = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(ind &lt;= <span class="number">33</span>):</span><br><span class="line">    <span class="keyword">if</span> f == <span class="number">0</span>:</span><br><span class="line">        now = (key[ind_for_alpha] - <span class="number">97</span> + <span class="number">100</span> * <span class="number">26</span> - <span class="number">2</span> * (<span class="number">34</span> - ind)) % <span class="number">26</span> + <span class="number">97</span></span><br><span class="line">        flag.append(<span class="built_in">chr</span>(now))</span><br><span class="line">        ind += <span class="number">1</span></span><br><span class="line">        ind_for_alpha += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> now <span class="keyword">in</span> special:</span><br><span class="line">            ind_for_alpha_in_table += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> ind_for_alpha_in_table != <span class="number">2</span> <span class="keyword">and</span> ind_for_alpha_in_table != <span class="number">8</span> <span class="keyword">and</span> ind_for_alpha_in_table != <span class="number">9</span> <span class="keyword">and</span> ind_for_alpha_in_table != <span class="number">12</span>:</span><br><span class="line">                f = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> now == <span class="number">100</span>:</span><br><span class="line">            f = <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            f = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ind_for_alpha_in_table == <span class="number">3</span>:</span><br><span class="line">            f2 = <span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> f == <span class="number">1</span>:</span><br><span class="line">        now = number_table[ind_for_num]</span><br><span class="line">        flag.append(now)</span><br><span class="line">        ind += <span class="number">1</span></span><br><span class="line">        ind_for_num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> f2:</span><br><span class="line">            f = <span class="number">2</span></span><br><span class="line">            f2 = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            f = <span class="number">0</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> f == <span class="number">2</span>:</span><br><span class="line">        flag.append(<span class="string">&quot;_&quot;</span>)</span><br><span class="line">        ind += <span class="number">1</span></span><br><span class="line">        f = <span class="number">0</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(flag) + <span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment"># lactf&#123;rub1sc0_b4s3d_ph0t0synth3s1s&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="puzzlepalooza-Z3"><a href="#puzzlepalooza-Z3" class="headerlink" title="puzzlepalooza | Z3"></a><strong>puzzlepalooza</strong> | Z3</h2><p>DIE查壳 无壳64x IDA64打开:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v5; <span class="comment">// al</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> *v8; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// cl</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v17; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v18; <span class="comment">// r14d</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v19; <span class="comment">// edx</span></span><br><span class="line">  __m128i key; <span class="comment">// [rsp+0h] [rbp-F8h]</span></span><br><span class="line">  __m128i v21[<span class="number">2</span>]; <span class="comment">// [rsp+10h] [rbp-E8h]</span></span><br><span class="line">  __int128 v22[<span class="number">2</span>]; <span class="comment">// [rsp+30h] [rbp-C8h] BYREF</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+50h] [rbp-A8h]</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// [rsp+58h] [rbp-A0h]</span></span><br><span class="line">  __int16 v25; <span class="comment">// [rsp+5Ch] [rbp-9Ch]</span></span><br><span class="line">  <span class="type">char</span> v26; <span class="comment">// [rsp+5Eh] [rbp-9Ah] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">152</span>]; <span class="comment">// [rsp+60h] [rbp-98h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to the greatest puzzlepalooza ever!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Can you solve our puzzle without looking?&quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">100</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  s[<span class="built_in">strcspn</span>(s, <span class="string">&quot;\n&quot;</span>)] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) == <span class="number">54</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = s;</span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    key = _mm_load_si128(&amp;xmmword_5632A397C0E0);</span><br><span class="line">    v21[<span class="number">0</span>] = _mm_load_si128(&amp;xmmword_5632A397C0F0);</span><br><span class="line">    *(v21 + <span class="number">9</span>) = _mm_load_si128(&amp;xmmword_5632A397C100);</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = *v3 - <span class="number">64</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v5 &gt; <span class="number">0x3F</span>u )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      key.get_sbyte[v4 &gt;&gt; <span class="number">3</span>] ^= v5 &lt;&lt; (v4 &amp; <span class="number">7</span>);</span><br><span class="line">      <span class="keyword">if</span> ( (v4 &amp; <span class="number">7u</span>) &gt; <span class="number">2</span> )</span><br><span class="line">        key.get_sbyte[(v4 &gt;&gt; <span class="number">3</span>) + <span class="number">1</span>] ^= v5 &gt;&gt; (<span class="number">8</span> - (v4 &amp; <span class="number">7</span>));</span><br><span class="line">      v4 += <span class="number">6</span>;</span><br><span class="line">      ++v3;</span><br><span class="line">      <span class="keyword">if</span> ( v4 == <span class="number">324</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (key.get_sbyte[<span class="number">0</span>] &amp; <span class="number">0xF</span>u) &lt;= <span class="number">8</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v7 = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">while</span> ( ++v7 != <span class="number">81</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( ((key.get_ubyte[v7 &gt;&gt; <span class="number">1</span>] &gt;&gt; (<span class="number">4</span> * (v7 &amp; <span class="number">1</span>))) &amp; <span class="number">0xF</span>u) &gt; <span class="number">8</span> )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">          &#125;</span><br><span class="line">          v8 = v22;</span><br><span class="line">          v25 = <span class="number">1871</span>;</span><br><span class="line">          v23 = <span class="number">0x64A0847033B0136</span>LL;</span><br><span class="line">          v22[<span class="number">0</span>] = _mm_load_si128(&amp;xmmword_5632A397C0C0);</span><br><span class="line">          v24 = <span class="number">38667339</span>;</span><br><span class="line">          v22[<span class="number">1</span>] = _mm_load_si128(&amp;xmmword_5632A397C0D0);</span><br><span class="line">          <span class="keyword">while</span> ( v8[<span class="number">1</span>] == ((key.get_ubyte[*v8 &gt;&gt; <span class="number">1</span>] &gt;&gt; (<span class="number">4</span> * (*v8 &amp; <span class="number">1</span>))) &amp; <span class="number">0xF</span>) )</span><br><span class="line">          &#123;</span><br><span class="line">            v8 += <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> ( &amp;v26 == v8 )</span><br><span class="line">            &#123;</span><br><span class="line">              v9 = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                v10 = v9;</span><br><span class="line">                v11 = <span class="number">0</span>;</span><br><span class="line">                v12 = <span class="number">0</span>;</span><br><span class="line">                v13 = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> ( i = <span class="number">0</span>; i != <span class="number">9</span>; ++i )</span><br><span class="line">                &#123;</span><br><span class="line">                  v13 ^= <span class="number">1</span> &lt;&lt; ((key.get_ubyte[(i + <span class="number">9</span> * v9) &gt;&gt; <span class="number">1</span>] &gt;&gt; (<span class="number">4</span> * ((i + <span class="number">9</span> * v9) &amp; <span class="number">1</span>))) &amp; <span class="number">0xF</span>);</span><br><span class="line">                  v15 = v10;</span><br><span class="line">                  v16 = <span class="number">4</span> * (v10 &amp; <span class="number">1</span>);</span><br><span class="line">                  v10 += <span class="number">9</span>;</span><br><span class="line">                  v12 ^= <span class="number">1</span> &lt;&lt; ((key.get_ubyte[v15 &gt;&gt; <span class="number">1</span>] &gt;&gt; v16) &amp; <span class="number">0xF</span>);</span><br><span class="line">                  v17 = i / <span class="number">3</span> + v9 - v9 % <span class="number">3</span>;</span><br><span class="line">                  v18 = <span class="number">3</span> * (i / <span class="number">3</span>);</span><br><span class="line">                  v19 = i;</span><br><span class="line">                  v11 ^= <span class="number">1</span> &lt;&lt; ((key.get_ubyte[(<span class="number">3</span> * (v9 % <span class="number">3</span>) + v19 - v18 + <span class="number">9</span> * v17) &gt;&gt; <span class="number">1</span>] &gt;&gt; (<span class="number">4</span></span><br><span class="line">                                                                                           * ((<span class="number">3</span> * (v9 % <span class="number">3</span>)</span><br><span class="line">                                                                                             + v19</span><br><span class="line">                                                                                             - v18</span><br><span class="line">                                                                                             + <span class="number">9</span> * v17) &amp; <span class="number">1</span>))) &amp; <span class="number">0xF</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ( v12 != <span class="number">511</span> || v13 != <span class="number">511</span> || v11 != <span class="number">511</span> )</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span> ( ++v9 == <span class="number">9</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">puts</span>(<span class="string">&quot;Woah! You&#x27;re so good at puzzles!&quot;</span>);</span><br><span class="line">                  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_7:</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;That&#x27;s not a valid solution you silly goose!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>z3求解符合条件的flag:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">key = [ <span class="number">0x08</span>, <span class="number">0x6B</span>, <span class="number">0xD0</span>, <span class="number">0xFE</span>, <span class="number">0x49</span>, <span class="number">0xCB</span>, <span class="number">0xAC</span>, <span class="number">0x9B</span>, <span class="number">0x9C</span>, <span class="number">0xF7</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0xBA</span>, <span class="number">0x4B</span>, <span class="number">0xAE</span>, <span class="number">0x95</span>, <span class="number">0x69</span>, <span class="number">0x08</span>, <span class="number">0xF3</span>, <span class="number">0xBC</span>, <span class="number">0x4E</span>, </span><br><span class="line">        <span class="number">0xED</span>, <span class="number">0x18</span>, <span class="number">0x4A</span>, <span class="number">0x6B</span>, <span class="number">0xE0</span>, <span class="number">0xDE</span>, <span class="number">0xF4</span>, <span class="number">0x42</span>, <span class="number">0xE5</span>, <span class="number">0xD3</span>, </span><br><span class="line">        <span class="number">0xD9</span>, <span class="number">0xA8</span>, <span class="number">0x3C</span>, <span class="number">0xCF</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x71</span>, <span class="number">0x0E</span>, <span class="number">0x16</span>, <span class="number">0x16</span>, </span><br><span class="line">        <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">key2 = [<span class="number">0x01</span>, <span class="number">0x06</span>, <span class="number">0x03</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x02</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, </span><br><span class="line">        <span class="number">0x15</span>, <span class="number">0x07</span>, <span class="number">0x18</span>, <span class="number">0x04</span>, <span class="number">0x19</span>, <span class="number">0x05</span>, <span class="number">0x1C</span>, <span class="number">0x03</span>, <span class="number">0x20</span>, <span class="number">0x04</span>, </span><br><span class="line">        <span class="number">0x21</span>, <span class="number">0x05</span>, <span class="number">0x22</span>, <span class="number">0x08</span>, <span class="number">0x26</span>, <span class="number">0x05</span>, <span class="number">0x2C</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x08</span>, </span><br><span class="line">        <span class="number">0x35</span>, <span class="number">0x06</span>, <span class="number">0x36</span>, <span class="number">0x01</span>, <span class="number">0x3B</span>, <span class="number">0x03</span>, <span class="number">0x47</span>, <span class="number">0x08</span>, <span class="number">0x4A</span>, <span class="number">0x06</span>, </span><br><span class="line">        <span class="number">0x4B</span>, <span class="number">0x04</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x4F</span>, <span class="number">0x07</span>]</span><br><span class="line">masks = [<span class="number">240</span>, <span class="number">240</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">240</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">240</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">240</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">240</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">key_after_mask = [<span class="number">96</span>, <span class="number">80</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">114</span>, <span class="number">0</span>, <span class="number">84</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">84</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">96</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">128</span>, <span class="number">0</span>, <span class="number">70</span>, <span class="number">0</span>, <span class="number">114</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">flag = [BitVec(<span class="string">&#x27;flag_%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">54</span>)]</span><br><span class="line">s.add(And([And(flag[i] &lt; <span class="number">0x7f</span>, flag[i] &gt; <span class="number">0x40</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">54</span>)]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">54</span> * <span class="number">6</span>, <span class="number">6</span>):</span><br><span class="line">    v5 = ((flag[<span class="built_in">int</span>(i / <span class="number">6</span>)] - <span class="number">0x40</span>) &lt;&lt; (i &amp; <span class="number">7</span>)) &amp; <span class="number">0xff</span></span><br><span class="line">    key[i &gt;&gt; <span class="number">3</span>] ^= v5</span><br><span class="line">    <span class="keyword">if</span> (i &amp; <span class="number">7</span>) &gt; <span class="number">2</span>:</span><br><span class="line">        v6 = ((flag[<span class="built_in">int</span>(i / <span class="number">6</span>)] - <span class="number">0x40</span>) &gt;&gt; (<span class="number">8</span> - (i &amp; <span class="number">7</span>))) &amp; <span class="number">0xff</span></span><br><span class="line">        key[(i &gt;&gt; <span class="number">3</span>) + <span class="number">1</span>] ^= v6</span><br><span class="line">s.add(And([And([(key[i] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xf</span> &lt;= <span class="number">8</span>, key[i] &amp; <span class="number">0xf</span> &lt;= <span class="number">8</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>)]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">    s.add(key[i] &amp; masks[i] == key_after_mask[i])</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">round</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    v11 = <span class="number">0</span></span><br><span class="line">    v12 = <span class="number">0</span></span><br><span class="line">    v13 = <span class="number">0</span></span><br><span class="line">    count = <span class="built_in">round</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        temp1 = BitVec(<span class="string">&quot;temp1&quot;</span>, <span class="number">12</span>)</span><br><span class="line">        temp2 = BitVec(<span class="string">&quot;temp2&quot;</span>, <span class="number">12</span>)</span><br><span class="line">        temp1 = <span class="number">1</span></span><br><span class="line">        temp2 = key[(i + <span class="number">9</span> * <span class="built_in">round</span>) &gt;&gt; <span class="number">1</span>]</span><br><span class="line">        temp2 &gt;&gt;= <span class="number">4</span> * ((i + <span class="number">9</span> * <span class="built_in">round</span>) &amp; <span class="number">1</span>)</span><br><span class="line">        temp2 &amp;= <span class="number">0xf</span></span><br><span class="line">        temp1 &lt;&lt;= temp2</span><br><span class="line">        v13   ^= temp1</span><br><span class="line">        v15   = count</span><br><span class="line">        temp1 = <span class="number">1</span></span><br><span class="line">        temp2 = key[count &gt;&gt; <span class="number">1</span>]</span><br><span class="line">        temp2 &gt;&gt;= <span class="number">4</span> * (count &amp; <span class="number">1</span>)</span><br><span class="line">        temp2 &amp;= <span class="number">0xf</span></span><br><span class="line">        temp1 &lt;&lt;= temp2</span><br><span class="line">        v12   ^= temp1</span><br><span class="line">        temp1 = <span class="number">1</span></span><br><span class="line">        v17 = <span class="built_in">int</span>(i / <span class="number">3</span>) + <span class="built_in">round</span> - <span class="built_in">round</span> % <span class="number">3</span></span><br><span class="line">        v18 = <span class="number">3</span> * <span class="built_in">int</span>(i / <span class="number">3</span>)</span><br><span class="line">        temp2 = key[(<span class="number">3</span> * (<span class="built_in">round</span> % <span class="number">3</span>) + i - v18 + <span class="number">9</span> * v17) &gt;&gt; <span class="number">1</span>]</span><br><span class="line">        temp2 &gt;&gt;= <span class="number">4</span> * ((<span class="number">3</span> * (<span class="built_in">round</span> % <span class="number">3</span>) + i - v18 + <span class="number">9</span> * v17) &amp; <span class="number">1</span>)</span><br><span class="line">        temp2 &amp;= <span class="number">0xf</span></span><br><span class="line">        temp1 &lt;&lt;= temp2</span><br><span class="line">        v11   ^= temp1</span><br><span class="line">        count += <span class="number">9</span></span><br><span class="line">    s.add(And(v11 == <span class="number">0x1FF</span>, v12 == <span class="number">0x1FF</span>, v13 == <span class="number">0x1FF</span>))</span><br><span class="line">final_key = [BitVec(<span class="string">&#x27;final_key_%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>):</span><br><span class="line">    s.add(final_key[i] == key[i])</span><br><span class="line">s.add(flag[<span class="number">0</span>] == <span class="built_in">ord</span>(<span class="string">&quot;l&quot;</span>), flag[<span class="number">1</span>] == <span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>), flag[<span class="number">2</span>] == <span class="built_in">ord</span>(<span class="string">&quot;c&quot;</span>), flag[<span class="number">3</span>] == <span class="built_in">ord</span>(<span class="string">&quot;t&quot;</span>), flag[<span class="number">4</span>] == <span class="built_in">ord</span>(<span class="string">&quot;f&quot;</span>), flag[<span class="number">5</span>] == <span class="built_in">ord</span>(<span class="string">&quot;&#123;&quot;</span>), flag[<span class="number">53</span>] == <span class="built_in">ord</span>(<span class="string">&quot;&#125;&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">54</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(m[flag[i]].as_long()), end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="comment"># for i in range(41):</span></span><br><span class="line">    <span class="comment">#     print(hex(m[final_key[i]].as_long()), end = &quot;, &quot;)</span></span><br><span class="line">    <span class="comment"># print()</span></span><br><span class="line">    condition = []</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> m:</span><br><span class="line">        condition.append(d() != m[d])</span><br><span class="line">    s.add(Or(condition))</span><br><span class="line"><span class="comment"># lactf&#123;looking_at_the_puzzles_is_honestly_so_overrated&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="technically-correct-ELF文件格式"><a href="#technically-correct-ELF文件格式" class="headerlink" title="technically-correct | ELF文件格式"></a>technically-correct | ELF文件格式</h2><p><a target="_blank" rel="noopener" href="https://1k0ct.github.io/2024/03/16/ELF%E6%96%87%E4%BB%B6%E5%A4%B4/#%E5%BA%94%E7%94%A8%E5%9C%BA%E5%90%88">ELF文件头格式分析</a></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>感觉大部分的题目考验的都是对代码的理解 并没有涉及非常神必的加密</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>1K0CT B14s
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://ikoct.com/2024/02/23/LACTF2024%E9%80%86%E5%90%91%E6%96%B9%E5%90%91%E9%83%A8%E5%88%86wp/" title="LACTF2024逆向方向部分wp">https://ikoct.com/2024/02/23/LACTF2024逆向方向部分wp/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Reverse/" rel="tag"># Reverse</a>
              <a href="/tags/Writeups/" rel="tag"># Writeups</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/02/23/BeginCTF2024%E9%80%86%E5%90%91%E6%96%B9%E5%90%91wp/" rel="prev" title="BeginCTF2024逆向方向wp">
      <i class="fa fa-chevron-left"></i> BeginCTF2024逆向方向wp
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/03/04/osu-gamingCTF%E9%83%A8%E5%88%86wp/" rel="next" title="osu!gamingCTF部分wp">
      osu!gamingCTF部分wp <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#shattered-memories"><span class="nav-number">1.</span> <span class="nav-text">shattered-memories</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#aplet321-%E6%8E%A5%E8%BD%A8pwn"><span class="nav-number">2.</span> <span class="nav-text">aplet321 | 接轨pwn</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#the-secret-of-java-island-java%E9%80%86%E5%90%91-%E7%88%86%E7%A0%B4"><span class="nav-number">3.</span> <span class="nav-text">the-secret-of-java-island | java逆向 | 爆破</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#flag-finder-GM%E9%80%86%E5%90%91"><span class="nav-number">4.</span> <span class="nav-text">flag-finder | GM逆向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#glottem-algre"><span class="nav-number">5.</span> <span class="nav-text">glottem | algre</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#meow-meow-%E7%88%86%E7%A0%B4"><span class="nav-number">6.</span> <span class="nav-text">meow meow | 爆破</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rbp-%E5%87%BD%E6%95%B0%E6%8E%A7%E5%88%B6"><span class="nav-number">7.</span> <span class="nav-text">rbp | 函数控制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#puzzlepalooza-Z3"><span class="nav-number">8.</span> <span class="nav-text">puzzlepalooza | Z3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#technically-correct-ELF%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="nav-number">9.</span> <span class="nav-text">technically-correct | ELF文件格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">10.</span> <span class="nav-text">总结</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="1K0CT B14s"
      src="/images/myavatar.gif">
  <p class="site-author-name" itemprop="name">1K0CT B14s</p>
  <div class="site-description" itemprop="description">残りの人生、私にくれませんか？</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <!--
-->

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">1K0CT B14s</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">455k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">6:54</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
